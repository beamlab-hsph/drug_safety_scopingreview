Drug Saf (2018) 41:565–577
https://doi.org/10.1007/s40264-018-0640-8

ORIGINAL RESEARCH ARTICLE

Time Series Disturbance Detection for Hypothesis-Free Signal
Detection in Longitudinal Observational Databases
Ed Whalen1 • Manfred Hauben1,2 • Andrew Bate1

Published online: 21 February 2018
Ó Springer International Publishing AG, part of Springer Nature 2018

Abstract
Introduction Signal detection remains a cornerstone
activity of pharmacovigilance. Routine quantitative signal
detection primarily focuses on screening of spontaneous
reports. In striving to enhance quantitative signal detection
capability further, other data streams are being considered
for their potential contribution as sources of emerging
signals, one of which is longitudinal observational databases, including electronic medical record (EMR) and
transactional insurance claims databases. Quantitative signal detection on such databases is a nascent field—with
published methods being primarily based either on individual metrics, which may not effectively represent the
complexity of the longitudinal records and their necessary
variation for analysis for drug–outcome pairs, or on visualization discovery approaches leveraging multiple aspects
of the records, which are not particularly tractable to highthroughput hypothesis-free signal detection. One extensively tested example of the latter is chronographs.
Methods We apply a disturbance detection algorithm to
chronographs using UK EMR The Health Improvement
Network (THIN) data. The algorithm utilizes autoregressive integrated moving average (ARIMA)-based time series methodology designed to find disturbances that occur
outside the normal pattern trends of the ARIMA model for
the chronograph. Chronographs currently highlight drug–
event pairs as potentially worthy of further clinical
assessment, via filter-based increases in disproportionality
& Ed Whalen
ed.whalen@pfizer.com
1

Pfizer Inc, 235 East 42nd St., New York, NY, USA

2

New York University School of Medicine, New York, NY,
USA

scores from before to after the index drug exposure, tested
across a range of case and control windows.
Results We replicate the findings on six exemplar
chronographs from a previous publication, and show how
disturbances can be effectively detected across this set of
pairs. Further, 692 disturbances were detected in analysis
of all 384 individual READ code outcomes ever recorded
50 or more times for patients prescribed sibutramine. The
disturbances are algorithmically further broken into subsets
of clinical interest.
Conclusion Overall, the disturbance algorithm approach
shows promising capacity for detecting outliers, and shows
tractability of the algorithmic approach for large-scale
screening. The method offers an array of pattern types for
detection and clinical review.

Key Points
Use of outlier detection methods can help filter large
numbers of chronographs for potential drug-related
increases in chronograph information component
values.
The filtering criteria are flexible, with one version
used to identify chronographs showing a potential
drug effect in a subset of the 384 sibutramine
chronographs.

566

1 Background
Signal detection in longitudinal observational databases
(LODs) is an emerging focus of research [1–4]. LODs
provide a rich and complex data source for signal detection. A visualization tool called a chronograph shows
changes in a disproportionality measure, the information
component (IC) [5–7], with confidence intervals, over time
for specific events stratified into monthly pre-/post-index
windows [1, 5, 8–10]. Currently, routine ‘interestingness’
of chronographs is based on comparing discrete disproportionality calculations between multiple pre- versus postindex timepoints and visual inspection [8–10].
Obviously, numerous pair-wise comparisons are possible in a time series of 73 months (36 monthly window slots
pre-prescription [pre-index], at time of prescription [index]
and 36 months post-index). Visual review of the chronograph is informative, with ‘interestingness’ [11] depending
on the nature of both the outcome and exposure (rapid vs.
late onset, acute vs. chronic outcomes, transient vs. longterm exposure, etc.) and association patterns over time.
Chronographs are currently accompanied by a table of
multiple IC deltas. While a single IC delta metric has
performed promisingly as a filtering metric compared to
other statistical measures in signal detection performance
assessments [12], a series of IC delta metrics is informative
but lacks the information anchored to a specific timepoint
that can be shared in the visual display of a chronograph.
Therefore, an analyst may need to go back and forth to
visually reconcile the chronograph and associated tabular
summaries of pair-wise IC comparisons. The process can
also introduce a degree of subjectivity and has potential
inter-analyst variability. These features of the above procedures are amplified for safety analysts responsible for a
significant portfolio of products (e.g., multiple products
within a pharmacological/therapeutic area). Scalability of a
process requiring visual review of every drug–event pair is
a prerequisite when thousands of drug–event pairs need to
be reviewed, and indeed in a recent literature review a lack
of effective triage or prioritization was identified as a major
barrier to effective hypothesis-free signal detection [13].
This practical reality motivates a search for an automated
procedure that consolidates, integrates, and annotates
multiple temporal patterns, multiple pair-wise disproportionality comparisons and visually derived heuristics in an
output that can be assessed at a glance, effectively a filter
for drug–event pairs of sufficient relevance to warrant more
extensive review, including that of the chronograph.
However, to some extent these problems have been mitigated by a proposed heuristic using multiple IC delta
metrics (referred to as the ‘ICdelta025 heuristic’ hereafter)
using two observation time windows (month 1 and months

E. Whalen et al.

2–6 post-index) and four control windows (day of exposure, 1 month before, 2–12 months before, and
13–36 months before). With these windows, one calculates
the ICdelta025 (the lower bound of the two-sided 95%
confidence interval for an IC delta) for each of the four
control windows for both of the observation periods,
selecting for each observation period the ICdelta025 that
has the lowest value and then selecting the one of the two
(i.e., one for each observation period) with the greatest
value. If this value is positive then the chronograph is
flagged for clinical review [10]. However, limitations with
the ICdelta025 heuristic as a binary algorithm for review
include (a) binary comparisons of a limited set of a prioridefined control windows and case windows, independent of
one another (so more complex differences can’t be seen);
(b) the assumption that the observation windows and
control windows are sufficiently wide to capture the
occurrence of appropriate exposed and non-exposed times
and outcomes, but not too broad to dilute any specific/narrow temporal effect; and (c) the heuristic focuses on
attempting to highlight any chronograph that is likely to
show elevated IC values post-index relative to prior to
exposure—as visible in the chronograph—with no attempt
made to allow for consideration of the nature of the outcome and exposure in the filtering, even though some
chronographs with a visible elevation in IC after exposure
will clearly be implausible. As an example of this last
limitation, on pharmacological grounds an anaphylactic
reaction that leads solely to elevation of the IC many
months after exposure compared to any control window
could be highlighted by the IC heuristic. While this could
occur with the disturbance algorithm, the tabular overview
provides information on all disturbances associated with a
given chronograph so that the outliers can be clinically
correlated with the event, or deemed not related, based on
the clinical nature of the event and the timing and type of
the outliers shown in the table. Also, even when highlighted, the analyst needs to continue to focus on ad hoc
comparison between the ICdelta025 scores and visual
inspection of the chronographs to both reconcile why the
chronograph was highlighted for clinical review, and
whether the observed pattern might represent an emerging
signal based on the specific drug or vaccine and outcome
under consideration.
Since chronographs, their associated IC deltas, and their
comparisons, represent potentially correlated data points,
we propose an automated triage based on using the totality
of the data underlying the chronograph to estimate
autoregressive integrated moving average (ARIMA) time
series models [14] enhanced by a structured outlier analysis, which reduces various chronograph patterns of interest into qualitative summaries, allowing clinicians to focus
better on potential signals. Time series models in general,

Time Series Disturbance Detection for Hypothesis-Free Signal Detection

and ARIMA (or its subparts AR and MA) in particular,
have applications across a broad range of data sources such
economic, financial, hydrologic, and climate data, to name
a just a few (see, for example, Anderson et al. [15], Rao
and Hsu [16], and Mudelsee [17]). ARIMA approaches
have also been applied in pharmacovigilance to measure
the impact of adverse drug reaction (ADR) bulletin publications on the subsequent rate of adverse event reporting
[18]. In the case where an ‘intervention’ may alter the time
series, outlier analyses help judge the direction, magnitude,
and shape of the disturbance. Using work on systematic
outlier analyses of time series [19] and a readily available
R-package that applies those methods, we can treat changes
in a chronograph as potential outliers/disturbances and then
check their time of occurrence, the type of disturbance, and
the associated t-statistic (a measure of direction and
strength of disturbance) combined together to see if the
data suggest a drug effect.

2 Objective
The objective of this study was to demonstrate the application and feasibility of a statistically defined and developed outlier detection/adjustment procedure for
disturbance detection on chronographs in the spirit of
applying statistical methodology congruent with the
chronograph data structure. There are two components of
this proof-of-concept type objective, to: (1) establish that
chronographs and the associated multiple pair-wise disproportionality comparisons can be condensed, captured
and usefully represented with time series modeling and
outlier analysis (TSOA) and associated omnibus visualizations of multiple chronographs; and (2) examine its
potential for scalability to streamline analysis of chronographs and their accompanying data for purposes of highthroughput screening of longitudinal observational data for
safety signal detection. Comparison is made to the previously published approach for screening based on the
ICdelta025 heuristic.

3 Methods
The source of the data on drug prescriptions and the health
outcome of interest was The Health Improvement Network
(THIN) database. THIN currently contains the electronic
medical records (EMRs) of 11.1 million patients (3.7
million active patients), equivalent to 75.6 million patientyears of data collected from 562 general practices in the
UK, covering 6.2% of the UK population. This database is
routinely
and
extensively
used
for

567

pharmacoepidemiological studies [20, 21]. All data are
fully anonymized, processed and validated by CSD Medical Research UK.
To achieve objective 1, we attempted to replicate all six
drug–outcome chronographs from Norén et al. [1], which
were generated from another UK EMR (IMS Disease
Analyzer) in a recent version of the THIN database. If not
absolutely replicated, we assessed whether all salient patterns were replicated. The six specific pairs in question
were
nifedipine–pallor/flushing,
nifedipine–edema,
nifedipine–need for influenza vaccination, terbinafine–angioedema, omeprazole–acute pancreatitis, and sibutramine–malaise. In Norén et al. [1] these chronographs
were not presented as the output of a systematic analysis,
but instead reflect illustrations of a range of different patterns of varying interest to safety surveillance, including
well-established and universally labeled adverse events for
two of the six (nifedipine–pallor/flushing and nifedipine–
edema). Our goal was to determine the extent to which the
algorithm-derived disturbances agreed with the most salient features of the chronographs in order to examine the
potential for the disturbance detection as a triage tool for
highlighting drug–event pairs representing interesting
chronographs. The only one of the six pairs based on data
from the previous publication [1] that a priori we hoped not
to highlight was ‘need for influenza vaccine’ with
nifedipine, where, while there is a clear pattern, there was
no discernable change visually occurring at any point
regarding need for vaccine related to use of nifedipine.
For objective 2, in order to establish the capability of
generating the proposed outputs on a high-throughput
scale, we used the drug sibutramine, a combined serotonergic and norepinephrinergic reuptake inhibitor, and a set
of 384 medical event terms of interest in pharmacovigilance for all medicinal products [22]. We also explored and
compared these data with the outputs from the ICdelta025
heuristic as proposed in Norén et al. [10], given the safety
surveillance focus on the drug–event pairs with disturbances after drug exposure.
We examined each chronograph for outliers using the
time series outliers approach described by Chen and Liu
[19]. The general ARIMA-based approach adjusts the
monthly IC values across a chronograph to an ARIMA
model with added terms to help model outliers (as outlined
in Table 1). Their algorithm looks for outliers or disturbances, through an iterative build, based on these type of
models. The Chen and Liu approach extends previous
methodology and attempts to address some limitations of
previous ARIMA-based implementations. It attempts to
reduce a recognized challenge in quantitative signal
detection in general: that the locations and types of outlier
can change at different iterations of the model estimation

568

E. Whalen et al.

Table 1 Outlier types from Chen and Liu, used in the chronograph disturbance analyses
Type of outlier

Disturbance terma

Additive outlier (AO): an abrupt change at only one time period
(a month in our example)

AðBÞ
GðBÞH ðBÞ

¼1

Temporary change (TC): an initial, abrupt departure from trend
that fades within a few time periods

AðBÞ
GðBÞH ðBÞ

1
¼ 1oB

Level shift (LS): an abrupt and sustained departure from the
preceding trend

AðBÞ
GðBÞH ðBÞ

Visual impression

where 0\o\1

1
¼ 1B

The blue lines represent the adjusted data and the red lines are the observed data. Where the adjusted and observed data coincide, only the blue
line shows as they are superimposed
a

B represents the backward shift operator, for example Yt–1 = B(Yt). For ease of reference to the notation in Chen and Liu [19], we include the
general form, A(B)/G(B)H(B), for the outlier term used in the models, where A, G and H are polynomials described in [19]

due to possible bias in parameter estimates, because of the
outliers and, secondly, the risk of masking of outliers.
The approach of Chen and Liu [19] detects outliers and
adjusts a time series in a three-stage process with iteration
in and across stages. Their method is an iterative process
based on the ARIMA approach to modeling time series,
with sequential steps involving initial ARIMA parameter
estimation and outlier identification, joint estimation of
outlier effects and ARIMA model parameters, and then
final outlier detection results based on a final model set of
parameters. Sections 2.1 and 2.2 in Chen and Liu [19]
describe the process in detail. For details on its implementation in R, see the documentation for the R-package
‘tsoutliers’. This package is freely available along with the
R system at the Comprehensive R Archive Network
(CRAN) website (https://cran.r-project.org/). The package

and its documentation were developed and are maintained
by Javier Lopez-de-Lacalle. CRAN evaluates and approves
all R-packages prior to making them available to the
public; however, they come with no warranty. The package
documentation is also available on the CRAN website.
Here, we describe the types of outliers/disturbances that
it looks for and the three that we use in our application. In
general it classifies outlier impact into four disturbance
types: innovational outlier (IO), additive outlier (AO), level
shift (LS), or temporary change (TC). We focus on the AO,
LS, and TC only; we exclude the IO because it depends on
the chosen models at any given stage, where the other three
outlier types can readily be pre-specified. The first three
types of outliers can capture outlier activity and represent
relatively clear interpretations of underlying activity. For
instance, the AO indicates an immediate impact of drug

Time Series Disturbance Detection for Hypothesis-Free Signal Detection

569

Table 2 Hypothetical example illustrating possible output and queries of it
Drug–event
combination

Time of
outlier

Outlier
type

tStatistica

Interpretation

A-E1

– 33

TC

- 4.07

– 20

TC

- 4.04

Reduction in event E1 pre- and post- index does not support existence of a concerning
relationship. The t-statistics indicate reduction in IC and all reductions are temporary

0

TC

- 5.36

29

AO

- 3.46

B-E1

1

TC

? 5.37

Post-index episode with temporary increase of IC may warrant visual review of chronograph
depending on clinical context

B-E2

3

LS

? 4.15

Post-index episode with permanently increased IC; perform visual review of chronograph

AO additive outlier, IC information component, LS level shift, TC temporary change, ? indicates an increase in the underlying rate, - indicates a
reduction in the underlying rate
a

In addition to statistical significance, the magnitude and sign (?/-) of the t-statistic indicate the change in IC value (normalized) and the
direction of the change: the larger the magnitude, the greater the outlier deviates from the rest of the curve. A and B designate hypothetical
drugs; E1 and E2 designate hypothetical adverse events

effect with no residual activity where a TC indicates a
lingering effect but not the lasting effect of a full LS.
Although we exclude the IO type, outlier activity will still
be detected using the first three, but will not get classified
as an IO but rather some combination of the others. We
also note that the algorithm combines, as needed, multiple
variations of the three basic outlier types to capture more
complex disturbance patterns in a chronograph. One general pattern that the method will not likely detect is a
gradual increase in IC post-index; that will require an
additional technique to be added to the detection process
but is beyond the scope of the current article’s focus on
finding noteworthy disturbances associated with the onset
of drug use.
Table 1 displays chronograph samples with only one
outlier to illustrate the differences between the three basic
types. For a given chronograph the outlier detection algorithm will list the time at which each outlier occurs, the
direction and magnitude of the outlier (e.g., in the t-statistic
associated with the outlier), and the type of outlier—AO,
LS, or TC (see Table 1 for definitions and examples of
each type).
Chronograph data resemble a standard time series but
differ from a basic time series in that the sample units
(patients) are not a constant set of sample units over time.
More data are available around the time (t) of first exposure
(t = 0) than at times near the beginning and end of the
chronograph (times - 36 and ? 36). This makes the variance greater for IC values near the beginning and end of the
chronograph than for IC values near t = 0. We currently
use each IC value without adjusting for its variance; in
Sect. 5 we outline two ways to adjust each monthly IC
value for its variance, if desired.
We conducted a hypothesis free signal detection
exercise on sibutramine. We identified any READ code
(at level 5 granularity) that was recorded in more than 50

patients exposed at any time to the drug and generated a
chronograph for each READ code, and then applied the
disturbance algorithm to each of these. The process for
producing the high-throughput screening starts with an
ExcelÒ file (Microsoft Corporation, Richmond, WA,
USA) that has two columns—time and IC value—and 73
rows (one for each month) for each of the 384 medical
events in this example. The subsequent data matrix is
analyzed by event term to produce output for each of the
events terms. In the case, where no outliers were found for
an event term a record to that effect is noted. If any
outliers are found, then a list of the times at which the
outliers occurred and the type that occurred at each time
are saved in an outliers output dataset. This set of outlier
information can then be further queried to answer a
variety of questions regarding the medical event’s
chronograph. Table 2 shows an example of the output for
three hypothetical medical events and notes some possible
queries/interpretations of interest that a typical safety
reviewer may have for the output.

4 Results
4.1 Proof-of-Concept Analysis
In the proof-of-concept analysis, the outlier analyses are
applied to detect chronograph outlier behavior in the six
index chronographs from Norén et al. [1]. TSOA results
superimposed on chronographs are shown in Fig. 1.
Importantly, all TSOAs of the six chronographs in the
figure faithfully captured the visual patterns of the
chronographs, in particular the apparent key diagnostic
findings from each chronograph. It should be noted that the
six chronographs represent a range of different patterns,
some of more relevance to pharmacovigilance and signal

570

E. Whalen et al.

Fig. 1 Chronographs of drug–outcome pairs discussed in Norén et al.
[1]. The blue lines represent the adjusted data and the gray lines are
the observed data; where the adjusted and observed data coincide,

only the blue line shows as they are superimposed. AO additive
outlier, IC information component, LS level shift, TC temporary
change

detection and some less so. Overall disturbances were
detected for all six chronographs; the only two with disturbances that would trigger specific consideration from a
signal detection perspective were for nifedipine with pallor
and flushing and nifedipine with edema, two labeled
events. The third drug–event pair, terbinafine–angioedema,
was not highlighted as a post-index disturbance, and this
was also not visible post-index from the chronograph. The

other three pairs, each of which can be considered as true
negatives from a safety surveillance perspective, showed
disturbances, but not indicative of potential signals. Similarly, the ICdelta025 heuristic proposed in Norén et al. [10]
highlighted only the two nifedipine safety-labeled events,
and we note that as it is a safety signal detection-specific
heuristic it would need to be adapted to detect other types
of patterns of interest across the chronographs. Of note, if

Time Series Disturbance Detection for Hypothesis-Free Signal Detection

571

Table 3 Summary of outliers analysis and corresponding ICdelta025 analysis for the six proof-of-concept pairs
Exposure

Outcome

Findinga

Outlier detection highlights

IC delta scoring

Month B 0

Case window, first month

Case window, 2–6 months

Control window (months prior)

Control window (months prior)

13–36

Day
of (0)

13–36

Month[ 0

2–12

1

2–12

1

Day
of (0)

Nifedipine

Pallor and
flushing

AO (- 28) decrease

TC (1)
increase

2.5

2.5

2.2

2.1

0.9

0.9

0.6

0.5

?

Nifedipine

Edema

none

1.0

1.2

1.2

1.2

0.7

0.9

1.0

0.9

?

Nifedipine

Need for
influenza
vaccine

AO (0) increase

LS (1)
increase
None

0.2

0.0

- 0.1

- 0.7

0.2

0.1

- 0.1

- 0.6

Ø

Terbinafine

Angioedema

AO (- 31) decrease

None

- 0.8

- 0.6

0.1

- 0.4

- 0.2

0.0

0.7

0.2

Ø

Omeprazole

Acute
pancreatitis

AO (- 22) decrease
LS/TC (- 2/- 1)
increase

None

1.7

1.3

- 0.1

- 0.2

0.9

0.5

- 0.9

- 1.0

Ø

Sibutramineb

Malaise

None

TC (1)
decrease

- 3.4

- 3.3

- 3.0

- 2.7

- 1.4

- 1.2

- 0.9

- 0.6

Ø

The month of an outlier’s occurrence is contained in the parentheses next the outlier type
Italicized values indicate a notable finding, without regard to the direction of the finding
AO additive outlier, IC information component, LS level shift, TC temporary change, ? indicates positive finding, Ø indicates no positive finding
a

Based on IC delta heuristic

b

Sibutramine–malaise highlights an inverse safety signal via the sudden drop in IC after exposure

any positive ICdelta025 score was used for triggering
clinical review instead, then five of the six chronographs
would have been highlighted (and the sixth, with the
inverse ICdelta975 [upper bound 95% IC confidence
interval] negative score, would capture the sudden IC
drop). We note also that the IC delta heuristic merely
highlights the two nifedipine chronographs for clinical
review, whereas the TSOA/disturbance algorithm additionally classifies the two chronographs separately as different types of disturbance; this, combined with the
outcome name in a line listing, holds potential for more
sophisticated filtering/review prior to clinical review of the
chronograph. Overall, these results show the value of the
heuristic over individual ICdelta025 review, and that the
TSOA is also able to highlight the safety signals as the
heuristic would; however, the challenge is to achieve
effective triage while retaining flexibility in the types of
pattern detected and keeping relatively simple criteria.
Note that in Fig. 1 the y-axes in each graph represent the
IC values on their original scale and are not intended for
numeric comparison between graphs.
The interpretation of the results for the outliers algorithm are also summarized in Table 3 along with the corresponding ICdelta025 findings. It shows that ICdelta025
and the TSOA are in agreement in these six examples
chosen a priori and suggests that no salient information is

lost with TSOA relative to ICdelta025. Table 3 also shows
that the output of the TSOA approach can provide insight
via the nature and timing of each outlier in the context of
the given drug–event pair. The specific individual results
for these six proof-of-concept pairs are discussed in more
detail in Sects. 4.1.1–4.1.6.
4.1.1 Nifedipine and Pallor/Flushing
The chronograph for nifedipine and pallor/flushing (data
not shown due to space limitations) is notable for an
absence of supra-threshold intervals before the date of
prescription, and a very substantial jump in IC values at
month 1, which, while declining, remains above the
threshold for the next 7 months and then shows intermittent supra-threshold intervals; the phrase ‘supra-threshold’
refers to the lower bound of the 95% confidence interval of
an IC (ICdelta025) being greater than 0. The ICdelta025
values are substantially above threshold. The acute onset is
consistent with the known primary pharmacodynamic
effect of nifedipine, inhibition of transmembrane calcium
flux and decreased intracellular ionic calcium, resulting in
direct vascular smooth muscle relaxation (see the
‘Nifedipine’ entry in Tippons [23]). The temporal persistence of the signal, implying delayed onset in some cases,
has no single obvious explanation, but a time-dependent

572

modification of risk by age, dose escalation, intercurrent
drugs/illness, and/or time-varying vasodilatory environmental conditions can be postulated. With the outcome
pallor/flushing we would anticipate that, as a pharmacodynamic response, it would manifest itself in a temporary
increase in IC value soon after nifedipine exposure initiation. The TSOA indeed shows a TC at timepoint 1 that
corresponds to the same timepoint of the IC spike increases
in the chronograph, and the nature of the outlier (TC)
corresponds with the chronograph pattern as well as the
clinical presentation of flushing. The AO at t = – 28 has
no clear explanation other than occurring, according to
visual inspection of the chronograph, at a time of greater
variability in IC values (i.e., wider IC confidence intervals
and smaller sample size; data not shown due to space
limitations). This is likely a chance variation and therefore
a false positive. We would, however, argue that such false
positives occurring so long prior to drug exposure could be
readily filtered out in routine practice, as we demonstrate
later with sibutramine data. This flagged outlier and its
decay reflects multiple positive IC deltas.

E. Whalen et al.

the patient should receive an influenza vaccination. Nevertheless, it provides an interesting pattern that may be of
interest in healthcare provision and the index chronograph
is notable for annual periodicity superimposed on a slight
upward trend. The long-term time trend appears more
obvious in the TSOA than in the chronograph, and probably represents, in part, the increasing age of the cohort
with increasing time. The periodicity obviously reflects the
seasonality of influenza in the northern hemisphere, and its
apparent temporal association with refilling of nifedipine
prescriptions, as suggested in Sica [24]. This chronograph
does not represent a potential causal association with
nifedipine, but does illustrate trends and associations that
can precede and follow use of the drug. The only disturbance to the time series detected by the algorithm was an
AO at time zero; however, given the nature of the specific
outcome term—which is the need for a treatment—it
makes sense that it would be associated with a healthcare
encounter (even for a different product). This single outlier
at t = 0 could readily be filtered out.
4.1.4 Terbinafine and Angioedema

4.1.2 Nifedipine and Edema
The index chronograph for nifedipine and edema was
notable for a substantial and sustained increase in the IC
interval commencing in the time window 1 month postindex but with four supra-threshold intervals of substantially lower magnitude prior to prescription. This time
series disturbance was highlighted as two LSs at t = 1 and
2, signifying a permanent shift of the time series—consistent with edema occurring after initiation of the product
and persisting over time. These findings are in line with the
natural history of calcium channel blocker (CCB)-induced
edema, and drug-induced edema in general. Namely, the
likelihood of occurrence and/or detection of CCB-induced
edema could be more gradual and a function of its severity
and how carefully the patient is examined (e.g., early or
mild edema may not be noticed by the patient), dose
escalation, and time-varying environmental modifying
factors [1].
4.1.3 Nifedipine and Need for Influenza Vaccine
Nifedipine and need for influenza vaccine contrasts with
the other recorded outcomes as it is an expressed explicit
need for a therapeutic intervention, rather than an adverse
event, on the part of the healthcare professional (HCP). It is
important to note that this perceived need is associated with
underlying healthcare and is regardless of therapeutic
intervention—it merely indicates that in a healthcare
encounter for any purpose or reason, perhaps because of
the season and the patient’s age, the HCP has decided that

The terbinafine and angioedema chronograph is notable for
the total absence of supra-threshold intervals, though an
analyst may be left wondering about significant pair-wise
differences in ICs, i.e., are there some post-index timepoints where the IC interval does/does not or only minimally overlaps pre-index intervals? The TSOA highlights a
negative outlier (AO) at 31 months prior to prescription.
While this does correspond to a visible dip in the IC, the
interval at the nadir substantially overlaps its neighbors,
and plausibly would not be noticed. Although this is a preindex finding (and, therefore, not of interest safety-wise), it
illustrates the ability of the TSOA algorithm to find less
visually obvious deviations in a noisier chronograph. In
terms of replication of the chronograph in the original
publication [1], we note for this one example considerable
discordance from that original chronograph: specifically, in
Norén et al. [1] the chronograph of terbinafine and
angioedema showed a less fluctuating IC centered around
zero over time in general, with a clearly visible positive
outlier at 1 month post-index.
4.1.5 Omeprazole and Acute Pancreatitis
The omeprazole–pancreatitis chronograph has several
interesting features: increased ICs a long time prior to the
prescription, with an accelerated increase in the few
months before prescription, that only partially resolves
after prescription, as made perfectly clear by the TC and
LS outlier disturbances. In general, a pre-prescription
increase in ICs suggests a high-risk (for the event) cohort.

Time Series Disturbance Detection for Hypothesis-Free Signal Detection

However, a purely high-risk cohort effect would likely
show a more uniform distribution of increased ICs prior to
prescription. In fact, the pattern of time-symmetric (around
t = 0) increased ICs is a classic example of how a
chronograph can mitigate a false-positive IC finding from
spontaneous reporting. In this case the accelerated run-up
in ICs just prior to prescription suggests an element of
latency/cumulative risk in the cohort and/or reverse causation (e.g., the event pancreatitis, or some epiphenomenon
of pancreatitis, prompting prescription of omeprazole).
Possible scenarios for the latter include the known use of
acid-suppressive drugs for acute pancreatitis (though
recently discredited as an inappropriate therapy), its use to
treat severe non-heliobacter gastritis associated with
chronic pancreatic inflammation, its use to treat or prevent
alcoholic gastritis, and its legitimate use in Zollinger–Ellison syndrome. The post-index persistence could also
reflect these phenomena, but a contribution by causality
cannot be excluded.
4.1.6 Sibutramine and Malaise/Fatigue
The sibutramine and malaise/fatigue chronograph is
notable for the absence of supra-threshold IC intervals but
a negative AO for the event fatigue at t = 1. Both the
TSOA and visual inspection of the chronograph suggest
more infrequent occurrence of the outcome immediately
after sibutramine initiation. This is mechanistically plausible given the potentially CNS-activating effects of norepinephrine and serotonin reuptake inhibition.
Overall, the disturbance algorithm performs at least as
well as the ICdelta025 heuristic, and while the sample size
is very small, it shows promise for routine signal detection.
Relative to a table of positive IC delta values, the summary
outputs of the disturbance algorithm can give a more
nuanced triage of potential signals by allowing clinical
correlation between the nature of the event and the timing
and type of outlier.

Table 4 Outlier occurrences by type and time
Outlier Type

Pre-index

At index

Post-index

Total

AO

162

103

107

372

TC

135

33

51

219

LS
Total

59
356

2
138

40
198

101
692

Outliers of increase

97

59

49

205

Outliers of decrease

259

79

149

487

AO additive outlier, LS level shift, TC temporary change

573

4.2 High-Throughput Analysis of Sibutramine
A summary of the totality of output (see example in
Table 2) shows that the TSOA returned 692 outliers among
289 drug–event combinations (DECs) (75.3%) of the 384
DECs tested. The other 95 DECS (24.7%) had no outlier
findings. The outliers found included 372 AOs, 219 TCs,
and 101 LSs (see Table 4). These occurred across the range
of time from month – 36 to month 36, with 66 (22.8%) of
these 289 DECs having only pre-index outliers. The 384
combinations took approximately 3 min of real time to run
using a LenovoTM T440p PC. Table 4 displays how many
of the different types of outliers occurred pre- and postindex as well as their directionality (relevant for filtering,
discussed later).
A notable number of IC outliers occur around the index
time, t = 0, as would be anticipated given the frequency
and non-random recording of events on the day of prescription, as shown on the histogram in Fig. 2a. However,
we do not totally dismiss the possibility of important
information at t = 0, as a first dose of some medications
may be given in the doctor’s office and the patient observed
for serious first-dose effects before leaving that, if they
occurred, would then be recorded on that same day. Of
course, many outliers occur at other times as well, as seen
in Table 4 and Fig. 2b. Simple filtering by outliers at t[0
might be conducted to highlight signals representing
potential ADRs; outliers at t\0 might represent other
effects or other patterns, e.g., indications of channeling.
Clearly, it is possible that more sophisticated automated
filtering rules could also be generated, e.g., for rapid-onset
reactions such as anaphylactic reaction detection, focusing
on times between t = 0 and say t = 2.
Although a detailed clinical adjudication of the events
highlighted by each method was not part of the objectives
of our analysis, herein we make a few first-pass observations. Using a TSOA post-index filter that only considers
chronographs/events with post-index outliers and no outliers prior to exposure, there were 12 chronographs with
outliers highlighted versus 14 highlighted by the
ICdelta025 heuristic; if chronographs with pre-index outliers that are not increases in IC are also included, then we
obtain 25 highlighted chronographs (13 more). Eight of the
12 (66%) TSOA findings occurred within the first year
following treatment initiation. The remaining four were at
least 23 months post-index, making causation perhaps less
likely. Several events were highlighted by both methods,
such as ‘weight decreasing’, which suggests the intended
therapeutic effect of the drug, and blood pressure-related
events that are more compatible with an adverse drug
effect. Some events highlighted by one or the other
method, were, however, conceptually related, such as ‘boil
not otherwise specified’, highlighted by TSOA, versus

574

E. Whalen et al.

Fig. 2 Distribution of outliers detected by time for the high-throughput screen. a provides a more granular view of the frequencies near the time
of first exposure. b shows the frequencies over the entire 73 month observation period

‘folliculitis’ and ‘local infection of skin’, highlighted by
the ICdelta025 heuristic. Several outlier disturbances
returned by the TSOA were associated with depressionrelated events, which were supported by label warnings,
but these events were not highlighted by the ICdelta025
heuristic. There were some additional events highlighted
by only one of the methods that may be considered to have
some support in the product labeling and/or published literature, such as ‘micturition frequency’ highlighted by
TSOA and ‘constipation’ highlighted by the ICdelta025
heuristic. Finally, some highlighted events suggest components of routine/scheduled office visits, rather than
adverse events, such as ‘foreign advice travel’ highlighted
by the ICdelta025 heuristic.

5 Discussion
Effective hypothesis-free signal detection in LODs needs
to make the most of the rich temporal relationships that can
be observed in such data, while acknowledging that very
different patterns of interest could be anticipated and
observed for different types of medicinal products and
adverse events. The visualization approach using chronographs has been shown to be a useful approach, but clinical
review of all chronographs, many of which are uninteresting, has limited practical value due to inefficiency for
signal detection and because the previously proposed
chronograph metric IC delta, which compares disproportionality before and after an intervention, requires the prespecification of observation period windows of interest and
control windows, thus serving only as a binary classifier,
which can impose limitations on its use as a triage for
clinical review. Such pre-specifications are challenging

given the high degree of heterogeneity between medicinal
products and ADRs. Consequently, we propose the use of
time series modelling as a promising direction for further
review of chronographs, one that can highlight disturbances in the model for enhanced signal detection. Our
results demonstrated the following: (1) time series modelling of chronographs is feasible and potentially useful;
and (2) when enhanced with structured outlier analysis
(TSOA) on a test set of previously published chronographs,
no important diagnostic information in the chronograph
and associated statistics are lost, and in fact the key
information elements in the TSOA graphs are arguably
integrated, condensed, and annotated, and therefore more
efficient representations of the key elements from the
chronograph and its associated statistics. Specifically, the
TSOA captures and illustrates not only the key features of
the chronograph but also information currently represented
in a table of multiple IC delta values, and while our limited
experience shows similar performance to an ICdelta025
heuristic filtering specific to signal detection as proposed
by Norén et al. [10], we feel that the simplicity of the
disturbance algorithm and its generalizability to detect
disturbances of different types, irrespective of whether
specific to signal detection or otherwise, provides some
advantages. Second, the TSOA provided a single tabular
output that effectively displayed information contained in
multiple pair-wise IC comparisons in time. This is important practically as the current procedure for interpreting
chronograph data is inefficient, relying not only on global
visual inspection of the chronograph but also on a series of
pair-wise comparisons reflected in multiple IC deltas. Our
sibutramine results also show that this method is amenable
to high-throughput screening of longitudinal data for purposes of signal detection.

Time Series Disturbance Detection for Hypothesis-Free Signal Detection

In this study we tested the TSOA algorithm on a set of
chronographs that might be considered to include some that
illustrate unambiguous positive findings involving established pharmacodynamic effects, as in the case of
nifedipine and edema or flushing (positive associations) or
sibutramine and fatigue (negative association). With
increased testing and application of this method to an
increasing variety of drug–event pairs, we hope to learn
whether this method can also streamline the triage of more
ambiguous chronographs.
While we consider our results to show the promise of the
TSOA approach, further enhancements to the approach are
possible and desirable. The amount of information over the
time horizon of the chronograph changes from month to
month, with the most information typically available near
the index month of t = 0. Use of the IC without consideration for the credibility intervals around the estimate
means that the increased volatility in IC estimates with less
support in the data (and wider credibility intervals) is not
accounted for in the disturbance detection, increasing the
chance in theory for both false-positive and false-negative
disturbance detection for IC values with limited support.
One potential way to account for the varying levels of
information is to adjust the IC values by normalizing each
monthly IC relative to the variability in its estimate. We
can do this two ways: normalize based on the length of the
IC confidence interval [divide IC by length of IC interval/
(2 9 1.96)] or normalize by dividing IC by the gamma
distribution standard error given by the observed and
expected counts. However, for the purpose of demonstrating the value of outlier methods, we have focused
primarily on the results of the IC. A more in-depth evaluation of these three approaches will be undertaken as part
of subsequent work.
There are several limitations to this study that should be
highlighted. We did not present or assess the specific
events highlighted in the high-throughput exercise, and
therefore the clinical significance of the findings and the
signal detection performance of this procedure remains an
open question. The very high percentage of events associated with disturbances raises the possibility of a high
false-positive burden if no further processing or filtering of
the outlier output is performed. Optimal filters cannot be
established without further scientific adjudication of all the
high-throughput disturbances. If this is the case, methodological refinements and/or additional triage criteria may
be indicated given the importance of positive predictive
value in signal detection and refinement. Some further
triage, e.g., excluding disturbances occurring prior to
exposure or acute outcomes occurring more than a year
after exposure, would be easy to do—note that of the 384
DECs examined, 41.9% had either no outlier (n = 95) or
only outliers in the pre-index period (n = 66). We also

575

note that reviewing line listings of disturbances and/or
applying automated screening criteria rather than loading
and reviewing chronographs visually should be less time
consuming. We also note that one general pattern that the
method will not likely detect is a gradual increase in IC
post-index. That would require an additional technique to
be added to the detection process but is beyond the scope of
the focus on finding noteworthy disturbances associated
with the onset of drug use here.
We have assumed for this study that chronographs on
THIN data are effective in representing the underlying
healthcare encounters—the extent to which chronographs
don’t accurately reflect an underlying pattern limits the
usefulness of the TSOA approach. While chronographs
have been shown to be useful, there are several wellestablished limitations of such an approach, albeit not
unique to chronographs [10], including lack of independence between timepoints, informatively missing data,
inevitable time-varying confounding, effect modification,
and medication use and diagnoses (as well as other fields)
that may not be well-captured in a consistent manner in
structured data. All of these issues will reduce the overall
effectiveness of our outlier detection for safety signal
detection. The literature on chronographs clearly emphasizes the simplified analysis of EMRs in the application
approach [10]—e.g., not considering time on therapy,
concomitant medication etc.—and again emphasizes their
role as a tool for signal detection, leading to further followup analyses. Given the limited number of examples, their
generalizability may be questionable, particularly in patterns that are less clear from visual inspection—this is an
area of future research. In addition, the method itself is not
readily applicable when only a few events occur over the
observation period; in practice, such chronographs are less
likely to pique the interest of the reviewer as a clear pattern
is less likely to be visible and may be a chance finding, and
also such chronographs could be easily excluded from
analysis before executing the TSOA analysis. Our analyses
herein had data on which nearly every month had at least
one occurrence of the event under study.
In replicating the chronographs of Norén et al. [10],
there were some differences in our study, in particular the
outcome and exposure definitions were different and the
THIN EMR database was different to the UK EMR database used in their study and included much more recent
data. This accounts for some differences in appearance of
the chronographs, but many of the visually striking elements of the chronographs remain, and we feel that the
differences have limited impact as the focus of this study
was on whether the disturbance detection approach was
promising in highlighting interesting elements of a
chronograph.

576

Running analyses on individual codes within terminologies as done in the large screen may be limited, particularly in cases such as this when working with a very
granular terminology such as READ codes: this wouldn’t
affect the performance of the disturbance detection per se,
but would affect overall performance in terms of signal
detection as the chronographs themselves may not be as
informative as if clinically similar outcomes were grouped
together. Similarly, filtering out more administrative codes
and other READ codes unlikely to be of relevance to signal
detection could also be anticipated to make signal detection
with such an approach more effective. It is well-accepted
that limitations with the use of terminologies and mapping
between terminologies is one of the major challenges of
and likely impediments to strong performance of signal
detection algorithms [25].
Future work will entail an extensive performance
assessment to look at the precision and recall of the
approach as well as whether it detects more sensitively than
visual inspection of a chronograph, in addition to further
fine-tuning of the TSOA implementation as discussed
earlier. Future considerations are whether this approach
captures potential signals escaping visual inspection and
promotes consistency of detection in a routine review
process, as well as further scalability testing on a range of
other drugs and vaccines to further show tractability in
routine operation.

6 Conclusion
A novel approach for outlier detection on chronographs of
LODs successfully detected different outlier types for six
chronographs of well-established ADRs, reproducing the
results on chronographs that also were clearly different from
each other based on visual review. While wider testing is
needed to more fully understand performance, including the
associated false-positive and -negative burdens, the results
demonstrate that the new method offers a broader search for
different types of patterns and explicit identification of
specific temporal patterns to guide clinical review. Work is
still needed to explore the detailed performance characteristics. While we tested our approach on chronographs, it may
apply to other visualization tools involving time trends and
temporal anomaly detection in LODs.
Acknowledgements The authors acknowledge the operational support of their Commonwealth and Analytics colleagues. They also
acknowledge the thorough and dedicated work of those associated
with CRAN, and in particular Javier Lopez-de-Lacalle who created
the tsoutliers package applied in this work. Finally, the authors thank
the reviewers for their insightful comments that have improved the
quality of the manuscript.

E. Whalen et al.
Funding No external funding was used in the development of this
manuscript. Ed Whalen, Manfred Hauben, and Andrew Bate are all
employees of Pfizer Inc. and hold stock or stock options in Pfizer.
Compliance with Ethical Standards
Conflict of interest Ed Whalen, Manfred Hauben, and Andrew Bate
have no conflicts of interest with respect to the development and use
of the methods described in the article. Manfred Hauben does own
stock in other pharma companies that market products mentioned in
the manuscript.

References:
1. Norén GN, Hopstadius J, Bate A, Star K, Edwards IR. Temporal
pattern discovery in longitudinal electronic patient records. Data
Min Knowl Discov. 2010;20(3):361–87.
2. Trifirò G, Patadia V, Schuemie MJ, Coloma PM, Gini R, Herings
R, EU-ADR Group, et al. EU-ADR healthcare database network
vs. spontaneous reporting system database: preliminary comparison of signal detection. Stud Health Technol Inform.
2011;166:25–30.
3. Patadia VK, Coloma P, Schuemie MJ, Herings R, Gini R, Mazzaglia G, EU-ADR Consortium, et al. Using real-world healthcare data for pharmacovigilance signal detection—the experience
of the EU-ADR project. Expert Rev Clin Pharmacol.
2015;8(1):95–102.
4. Wahab IA, Pratt NL, Ellett LK, Roughead EE. Sequence symmetry analysis as a signal detection tool for potential heart failure
adverse events in an administrative claims database. Drug Saf.
2016;39(4):347–54.
5. Noren GN, Hopstadius J, Bate A. Shrinkage observed-to-expected ratios for robust and transparent large-scale pattern discovery. Stat Methods Med Res. 2013;22(1):57–69.
6. Bate A, Lindquist M, Edwards IR, Olsson S, Orre R, Lansner A,
et al. A Bayesian neural network method for adverse drug reaction signal generation. Eur J Clin Pharmacol. 1998;54(4):315–21.
7. Bate A. Bayesian confidence propogation neural network. Drug
Saf. 2007;30(7):623–5.
8. Cederholm S, Hill G, Asiimwe A, Bate A, Bhayat F, Persson
Brobert G, et al. Structured assessment for prospective identification of safety signals in electronic medical records: evaluation
in The Health Improvement Network. Drug Saf.
2015;38(1):87–100.
9. Norén GN, Bate A, Hopstadius J, Star K, Edwards IR. Temporal
pattern discovery for trends and transient effects: its application
to patient records. In: Fourteenth ACM SIGKDD international
conference on knowledge discovery and data mining; 24–28 Aug
2008; Las Vegas. New York: ACM; 2008. p. 963–71.
10. Norén GN, Bergvall T, Ryan PB, Juhlin K, Schuemie MJ,
Madigan D. Empircial performance of the calibrated self-controlled cohort analysis within temporal pattern discovery: lessons
for developing a risk identification and analysis system. Drug Saf.
2013;36(Suppl 1):S107–21.
11. Tan PN, Kumar V, Srivastava J. Selecting the right interestingness measure for association patterns. In: Eighth ACM SIGKDD
International Conference on Knowledge Discovery and Data
Mining; 23–26 Jul 2002; Edmonton. New York: ACM; 2002.
p. 32–41.
12. Norén GN, Hopstadius J, Bate A, Edwards IR. Safety surveillance of longitudinal databases: results on real-world data.
Pharmacoepidemiol Drug Saf. 2012;21(6):673–5.

Time Series Disturbance Detection for Hypothesis-Free Signal Detection
13. Arnaud M, Bégaud B, Thurin N, Moore N, Pariente A, Salvo F.
Methods for safety signal detection in healthcare databases: a
literature review. Expert Opin Drug Saf. 2017;16(6):721–32.
14. Kirchgässner G, Wolters J, Hassler U. Introduction to modern
time series analysis. 2nd ed. Berlin: Springer; 2013.
15. Anderson TG, Davis RA, Kreiss J-P, Mikosch T, editors. Handbook of financial time series. New York: Springer; 2009.
16. Rao AR, Hsu E-C. Hilbert-Huang transformation analysis of
hydrologic and environmental time series. Dordrecht: Springer;
2008.
17. Mudelsee M. Climate time series analysis: classical statistical and
bootstrap methods. 2nd ed. Cham: Springer; 2014.
18. Castel JM, Figueras A, Pedros D, Laporte JR, Capella D. Stimulating adverse drug reaction reporting. Drug Saf.
2003;26(14):1049–55.
19. Chen C, Liu LM. Joint estimation of model parameters and
outlier effects in time series. J Am Stat Assoc.
1993;88(421):284–97.

577
20. Lewis JD, Schinnar R, Bilker WB, Wang X, Strom BL. Validation studies of The Health Improvement Network (THIN) database for pharmacoepidemiology research. Pharmacoepiol Drug
Saf. 2007;16(4):393–401.
21. Blak B, Thompson M, Dattani H, Bourke A. Generalisability of
The Health Improvement Network (THIN) database: demographics, chronic disease prevalence and mortality rates. Inform
Prim Care. 2001;19(4):251–5.
22. Hauben M. Early postmarketing drug safety surveillance: data
mining
points
to
consider.
Ann
Pharmacother.
2004;38(10):1625–30.
23. Tippons AS. XPharmL: the comprehensive pharmacology reference. Boston: Elsevier; 2007. p. 1–6.
24. Sica DA. Calcium channel blocker-related peripheral edema: can
it be resolved? J Clin Hypertens (Greenwich). 2003;5(4):291–7.
25. Bate A, Brown EG, Goldman SA, Hauben M. Terminological
challenges in safety surveillance. Drug Saf. 2012;35(1):79–84.

