Contemporary Clinical Trials 99 (2020) 106183

Contents lists available at ScienceDirect

Contemporary Clinical Trials
journal homepage: www.elsevier.com/locate/conclintrial

Bayesian hierarchical model for safety signal detection in multiple
clinical trials
Yafei Zhang a, *, Shuai Sammy Yuan b, Barry A. Eagel c, Hal Li a, Li-An Lin a, William W.B. Wang a
a

Biostatistics and Research Decision Sciences, Merck & Co., Inc., Kenilworth, NJ, USA
Kite Pharma, A Gilead Company, Santa Monica, CA, USA
c
Clinical Research and Pharmacovigilance Consultant, West Orange, NJ, USA
b

A R T I C L E I N F O

A B S T R A C T

Keywords:
Bayesian hierarchical model
Meta-analysis
Randomized clinical trial
Drug safety
Pharmacovigilance

Clinical safety signal detection is of great importance in establishing the safety profile of new drugs and biologics
during drug development. Bayesian hierarchical meta-analysis has proven to be a very effective method of
identifying potential safety signals by considering the hierarchical structure of clinical safety data from multiple
randomized clinical trials conducted under an Investigational New Drug (IND) application or Biological License
Application (BLA). This type of model can integrate information across studies, for instance by grouping related
adverse events using the MedDRA system-organ-class (SOC) and preferred terms (PT). It therefore improves the
precision of parameter estimates compared to models that do not consider the hierarchical structure of the safety
data. We propose to extend an existing four-stage Bayesian hierarchical model and consider the exposure
adjusted incidence rate, assuming the number of adverse events (AEs) follows a Poisson distribution. The pro­
posed model is applied to a real-world example, using data from three randomized clinical trials of a neuro­
science drug and examine in three simulation studies motivated by real-world examples. Comparison is made
between the proposed method and other existing methods. The simulation results indicate that our proposed
model outperforms other two candidate models in terms of power and false detection rate.

1. Introduction
Safety signal detection during the drug development process is of
critical importance in protecting public health and has generated
considerable discussion and interest from both industry and regulatory
agencies [1–5]. The task of safety signal detection extends from the
preclinical through the post licensure stage. This manuscript focuses on
monitoring drug safety data for signal detection while the drug is still in
the pre-New Drug Application (NDA) development stage. Compared to
post-marketing pharmacovigilance, safety monitoring during clinical
development has unique features and is challenging due to the
complexity, magnitude and uncertainty embedded in the safety data.
Statistical safety signal detection methods have been proposed using
both Bayesian and frequentist approaches. To test the association be­
tween pharmaceuticals and AEs in spontaneous reports, Fisher’s exact
test or the Chi-squared test [6,7] have been used by some to express the
likelihood of causation between drug exposure and the observed adverse
event, referred to as a drug-event combination (DEC). The proportional
reporting ratio (PRR) [8] and likelihood ratio test (LRT) [9] are also

commonly applied by frequentists to evaluate the causative likelihood.
Typical Bayesian approaches include the Bayesian Confidence Propa­
gation Neural Network (BCPNN) [10] approach and multi-item gam­
ma–Poisson shrinkage (MGPS) [11,12] algorithm. These approaches
analyze the frequency of spontaneous reports of an AE occurring
following exposure to a drug compared to the frequency of occurrence of
that AE in a general population. For signal detection using data from a
randomized clinical trial, Bayesian hierarchical modeling has been
proposed by Berry and Berry [13] to analyze binary outcomes by
considering the correlation between system organ classes and preferred
terms using the natural hierarchical structure in safety data; Xia et al.
[14] extended Berry and Berry’s work to subject-year adjusted incidence
rate estimation under a Poisson likelihood. Odani et al. [15] further
extended it to meta-analytical settings with multiple trials by adding an
additional layer of clinical trial level in the hierarchical model, which
can borrow information across studies. One critical limitation of Odani’s
methodology is that it uses incidence percentage as the measure of risk,
which is appropriate only when the exposure time of treatment and
control are comparable. However, in many other cases, the incidence

* Corresponding author.
E-mail address: yafei.zhang@merck.com (Y. Zhang).
https://doi.org/10.1016/j.cct.2020.106183
Received 19 June 2020; Received in revised form 18 September 2020; Accepted 15 October 2020
Available online 20 October 2020
1551-7144/© 2020 Elsevier Inc. All rights reserved.

Y. Zhang et al.

Contemporary Clinical Trials 99 (2020) 106183

percentage is not appropriate as it masks the impact of exposure time on
occurrence of AEs. This can be problematic, since a greater number of
AEs, whether related to the drug exposure or not, are often seen with
increasing exposure time to the experimental drug. Thus, exposureadjusted measures like the hazard rate in a Poisson distribution or sur­
vival models are more appropriate measures of risk when exposure time
differs between the treatment and control groups. There are many
publications in the literature that address the choice of risk measure so
this topic is not the focus of this paper [16–19].
Meta-analyses are frequently performed on AE data [20–22] and are
primarily used as methods for improving statistical power to detect
safety signals of rare AEs [23,24]. When performing meta-analysis of
randomized clinical trials, the data analysis should preserve the struc­
ture of the trial design using valid statistical methods with stratifications
by trial in order to preserve the randomization [25,26]. However, simple
pooling of AE data from multiple clinical trials is still commonly adopted
when evaluating drug safety. One possible reason for this is that the
International Conference on Harmonisation guidelines recommend
simple pooling methods for the purpose of preparing the Integrated
Summary of Safety. However, analysis results obtained from simple
pooling methods could lead to inaccurate interpretations [27,28]. The
potential confounding by individual trial data could further complicate
the problem because the imbalance in the distribution of participants’
characteristics is occasionally not evaluable from aggregate trial data
without trial level information. Therefore, it is necessary to use a valid
meta-analytic approach featuring appropriate adjustments and weights
for distinct trials in order to have a proper estimation and interpretation
for any across-study summaries.
In this paper, we implement the Bayesian hierarchical meta-analysis
approach for safety monitoring when safety data from multiple studies
are available, and extend the four-level hierarchical Bayesian model by
Odani et al. [15] to the scenario that the number of safety events will be
impacted by the length of exposure. In this case, which better represents
a real-world scenario, hazard rates in a Poisson likelihood will be
naturally used as the risk measure. The remainder of the paper is
organized as follows: Section 1 introduces a real-world example that
motivates our research; Section 2 describes three existing Bayesian hi­
erarchical models and our proposed four-stage hierarchical Bayesian
model; Section 3 presents the results from the real-world example after
applying the proposed approaches with comparison to existing ones;
Section 4 describes a simulation study to evaluate the performance of
proposed and existing models under different settings. Section 5 sum­
marizes the conclusions and provides further discussion on these topics.

studies (study I: placebo (n = 461), Drug EXP 150 mg (n = 458); Study II:
placebo (n = 490), Drug EXP 150 mg (n = 485); and Study III: placebo (n
= 646), Drug EXP 140 mg (n = 644).). In Study III, it was expected that
Drug EXP 140 mg would be bioequivalent to Drug EXP 150 mg, thus we
combined the two dose levels together.
For illustrative purposes, we focus on the safety signal detection of
Drug EXP 150 mg with comparison to the placebo groups. In the inte­
grated safety data set, there were a total of 3184 subjects enrolled in the
pooled studies, with 1597 subjects in placebo group and 1587 subjects in
the Drug EXP 150 mg group. There were 419 individual preferred terms
collected within 21 system organ classes.
3. Methods
We now introduce our four-stage Bayesian hierarchical metaanalytical models for safety signal detection together with the one
from Odani et al. [15] which will be used as the reference model (“Model
4” below).
3.1. Model 1: Bayesian meta-analytical model with normal prior on log
hazard ratio
This model is an extension of Model 2a in the paper of Xia et al. [29].
Following the notation in Odani et al. [15], let ETk and ECk be the total
subject-year at risk in the kth clinical trial, for k = 1, …, K, in treatment
and control groups respectively. And let Yijk and Xijk be the number of
adverse events (AEs) coming up in the ith preferred term, for i = 1, …, ni,
under the jth system organ class, for j = 1, …, J in the kth clinical trial, for
the treatment and control groups respectively. We assume a Poisson
likelihood for the number of adverse events: Yijk~Poisson(tijkETk ) and
Xijk~Poisson(cijkECk ), where tijk and cijk are respectively the hazard rates
per person year in the treatment and placebo groups.
We consider a log-linear regression mean structure log(cijk) = γ ijk,
and log(tijk) = γ ijk + θijk. Then θijk = log (tijk/cijk) is the logarithm of
relative risk.
Following the same setting in Odani et al. [15], we set the stage 1
prior distributions for γ ijk and θijk as:
(
(
)
)
γ ijk ∼ N μγij , σ 2γij and θijk ∼ N μθij , σ2θij
Note the parameters μγij and uθij represent the mean hazard rate in the
control group and the mean hazard ratio between treatment groups and
control groups across studies (i.e., at a meta level).
The stage-2 prior distributions correspond to AE (preferred term)
level:
)
(
)
(
μγij ∼ N μγj , τ2γj and σ2γij ∼ IG αγj , βγj

2. A real-world example
Our research is motived by the practical need of interpreting safety
data during the conduct of safety monitoring and pharmacovigilance in
clinical development. In order to protect patient safety and comply with
regulatory guidance, safety physicians need to review all safety data
from clinical trials and identify potential safety signals from the start of
clinical development to post-licensure following NDA/BLA filing. In
clinical trials, there are typically hundreds of AE terms in the safety data
sets and the total number of events, both related and unrelated to the
drug exposure, may rapidly accumulate. Therefore, it is often difficult
for safety physicians to find true safety signals especially when those
risks are less common or not severe. For example, in a drug program
with three clinical trials for the treatment of migraine headaches, most
AEs are mild or moderate. However, physicians were still concerned
there could be elevation of risks in the experimental drug for those mild
and moderate AEs. In order to narrow down the focus of safety assess­
ment and understand the overall risk profile of the migraine drug, some
advanced safety signal detection methods are needed.
In order to blind the drug names, let us denote the experimental
migraine drug as Drug EXP in order to blind the drug name. The three
clinical trials were multicenter, double-blinded, placebo-controlled

(

)

(

μθij ∼ N μθj , τ2θj and σ2θij ∼ IG αθj , βθj

)

where IG () denotes Inverse-Gamma prior distribution.
The stage-3 prior distributions are at system organ class level:
)
(
μγj ∼ N μγ0 , τ2γ0 and τ2γj ∼ IG(αγ , βγ )
(

)

μθj ∼ N μθ0 , τ2θ0 and τ2θj ∼ IG(αθ , βθ )
The stage-4 full Bayesian hierarchical model prior distributions are
as follows:
)
(
μγ0 ∼ N μγ00 , τ2γ00 and τ2γ0 ∼ IG(αγ00 , βγ00 )
(

)

μθ0 ∼ N μθ00 , τ2θ00 and τ2θ0 ∼ IG(αθ00 , βθ00 )
The hyperparameters μγ00, τ2γ00, μθ00, τ2θ00, αγ00, βγ00, αθ00, βθ00, αθ, βθ,
αγ, βγ, αγj, βγj, αθj, βθj are considered as constants. In our analyses, we use
the same values as Odani et al. [15]: μγ00 = μθ00 = 0, τ2γ00 = τ2θ00 = 10,
2

Y. Zhang et al.

Contemporary Clinical Trials 99 (2020) 106183

αγ00 = αθ00 = αθ = αγ = αγj = αθj = 3, βγ00 = βθ00 = βθ, = βγ = βγj = βθj = 1.

Table 1
DIC scores for Poisson likelihood Bayesian models.

3.2. Model 2: Bayesian meta-analysis model with mixture prior on log
hazard ratio

DIC

Model 1

Model 2

Model 3

4836.1

5193.1

4889.3

Note: Model 1: Bayesian meta-analytical model with normal prior on log hazard
ratio; Model 2: Bayesian meta-analysis model with mixture prior on log hazard
ratio; Model 3: non-hierarchical model with normal prior on log hazard ratio.

Bayesian hierarchical models proposed by Berry and Berry [13] and
Model 2 by Odani et al. [15] are extended to our Model 2 here. We as­
sume the same likelihood and mean structure as in Model 1, but change
the prior distribution for the mean of the log hazard ratio to a mixture
distribution as:
)
) (
(
μθij ∼ πj δ(0) + 1 − πj N μθj , τ2θj

The prior distributions for γ ijk and θijk are the same as for Model 1. Note
that using a binomial distribution to model the AE data following a
Poisson distribution could mean a model misspecification, as it ignores
the impact of exposures on the occurrence of AEs. However, if it is ex­
pected that the total number of exposures in the treatment and control
arms are the same, both models are reasonable, and we could expect
similar results from models using both distributions.

where δ(0) is a unit point mass distribution at 0. In this way, positive
probability is assigned to the possibility of equality (i. e, μθij = 0) be­
tween the placebo and treatment hazard rates.
We use the same prior distributions for the common parameters
existing in Model 1. For the hyperparameters not included in Model 1,
we assume:

3.5. Identification of safety signals
To identify potential safety signals using the above models, we
compute the posterior probability Pr(HRij > 1| Data) for all preferred
terms, where HRij = exp (μθij) and μθij is the posterior mean of log hazard
ratio in the Bayesian hierarchical models for the ith preferred terms
under jth system organ class from Model 1, 2 and 3. In Model 4, μθij will
be the log odds ratio, and it can be used similarly for signal detection
purpose as shown in Odani et al. [15]. A preferred term will be declared
as a potential safety signal for further investigation if the posterior
probability Pr(HRij > 1| Data) is greater than a pre-determined
threshold, e.g. 0.8 or 0.9 are common choices by researchers. Note
that even if the posterior probability is greater than the threshold, it only
gives us hints that the corresponding preferred terms may be a potential
safety signal. Further evaluations of the preferred terms are warranted.
The confirmation of a signal needs interdisciplinary effort including
clinicians, safety physicians, statisticians and experts in the disease area.

π j ∼ Beta(απ , βπ )
απ ∼ Exp(λα ) I[απ > 1]
βπ ∼ Exp(λβ ) I[βπ > 1]
where Exp () refers to the exponential distribution. απ and βπ are given
left-truncated exponential prior to let the posterior distribution of πj less
concentrated at 0 and 1. We use the same fixed values for the hyper­
parameters μγ00, τ2γ00, μθ00, τ2θ00, αγ00, βγ00, αθ00, βθ00, αθ, βθ, αγ, βγ, αγj, βγj,
αθj, βθj as in Model 1; λα and λβ are treated as fixed constant (λα = λβ =
0.1), which define a relatively uninformative exponentially distributed
prior.
3.3. Model 3: non-hierarchical model with normal prior on log hazard
ratio

3.6. Model selection

In this model, we no longer consider the hierarchical structure in
Model 1, but still assume the same likelihood and mean structure. No
information across the preferred terms or system organ classes will be
borrowed and thus all individual AEs will be regarded as if they were
independent. The prior distribution at Stage 2 of Model 1 now becomes:

We used deviance information criterion (DIC) for Bayesian model
selection when considering different models on the same data set. DIC is
a Bayesian hierarchical modeling generalization of the Akaike infor­
mation criterion (AIC), and is particularly useful in Bayesian model se­
lection. The deviance is defined as D[(θ)] = − 2 log (p(y| θ)) + h(y),
where y are the data, θ are the unknown parameters of the model, p(y| θ)
is the likelihood function, and h(y) is a normalizing function of the data
which is constant to the parameters. Then D = Eθ [D(θ) ] is the goodnessof-fit measure. And pD = D − D(̂
θ) is the representation of effective

μγij ∼ N(0, 10) and σ 2γij ∼ IG(3, 1)
μθij ∼ N(0, 10) and σ 2θij ∼ IG(3, 1)
The inverse gamma prior with constant parameters on σ 2γij and σ2θij are
chosen to have a stable sampling performance for the posterior distri­
bution based on the real example data. However, other priors can be
used based on model performance.

number of parameters, where ̂
θ is the estimation of θ. Analogous to AIC,
the DIC is calculated as DIC = pD + D. Like AIC, model with smaller DIC
is preferred.

3.4. Model 4: Bayesian meta-analysis model with normal priors on log
odds ratio

3.7. Data for simulation

This model is the 4-stage Bayesian hierarchical model developed by
Odani et al. [15], which assumed a binomial distribution on the number
of AEs instead of a Poisson distribution. That is, assuming Yijk~Binomial
(Ntk, ηijk) and Xijk~Binomial(Nck, ζijk), where Ntk and Nck are respectively
the number of patients in clinical trial k for treatment and placebo
groups; ηijk and ζijk are the incidence rate of an AE for the ith preferred
term under the jth system organ class in the kth clinical trial, for the
treatment and control groups respectively. Then a logistic model is
)
)
(
(
( )
( )
η
ζ
=
considered: logit ζijk = log 1− ijkζijk = γ ijk ; logit ηijk = log 1− ijkη
ijk
(
)
η (1− ζ )
γijk + θijk , where θijk = log ζijk 1− ηijk
is the logarithm of the odds ratio.
ijk (
ijk )

We first applied the 4-stage hierarchical model on the raw data of the
real-world example, then condensed the raw data from 419 preferred
terms and 21 system organ classes to 157 preferred terms and 18 system
organ classes in order to fairly compare the results from Model 1 and
Model 4, since Model 4 was used by Odani et al. [15] in a similar scale as
the condensed data set. For transparency, preferred terms with inci­
dence percentages greater than 5/10000 were included in the condensed
data set. Although the proposed models can handle the complete data
set, fewer preferred terms will reduce the model complexity, and make
the performances of the models more stable in simulations. Both simu­
lation results from the truncated data and raw data were provided in the
paper for a comprehensive view.
3

Y. Zhang et al.

Contemporary Clinical Trials 99 (2020) 106183

Table 2
Top 10 ranking of individual preferred terms regarding to association with treatment.
Fisher’s exact test

Model 1

Model 2

Model 3

Model 4

PT

p-value

PT

PP

PT

PP

PT

PP

PT

PP

Eye pain
Hypertension
Somnolence
Accidental overdose
Nervousness
Vision blurred
Vertigo
Flushing
Migraine
Throat tightness

0.002
0.002
0.010
0.016
0.031
0.038
0.049
0.056
0.057
0.062

Hypertension
Flushing
Pruritus
Dysgeusia
Heart rate increased
Urinary tract infection
Influenza
Hot flush
Disturbance in attention
Eye pain

0.899
0.896
0.845
0.818
0.785
0.785
0.731
0.727
0.725
0.724

Hypertension
Flushing
Pruritus
Hot flush
Hypotension
Eye pain
Vision blurred
Hypersensitivity
Dry eye
Ecchymosis

0.409
0.379
0.364
0.245
0.237
0.235
0.226
0.209
0.206
0.198

Hypertension
Eye pain
Nervousness
Ecchymosis
Throat tightness
Salivary hypersecretion
Dry eye
Drooling
Pharyngitis streptococcal
Tooth fracture

0.998
0.996
0.995
0.990
0.989
0.988
0.983
0.982
0.978
0.976

Hypertension
Flushing
Pruritus
Dysgeusia
Heart rate increased
Eye pain
Urinary tract infection
Hot flush
Disturbance in attention
Vision blurred

0.8884
0.8722
0.8368
0.7714
0.7457
0.7409
0.7403
0.7139
0.7025
0.6989

Note: PP: posterior probability Pr(HRij > 1| Data).
p-values were obtained from Fisher’s exact test by simple pooling method.
Model 1: Bayesian meta-analytical model with normal prior on log hazard ratio; Model 2: Bayesian meta-analysis model with mixture prior on log hazard ratio; Model
3: non-hierarchical model with normal prior on log hazard ratio; Model 4: Bayesian meta-analysis model with normal priors on log odds ratio.

4. Results of analyzing the real-world example

scenario 1. In scenario 2, we use the same number of patients in placebo
and treatment group from three trials exactly as in the real-world
example: 334 and 349 patients in placebo and treatment groups
respectively in the first trial; 381 and 366 patients in placebo and
treatment groups respectively in the second trial; 573 and 561 patients
in placebo and treatment groups respectively in the third trial. Each trial
has 419 preferred terms within 21 system organ classes as in the
example. The top 10 ranking individual preferred terms found by Model
1 from the example study are true signals in this scenario, and all other
preferred terms are not considered as safety signals.
In each Scenario, there are three setting as follows:
Setting 1: In this setting, the number of AEs of each preferred term is
assumed to come from a binomial distribution in which number of ex­
periments is the number of patients, and the event probabilities of
preferred terms are the same in both placebo and treatment group. In
scenario 1, these event probabilities are 5%, 10%, 1%, 10%, 5% and
15% for system organ class terms 1, 2, 3–6, 7–11, 12–16, and 17–18,
respectively; in scenario 2, the same event probabilities in system organ
class terms 1–18 for scenario 1 were used, and 15% of event probability
was used for preferred terms in system organ class terms 17–21. In
addition, we assume the exposure time for a true signal in the treatment
group following N(50, 12) while N(100, 12) in the control group. For nonsignals, both exposure times in treatment and control groups follow N
(100, 12). This setting is intended to mimic some trials where the AE
incidence percentages are similar, but the total exposure times differ.
Therefore, in theory, signals can only be detected if the Poisson likeli­
hood is used and the model with the binomial distribution (Model 4) is a
misspecified model.
Setting 2: In this setting, the total exposure time (summing over all
subjects) for each preferred term is set to be fixed and the same as those
in the real-world example. We assume the number of AEs follows a
Poisson(HR × ET), where HR is the hazard rate, and ET is the exposure
time. The hazard rates for a true signal term are 0.10 in the treatment
group and 0.05 in the control group. For non-signal terms, hazard rates
in treatment arm and control arm are 0.05. This setting is to mimic some
trials where the exposure times are similar in treatment arm and control
arm, but the hazard rates of AEs are different.
Setting 3: The exposure time for all preferred terms are assumed to
come from N(100, 12) in treatment group, whereas N(50, 12) for placebo
group. The numbers of AE come from Poisson(HR × ET), and the hazard
rate was a fixed constant at 0.05. This setting is to mimic some trials
where the exposure times are different between treatment arm and
control arm, while the hazard rates per person-year are similar for all
AEs. Note that there is no true signal in this setting.
Three measures are used to compare the performance of the models
on signal detection. The false detection rate (FDR) is defined to be the
expected number of the proportion of falsely detected signals among all

Table 1 gives the DIC scores for our three Poisson models. As can be
seen from Table 1, models with normal priors (Model 1 and 3) are
preferred. For normal prior models, the hierarchical model (Model 1)
achieves the smallest DIC, and thus should be preferred. DIC value for
Model 4 is not provided because the data used for binomial Bayesian
hierarchical model is different from that used for Poisson likelihood
models. Therefore Model 4 cannot be directly compared with other 3
models using DIC.
Table 2 presents the top 10 ranked individual preferred terms in
terms of their associations with treatment. Preferred terms are ranked in
the order of the posterior probability Pr(HRij > 1| Data). As shown in
Table 2, Model 1 and Model 4 are identical for 9 out of 10 preferred
terms. This result is expected because the differences in exposure
duration between treatment and placebo groups in our example are
small, so adjustment for different exposure duration of Poisson model
may not be needed. The values of the posterior probability obtained
from Model 1 are slightly greater than those from Model 4. Comparison
between the results from Model 1 with those from Fisher’s exact test
after simple pooling shows that only 3 of 10 preferred terms are identical
between these two approaches. Comparing the results from Model 1 and
Model 2 shows that 5 out of 10 preferred terms are identical, and a
notable difference between the two models is observed in the values of
the posterior probability: the values obtained from Model 1 are
considerably greater than those from Model 2; with flushing, for
instance, Pr(HRij > 1| Data) = 0.896 for Model 1, while Pr(HRij > 1|
Data) = 0.379 for Model 2. Similar phenomenon was also observed in
Odani et al.’s work [15] which is based on binomial likelihood. Model 3
only detects 2 out of 10 identical preferred terms with Model 1, and the
values of posterior probability obtained from Model 3 are greater than
Model 1.
5. Simulation study
We conducted three sets of simulations to evaluate the performance
of the proposed approaches (Model 1 to 3) and the model by Odani et al.
(Model 4) [15] in terms of power, false detection rate and type I error.
We considered two scenarios. In scenario 1, we generated 150 pa­
tients per group in the first and second trial and 300 patients in the third
trial using the preferred terms and system organ classes found in the
real-world example. Each trial had 157 preferred terms within 18 system
organ classes. The number of preferred terms and system organ classes
are close to those in Odani et al. [15]. The purpose is to have a fair
comparison between our proposed models and the model by Odani et al.
[15]. One preferred term in the first system organ class and five
preferred terms in the second system organ class are set to be signals in
4

Y. Zhang et al.

Contemporary Clinical Trials 99 (2020) 106183

Fig. 1. Power, false detection rate (FDR) and Type I error results for simulation study under Scenario 1 with 157 preferred terms and 18 system organ classes. Panel
(a) and (b) refer to the power and FDR respectively of four models and Fisher’s exact test in setting 1; Panel (c) and (d) refer to the power and FDR respectively of four
models and Fisher’s exact test in setting 2; Panel (e) refers the type I error of four models and Fisher’s exact test in setting 3.
Note: Model 1: Bayesian meta-analytical model with normal prior on log hazard ratio; Model 2: Bayesian meta-analysis model with mixture prior on log hazard ratio;
Model 3: non-hierarchical model with normal prior on log hazard ratio; Model 4: Bayesian meta-analysis model with normal priors on log odds ratio.

5

Contemporary Clinical Trials 99 (2020) 106183

Y. Zhang et al.

detected signals. The power is the expected value of the proportion of
correctly detected signals among all true signals. The type I error is the
expected number of proportions of falsely detected signals among nonsignal preferred terms. The FDR and power are used in the first two
settings of the simulation, and the type I error is only used in the third
setting of the simulation because no true signal is assumed. We sum­
marize the power, false detection rate and type I error for all models
across 1000 simulated trials.
The simulation results from scenario 1 are shown in Fig. 1 (also in
Appendix Table 1), which displays the power, FDR in simulation setting
1 and 2, or type I error in simulation setting 3. The X-axis in each panel
of Fig. 1 under each setting denotes different threshold values that are
used to calculate the posterior probability. The Y-axis is corresponding
to power, or FDR, or Type I error in different panels. A good choice of
threshold should give balanced values of power and FDR in Setting 1 and
2, and also the small value of the type I error. It can be seen that a
threshold value greater than 0.8 could be reasonable for Model 1 (red
line). With those threshold values (0.8 or 0.9), Model 1 will have more
than 90% power (panel (a), Fig. 1) and less than 23% FDR (panel (b),
Fig. 1) in Setting1, more than 76% power (panel (c), Fig. 1) and less than
32% FDR (panel (d), Fig. 1) in setting 2, and less than 2% type I error
(panel (e), Fig. 1) in setting 3. Model 2 (yellow line) and 3 (green line)
have either very small powers or very large FDRs in setting 1 and 2
which limits their usage in practice. It is interesting to observe Model 4
(blue line) always has larger FDRs than Model 1 even in Setting 1 (panel
(b), Fig. 1) where there should be no signals under the assumption of a
binomial likelihood. In setting 1, Model 4 has very small power when the
threshold value is greater 0.8 (panel (a), Fig. 1). This is expected since
the event percentages of AEs were the same. Model 4 with binomial
likelihood loses its capability to detect any signals under this setting. In
setting 2, Model 4 has slightly higher power and higher FDR than Model
1 (panel (c) and (d), Fig. 1), which indicates comparable overall per­
formance between these two models when the threshold is greater than
0.8. In the extreme Setting 3 where there should be no true signals in
terms of hazard rate ratio, Model 4 will always give false alarm with
type-I error close to 1 (panel (e), Fig. 1). This is understandable because
Model 4 does not take exposure time into account, and more adverse
events are expected over longer exposure times in the active drug
treatment arm. As a summary, when the hazard rate (i.e., exposure
adjusted incidence rate) is used as the risk measure, Model 1 will have
reasonably good performance with good power and relatively low FDR
in scenario I when the threshold is greater than 0.8 and outperform other
Bayesian hierarchical models.
The results of the scenario 2 simulation study are shown in Appendix
Table 2. The complexity of scenario 2 is much greater than that of sce­
nario 1 as the number of preferred terms and system organ classes are
much larger than that of scenario 1. Thus, all the Bayesian hierarchical
models have many more parameters to estimate which will impact the
model performance. As a result, we observe much lower power for all
models in scenario 2 than scenario 1, and they have similar trend.
Overall, Model 1 has better performance than Model 4 in terms of power
and FDR in the setting 1 and 2 of Scenario 2 as well.

6. Discussion
In this paper, we propose a four-stage Bayesian hierarchical metaanalytical model to a Poisson likelihood to detect safety signals when
there are multiple randomized clinical trials. The Poisson likelihood will
be a more reasonable choice to model safety events when the exposures
are different in the treatment arm and control arm, which is a scenario
that often occurs in clinical trials. The proposed model has several
merits: it takes into account potential confounding effect of trial, bor­
rows strength from both within and across system organ class through
the hierarchical structure of safety data, and considers the impact of
drug exposure on safety events by using the Poisson likelihood. The
simulation studies show the proposed model can improve the perfor­
mance for signal detection when multiple studies are combined over
some existing methods.
The biggest difference between the proposed model and the one
proposed by Odani et al. [15] is that we assume a Poisson distribution
while Odani et al. [15] assumes a binomial distribution of the number of
adverse events. The binomial distribution implicitly assumes that the
incidence rate of each preferred term is the risk measure. In contrast, the
Poisson distribution uses the hazard rate as the risk measure and thus
accounts for duration of exposure to the drug. In clinical trials, it is
commonly observed that for most adverse events, especially severe
adverse events, the incidence rate of a preferred term is small, but the
number of patients enrolled in a trial is relatively large, which leads to
statistical convergence from a binomial distribution to a Poisson distri­
bution according to central limit theorem [30]. As argued by many re­
searchers, the exposure time of a drug should be considered in safety
assessment [9,31]. Therefore, the Poisson model (Model 1) has a better
interpretation than a binomial model (Model 4). The results from
simulation studies present the advantage of Bayesian hierarchical model
with Poisson likelihood (Model 1) over the Bayesian hierarchical model
with binomial likelihood (Model 4) in terms of performance for signal
detection. However, one potential problem of using a Poisson assump­
tion is that the mean of the data should be equal (or close) to the vari­
ance in theory, which rarely happens in real data and usually results in a
problem of overdispersion in a Poisson model. Also, we noticed that
when the number of preferred terms and system organ classes increase,
the performance of all Bayesian hierarchical models deteriorates.
Therefore, for large trials with numerous AEs, some pre-screening steps
may be necessary to reduce the complexity of the problem. How to
screen AEs in an unbiased fashion warrants further research. In the
scenario where rare AEs are of particular interest due to its severity or
intensity, a zero-inflated Poisson likelihood could be considered. To
overcome the over dispersion in Poisson regression, the negative bino­
mial likelihood could also be considered. However, the meaning of that
parameter is not easy to understand by non-statisticians.
Acknowledgements
This work was supported by MRL Post Doc Program.

Appendix A

Table A.1
Power, false detection rate (FDR) and Type I error results for simulation study under Scenario 1 with 157 preferred terms and 18 system organ classes.
Setting 1

Setting 2

Setting 3

Threshold value

Power (%)

FDR (%)

Threshold value

Power (%)

FDR (%)

Threshold value

Type I error (%)

PP >0.5
PP >0.6

1.000
0.997

0.898
0.807

PP >0.5
PP >0.6

0.997
0.992

0.902
0.825

PP >0.5
PP >0.6

0.379
0.198
(continued on next page)

6

Y. Zhang et al.

Contemporary Clinical Trials 99 (2020) 106183

Table A.1 (continued )
Setting 1

Model 1

Model 2

Model 3

Model 4
Fisher’s test

Setting 2

Threshold value

Power (%)

FDR (%)

PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP

0.991
0.969
0.907
0.207
0.095
0.017
0.000
0.000
0.999
0.996
0.992
0.981
0.924
0.448
0.268
0.121
0.036
0.003
0.037

0.591
0.229
0.016
0.010
0.000
0.000
0.000
0.000
0.917
0.886
0.831
0.715
0.439
0.954
0.946
0.932
0.756
0.099
0.953

>0.7
>0.8
>0.9
>0.5
>0.6
>0.7
>0.8
>0.9
>0.5
>0.6
>0.7
>0.8
>0.9
>0.5
>0.6
>0.7
>0.8
>0.9

Model 1

Model 2

Model 3

Model 4
Fisher’s test

Setting 3

Threshold value

Power (%)

FDR (%)

PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP

0.975
0.927
0.765
0.125
0.073
0.035
0.013
0.001
0.984
0.967
0.939
0.875
0.722
0.998
0.993
0.978
0.935
0.783
0.584

0.641
0.318
0.039
0.034
0.009
0.002
0.000
0.000
0.920
0.896
0.859
0.789
0.630
0.912
0.848
0.693
0.379
0.054
0.592

>0.7
>0.8
>0.9
>0.5
>0.6
>0.7
>0.8
>0.9
>0.5
>0.6
>0.7
>0.8
>0.9
>0.5
>0.6
>0.7
>0.8
>0.9

Model 1

Model 2

Model 3

Model 4
Fisher’s test

Threshold value

Type I error (%)

PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP

0.076
0.016
0.001
0.002
0.001
0.000
0.000
0.000
0.472
0.358
0.254
0.156
0.067
1.000
1.000
1.000
0.999
0.993
0.285

>0.7
>0.8
>0.9
>0.5
>0.6
>0.7
>0.8
>0.9
>0.5
>0.6
>0.7
>0.8
>0.9
>0.5
>0.6
>0.7
>0.8
>0.9

Note: PP: posterior probability, the inference was made based on Pr(HRij > 1| Data)> (threshold value).
For Fisher’s exact test, the inference was made based on the two-sided test, p-value <0.05.
Model 1: Bayesian meta-analytical model with normal prior on log hazard ratio; Model 2: Bayesian meta-analysis model with mixture prior on log hazard ratio; Model
3: non-hierarchical model with normal prior on log hazard ratio; Model 4: Bayesian meta-analysis model with normal priors on log odds ratio.
Table A.2
Power, false detection rate (FDR) and Type I error results for simulation study under Scenario 2 with 419 preferred terms and 21 system organ classes.
Setting 1

Model 1

Model 2

Model 3

Model 4
Fisher’s test

Setting 2

Setting 3

Threshold value

Power (%)

FDR (%)

Threshold value

Power (%)

FDR (%)

Threshold value

Type I error (%)

PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP

1.000
0.996
0.962
0.651
0.298
0.001
0.000
0.000
0.000
0.000
0.996
0.994
0.987
0.953
0.871
0.453
0.207
0.054
0.005
0.000
0.046

0.942
0.870
0.616
0.173
0.005
0.006
0.000
0.000
0.000
0.000
0.949
0.933
0.902
0.841
0.662
0.975
0.975
0.974
0.751
0.027
0.975

PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP

0.998
0.993
0.951
0.756
0.276
0.000
0.000
0.000
0.000
0.000
0.997
0.994
0.985
0.952
0.861
0.993
0.954
0.819
0.465
0.170
0.785

0.943
0.888
0.724
0.355
0.038
0.005
0.001
0.001
0.000
0.000
0.949
0.932
0.901
0.839
0.661
0.896
0.767
0.490
0.168
0.017
0.690

PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP
PP

0.335
0.146
0.043
0.005
0.000
0.086
0.017
0.004
0.001
0.000
0.472
0.359
0.254
0.156
0.067
1.000
1.000
1.000
1.000
0.999
0.339

>0.5
>0.6
>0.7
>0.8
>0.9
>0.5
>0.6
>0.7
>0.8
>0.9
>0.5
>0.6
>0.7
>0.8
>0.9
>0.5
>0.6
>0.7
>0.8
>0.9

Model 1

Model 2

Model 3

Model 4
Fisher’s test

>0.5
>0.6
>0.7
>0.8
>0.9
>0.5
>0.6
>0.7
>0.8
>0.9
>0.5
>0.6
>0.7
>0.8
>0.9
>0.5
>0.6
>0.7
>0.8
>0.9

Model 1

Model 2

Model 3

Model 4
Fisher’s test

>0.5
>0.6
>0.7
>0.8
>0.9
>0.5
>0.6
>0.7
>0.8
>0.9
>0.5
>0.6
>0.7
>0.8
>0.9
>0.5
>0.6
>0.7
>0.8
>0.9

Note: PP: posterior probability, the inference was made based on Pr(HRij > 1| Data)> (threshold value).
For Fisher’s exact test, the inference was made based on the two-sided test, p-value <0.05.
Model 1: Bayesian meta-analytical model with normal prior on log hazard ratio; Model 2: Bayesian meta-analysis model with mixture prior on log hazard ratio; Model
3: non-hierarchical model with normal prior on log hazard ratio; Model 4: Bayesian meta-analysis model with normal priors on log odds ratio.

References
[1] European Medicines Agency, ICH E2A Clinical Safety Data Management:
Definitions and Standards for Expedited Reporting, Available from: https://www.
ema.europa.eu/en/ich-e2a-clinical-safety-data-management-definitions-stan
dards-expedited-reporting, 1995.
[2] European Medicines Agency, ICH E2C (R2) Periodic Benefit-Risk Evaluation
Report, Available from: https://www.ema.europa.eu/en/ich-e2c-r2-periodic-b
enefit-risk-evaluation-report, 2013.
[3] U.S. Food and Drug Administration, Enhancing Benefit-Risk Assessment in
Regulatory Decision-Making, Archived on 12 Dec 2019 at, https://web.archive.
org/web/20191212200458/https://www.fda.gov/industry/prescription-drug-use
r-fee-amendments/enhancing-benefit-risk-assessment-regulatory-decision-making.
[4] U.S. Food and Drug Administration, Safety Reporting Requirements for INDs
(Investigational New Drug Applications) and BA/BE (Bioavailability/

[5]

[6]
[7]
[8]

7

Bioequivalence) Studies, Available from, https://www.fda.gov/regulatory-informa
tion/search-fda-guidance-documents/safety-reporting-requirements-inds-investiga
tional-new-drug-applications-and-babe, 2012.
European Medicines Agency, Common technical document for the registration of
pharmaceuticals for human use, 2016. Available from: https://www.ema.europa.
eu/en/documents/scientific-guideline/ich-m4e-r2-common-technical-document-re
gistration-pharmaceuticals-human-use-efficacy-step-5_en.pdf (Accessed 30 April
2020).
P.E. Greenwood, M.S. Nikulin, A Guide to Chi-Squared Testing. Wiley Series in
Probability and Statistics vol. 280, Wiley-Interscience, 1996 (ISBN: 978-0-47155779-1).
F.J. Yates, Contingency tables involving small numbers and the chi-squared test,
Suppl. J. R. Stat. Soc. 1 (2) (1934) 217–235.
S.J. Evans, P.C. Waller, S. Davis, Use of proportional reporting ratios (PRRs) for
signal generation from spontaneous adverse drug reaction reports,

Y. Zhang et al.

[9]

[10]
[11]

[12]

[13]
[14]
[15]

[16]

[17]
[18]

[19]

Contemporary Clinical Trials 99 (2020) 106183
[20] V.R. Cornelius, M.J. Perrio, S.A. Shakir, L.A. Smith, Systematic reviews of adverse
effects of drug interventions: a survey of their conduct and reporting quality,
Pharmacoepidemiol. Drug Saf. 18 (12) (2009 Dec) 1223–1231, https://doi.org/
10.1002/pds.1844 (PubMed PMID: 19757414).
[21] F. Warren, K. Abrams, S. Golder, et al., Systematic review of methods used in metaanalyses where a primary outcome is an adverse or unintended event, BMC Med
Res Methodol. 12 (2012) 64, https://doi.org/10.1186/1471-2288-12-64.
[22] J.A. Berlin, B.J. Crowe, E. Whalen, H.A. Xia, C.E. Koro, J. Kuebler, Meta-analysis of
clinical trial safety data in a drug development program: answers to frequently
asked questions, Clin Trials. 10 (1) (2013 Feb) 20–31, https://doi.org/10.1177/
1740774512465495 (Epub 2012 Nov 21. PubMed PMID: 23171499).
[23] J.A. Bridge, S. Iyengar, C.B. Salary, R.P. Barbe, B. Birmaher, H.A. Pincus, L. Ren, D.
A. Brent, Clinical response and risk for reported suicidal ideation and suicide
attempts in pediatric antidepressant treatment: a meta-analysis of randomized
controlled trials, JAMA. 297 (15) (2007 Apr 18) 1683–1696 (PubMed PMID:
17440145).
[24] S.E. Nissen, K. Wolski, Effect of rosiglitazone on the risk of myocardial infarction
and death from cardiovascular causes, N Engl J Med. 356 (24) (2007 Jun 14)
2457–2471 (Epub 2007 May 21).
[25] A.G. Chakravarty, R. Izem, S. Keeton, C.Y. Kim, M.S. Levenson, M. Soukup, The
role of quantitative safety evaluation in regulatory decision making of drugs,
J. Biopharm. Stat. 26 (1) (2016) 17–29, https://doi.org/10.1080/
10543406.2015.1092026 (Review. PubMed PMID: 26372792).
[26] J. Wittes, B. Crowe, C. Chuang-Stein, A. Guettner, D. Hall, Q. Jiang,
D. Odenheimer, H.A. Xia, J. Kramer, The FDA’s final rule on expedited safety
reporting: statistical considerations, Stat Biopharm Res. 7 (3) (2015 Jul 3) 174–190
(Epub 2015 Oct 9. PubMed PMID: 26550466; PubMed Central PMCID:
PMC4606817).
[27] M. Egger, G.D. Smith, A.N. Phillips, Meta-analysis: principles and procedures, BMJ
315 (7121) (1997 Dec 6) 1533–1537 (PubMed PMID: 9432252; PubMed Central
PMCID: PMC2127925).
[28] M. Lièvre, M. Cucherat, A. Leizorovicz, Pooling, meta-analysis, and the evaluation
of drug safety, Curr Control Trials Cardiovasc Med. 3 (1) (2002 Mar 19) 6 (PubMed
PMID: 11991807; PubMed Central PMCID: PMC134478).
[29] H.A. Xia, Q. Jiang, Statistical evaluation of drug safety data, Ther Innov Regul Sci.
48 (1) (2014 Jan) 109–120, https://doi.org/10.1177/2168479013510917
(PubMed PMID:30231415).
[30] A. Papoulis, S.U. Pillai, Probability, Random Variables, and Stochastic Processes,
4th edition, Tata McGraw-Hill Education, 2014 (ISBN-13: 978-0990637202).
[31] M. Arnaud, B. Bégaud, N. Thurin, N. Moore, A. Pariente, F. Salvo, Methods for
safety signal detection in healthcare databases: a literature review, Expert Opin.
Drug Saf. 16 (6) (2017 Jun) 721–732, https://doi.org/10.1080/
14740338.2017.1325463 (Epub 2017 May 15. PubMed PMID: 28490262).

Pharmacoepidemiol. Drug Saf. 10 (6) (2001 Oct-Nov) 483–486 (PubMed PMID:
11828828).
L. Huang, J. Zalkikar, R. Tiwari, Likelihood-ratio-test methods for drug safety
signal detection from multiple clinical datasets, Comput Math Methods Med. 2019
(2019 Feb 19) 1526290, https://doi.org/10.1155/2019/1526290, eCollection
2019. PubMed PMID: 30915153; PubMed Central PMCID: PMC6399568. Available
at: https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6399568/.
A. Bate, M. Lindquist, I.R. Edwards, S. Olsson, R. Orre, A. Lansner, R.M. De Freitas,
A Bayesian neural network method for adverse drug reaction signal generation,
Eur. J. Clin. Pharmacol. 54 (4) (1998 Jun) 315–321. 9696956.
W. DuMouchel, Bayesian data mining in large frequency tables, with an application
to the FDA spontaneous reporting system (with discussion), Am. Stat. 53 (1999)
177–202. Available at: https://www.ncbi.nlm.nih.gov/pmc/articles/PM
C2694945/. (Accessed 30 April 2020).
A. Szarfman, S.G. Machado, R.T. O’Neill, Use of screening algorithms and
computer systems to efficiently signal higher-than-expected combinations of drugs
and events in the US FDA’s spontaneous reports database, Drug Saf. 25 (6) (2002)
381–392 (PubMed PMID: 12071774).
S.M. Berry, D.A. Berry, Accounting for multiplicities in assessing drug safety: a
three-level hierarchical mixture model, Biometrics 60 (2) (2004 Jun) 418–426
(PubMed PMID: 15180667).
H.A. Xia, H. Ma, B.P. Carlin, Bayesian hierarchical modeling for detecting safety
signals in clinical trials, J. Biopharm. Stat. 21 (5) (2011 Sep) 1006–1029, https://
doi.org/10.1080/10543406.2010.520181 (PubMed PMID: 21830928).
M. Odani, S. Fukimbara, T. Sato, A Bayesian meta-analytic approach for safety
signal detection in randomized clinical trials, Clin Trials. 14 (2) (2017 Apr)
192–200, https://doi.org/10.1177/1740774516683920 (Epub 2017 Jan 6.
PubMed PMID: 28059578).
M. Kulldorff, I. Dashevsky, T.R. Avery, A.K. Chan, R.L. Davis, D. Graham, R. Platt,
S.E. Andrade, D. Boudreau, M.J. Gunter, L.J. Herrinton, P.A. Pawloski, M.
A. Raebel, D. Roblin, J.S. Brown, Drug safety data mining with a tree-based scan
statistic, Pharmacoepidemiol. Drug Saf. 22 (5) (2013 May) 517–523, https://doi.
org/10.1002/pds.3423. Epub 2013 Mar 20, 23512870.
G.N. Norén, J. Hopstadius, A. Bate, et al., Temporal pattern discovery in
longitudinal electronic patient records, Data Min. Knowl. Disc. 20 (2010) 361–387,
https://doi.org/10.1007/s10618-009-0152-3.
M.J. Schuemie, P.B. Ryan, G. Hripcsak, D. Madigan, M.A. Suchard, Improving
reproducibility by using high-throughput observational studies with empirical
calibration, Philos Trans A Math Phys Eng Sci. 376 (2128) (2018 Sep 13), https://
doi.org/10.1098/rsta.2017.0356 pii: 20170356. (PubMed PMID: 30082302;
PubMed Central PMCID: PMC6107542).
W. DuMouchel, Multivariate Bayesian logistic regression for analysis of clinical
study safety issues, Stat. Sci. 27 (3) (2012) 319–339.

8

