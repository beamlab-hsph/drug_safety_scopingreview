False Discovery Rate Estimation for Frequentist Pharmacovigilance Signal Detection
Methods
Author(s): I. Ahmed, C. Dalmasso, F. Haramburu, F. Thiessard, P. Broët and P. TubertBitter
Source: Biometrics , MARCH 2010, Vol. 66, No. 1 (MARCH 2010), pp. 301-309
Published by: International Biometric Society
Stable URL: https://www.jstor.org/stable/40663179
REFERENCES
Linked references are available on JSTOR for this article:
https://www.jstor.org/stable/40663179?seq=1&cid=pdfreference#references_tab_contents
You may need to log in to JSTOR to access the linked references.
JSTOR is a not-for-profit service that helps scholars, researchers, and students discover, use, and build upon a wide
range of content in a trusted digital archive. We use information technology and tools to increase productivity and
facilitate new forms of scholarship. For more information about JSTOR, please contact support@jstor.org.
Your use of the JSTOR archive indicates your acceptance of the Terms & Conditions of Use, available at
https://about.jstor.org/terms

International Biometric Society is collaborating with JSTOR to digitize, preserve and extend
access to Biometrics

This content downloaded from
128.103.147.149 on Thu, 30 Sep 2021 16:06:02 UTC
All use subject to https://about.jstor.org/terms

Biometrics 66, 301-309 DOI: 10.HH/j.1541-0420.2009.01262.x

March 2010

False Discovery Rate Estimation for Frequentisi Pharmacovigilance
Signal Detection Methods

I. Ahmed,1 2* C. Dalmasso,3 F. Haramburu,4 5 F. Thiessard,5 6 7 P. Broët,3 and P. Tubert-Bitter1 2
^nserm U780, Villejuif, F-94807, France
2Univ Paris-Sud, IFR69, Villejuif, F-94807, France
3JE2492, Faculty of Medicine Paris-Sud, Univ Paris-Sud, Villejuif, F-94807, France
4Inserm U657, Bordeaux, F-33076, France
5Pellegrin Hospital, Bordeaux, F-33076, France
6LESIM, Univ Victor Segalen Bordeaux 2, Bordeaux, F-33076, France
7Inserm U897, Bordeaux, F-33076, France
* email: ismail.ahmed@inserm.fr

Summary. Pharmacovigilance systems aim at early detection of adverse effects of marketed drugs. They maintain large
spontaneous reporting databases for which several automatic signaling methods have been developed. One limit of those
methods is that the decision rules for the signal generation are based on arbitrary thresholds. In this article, we propose a new
signal-generation procedure. The decision criterion is formulated in terms of a critical region for the P-values resulting from
the reporting odds ratio method as well as from the Fisher's exact test. For the latter, we also study the use of mid-P-values.
The critical region is defined by the false discovery rate, which can be estimated by adapting the P-values mixture model
based procedures to one-sided tests. The methodology is mainly illustrated with the location-based estimator procedure. It is
studied through a large simulation study and applied to the French pharmacovigilance database.
Key WORDS: False discovery rate; Fisher's exact test; Location-based estimator; Mid-P-values; Mixture model; Multiple
comparisons; One-sided P-values; Pharmacovigilance; Reporting odds ratio.

1. Introduction

European Medicines Agency EudraVigilance database, the
BCPNN collect
by the Uppsala Monitoring Centre on the WHO
Pharmacovigilance systems for marketed medicines
safety database,
and monitor spontaneous reports of suspected adverse
eventsand the MGPS on the database of the FDA
(Almenoff
et al., 2005). The BCPNN and the MGPS are befrom health-care providers. The accumulation of
such reports
yond after
the scope
of this article as the methodological develallows detecting new adverse drug reactions (ADRs)
the
opments that will be presented in the sequel are devoted to
drug marketing approval.
non-Bayesian
approaches.
In 2005, the postmarketing databases held by
the World
All those
methods are currently based on empirical or even
Health Organisation (WHO) and the Food and Drugs
Adminarbitrary
each drug-adverse event count n¿j being
istration (FDA) contained, respectively, more than
3.7 thresholds;
and
separately
tested without taking into account the multiple
3 millions of reports (Almenoff et al., 2005). It
is therefore
comparisons.
Despite the data mining feature of the analysis
not surprising that over the last 10 years, regulatory
agencies
of spontaneous reporting pharmacovigilance database, there
and drug monitoring systems have developed computerized
is a potential
improvement in grounding those thresholds on
statistical methods for the automatic generation
of signals.
statistical
error of
limiting constraints. A large literature exists
The aim of such methods is not to substitute the
expertise
to address
massive
the pharmacovigilance experts but rather to draw
attention
to hypothesis testing but is largely devoted to
thegenerators.
microarray data analysis field. The methods are based on
unexpected associations by acting as hypotheses
assessing
or controlling error rates criteria, such as the famThe signals thus generated are then destined to
be further
ily wise error rate (FWE; Hochberg and Tamhane, 1987) deanalyzed.
fined as the probability of committing a false discovery or the
The most common proposed methods in the literature are
false discovery rate (FDR; Benjamini and Hochberg, 1995) dethe proportional reporting ratio (PRR; Evans, Waller, and
fined as the expectation of the proportion of false discoveries.
Davis, 2001), the reporting odds ratio (ROR; van PuijenThe latter, being more liberal than the FWE, is particularly
broek et al., 2002), and two Bayesian methods: the Bayesian
adapted for screening purposes and since the seminal paper
confidence propagation neural network (BCPNN; Bate et al.,
of Benjamini and Hochberg (1995), a very large number of
1998; Norén et al., 2006) and the (multi) gamma Poisson
procedures have been proposed for its estimation. In particushrinker ((M)GPS; DuMouchel, 1999; DuMouchel and Preglar, a popular approach consists in assuming a mixture model
ibon, 2001). The PRR and the ROR have been used on the
© 2009, The International Biometrie Society 301

This content downloaded from
128.103.147.149 on Thu, 30 Sep 2021 16:06:02 UTC
All use subject to https://about.jstor.org/terms

302 Biometrics, March 2010

for the marginal distribution
of the are
P- initially
values constructed
resulting
fr
ing procedures
for
P
the tests (Qvalue, Storey and
from Tibshirani,
two-sided hypothesis
2003;
testing
beta-unifo
whereas, i
the objective2003;
is to point
drug-adverse
mixture [BUM], Pounds lance,
and Morris,
spacings
LO
often
reported
for being
due
to chance. bas
Thu
histogram [SPLOSH], Pounds
and
Cheng
2004;
location
work
will beand
devoted
to the adaptation
estimator [LBE], Dalmasso,
Broët,
Moreau,
2005). of tho
Pharmacovigilance data can
one-sided
be summarized
hypotheses.
as a large / x
J contingency table crossing
Section
all2 drugs
introduces
and
the adverse
notations for
event
the R
mentioned at least once in a spontaneous report. When a
RFET, and the ROR before detailing the LBE
spontaneous report involves several drugs and/or several ad- its derivation in the case of one-sided tests. This article foverse events, which is generally the case, each combination cuses on the RFET and the ROR methods because (i) they
of drug-adverse event pairs is reported. This table is mainlyare based on the same association measure and (ii) it was
characterized by its high proportion of empty cells. For in-shown that the ROR and the PRR exhibit minor differences
stance, the contingency table corresponding to the French re-in practice for the signal generation (Waller et al., 2004; Roux
ports collected between 1984 and 2002 and coded with the
et al., 2005). Section 3 presents the results of a large simulahierarchies ATC5 (anatomical therapeutic chemical; Millertion study in which the RFET, the midRFET, and the ROR
and Britt, 1995) for the drugs and HLT (high level terms; are compared according to the FDR and its estimation with
Brown, Wood, and Wood, 1999) for the adverse effects con- the LBE procedure. Part of the simulation section is also detains 82.3% of empty cells. Additionally, a large proportion voted to the comparison of the four P-values mixture modelof the nonempty cells contain small counts. In the same ex- ing procedures cited above. Section 4 presents the application
ample, 51.2% of the 97,462 nonempty cells of the Frenchof the proposed methodology on the data of the French spondatabase contains one or two counts and 29.5% between 3
taneous reporting system. Some elements of discussion are
and 10 counts.
provided in Section 5.
For a pair (adverse effect z, drug j), the association measures
2. Methods
provided by the different methods are calculated by collapsing the data into the 2 by 2 contingency table presented
The
in aim of pharmacovigilance signal detection method
Table 1 where 7i¿j,n¿., and n.j, respectively, denote the numgenerate signals for which the reported counts n¿jS are s
icantly greater than what would be expected by chanc
ber of reports involving the pair (z, j), the marginal count
RFET and the ROR are based on the odds ratio association
involving the adverse event z, and the marginal count involving the drug j. PRR and ROR methods are based on the
measure denoted by i/j. Thus, in a hypothesis testing setting
calculation of the relative risk and the odds ratio in this 2 and
by for a cell (z, j), the objective is to test
2 table. One potential limit of both methods lies in the fact
HOij : ipij ^ ipo versus Hi.. : xp^ > ip0. (1)
that their signal-generation process is based on the derivation
of a confidence interval that requires a normal approximation
True associations in the database are defined by ip > 1 and
whereas a large part of the riijS are small. The Fisher's exact
correspond then to choose ip0 = 1 but it can be of interest to

test is thus studied as an alternative to the ROR and the PRR

focus on stronger associations and thus, to use values of ip0
methods. The test is simple to use and not based on any disgreater than one.

tribution approximation. It will be referred to as the reporting

2.1 P-values for Odds Ratio-Based Signaling Methods
Fisher's exact test (RFET). Moreover, as the Fisher's exact

test is known to be conservative, we also investigate the use2.1.1 The reporting Fisher's exact test. For a cell (i, j), the
construction of the test assumes that the marginal counts
of mid-P- values referred to as the midRFET (Agresti, 2002).
More generally, in this article, an original signal-generation
(n¿.,n.j, n) of Table 1 are fixed. It results that the random
methodology based on (mid-) P- values is proposed for thevariable JV¿¿ | n¿. , n.j , n is distributed according to an noncenRFET as well as for the confidence interval methods (ROR,
tral hypergeometric distribution (Agresti, 2002). The P-values
PRR). This methodology allows us to derive the FDR by the
associated to the test equation (1) are then calculated by pij =
use of P- values mixture modeling based procedures like those
Pr(Nij ^ riij |ra¿., n.¿, n; ip0). Moreover, as the Fisher's excited above and thus to take into account the multiple comact test is known to be conservative, we also investigated the
parisons for the definition of a threshold. The methodologyuse
is of mid-P-values defined as |Pr (JV¿ j = ni<7- | n¿. , n.j , n; xp$) +
presented and mainly illustrated with the location-based estiPr(Nij > riij | n¿. , ra.¿ , n; ipQ). To make the reading of the article easier, the mid-P-values for the RFET will be referred to
mator (LBE) which was shown, in simulation studies, to proas the P-values for the midRFET.
vide good performances in terms of bias, standard deviation,
and root mean square error (Dalmasso et al., 2005; Lai, 2007).2.1.2 The reporting odds ratio. For a nonempty cell (z, j),
A difficulty comes from the fact that P-values mixture modelthe ROR is calculated as the observed odds ratio in Table 1,
that is:

Table 1

Two by two table for the adverse event-drug pair (z, j)

Drug j Other drugs

Adverse event i n¿¿ n¿.
Other adverse events nj n

_ riij(n -n.j - n¿. +n¿j)
ij _ ~ (m. -riijXn.j -rii/)

It is then assumed that the logarithm of ip]- is nor-

mally distributed with a variance estimated with the delta

method: var{ln(^)} = l/n¿i + l/(n - nmj - rii. + n¿j) + 1/
(n¿. - riij) + l/(™.¿ - Tiij). In practice, a signal is generated

This content downloaded from
128.103.147.149 on Thu, 30 Sep 2021 16:06:02 UTC
All use subject to https://about.jstor.org/terms

FDR Estimation for Frequentisi Pharmacovigilance Signal Detection Methods 303
if the lower bound of the two-sided 95% confidence interval of

E¡MP)i = 7r°+(1-7r°)EaRp)}; (4)

'n(ipij) is greater than 0 (van Puijenbroek et al., 2002).
This method can also be viewed as a one-sided hypoth-

nonnegative term

esis test at level 2.5% for equation (1) with ipQ = 1 and

where the P-values are calculated as p¿j = 1 - $[ln(^);
where Eo{(p(P)} and Ei{(p(P)} denote the expectation of a
transformation ip of P under the null and the alternative hyln^o^varjln^)}172] with ${ln(^); a, b} being the cu-

mulative distribution function (cdf) at ln^j) of a normal
potheses. (f(p) = {-In (1 - p)}a with a G IR+ is chosen to

distribution J'T(a, b).

minimize the nonnegative term in equation (4), which leads

2.2 Multiple- Hypothesis Testing

to the following estimator for tto:

2.2.1 FDR for simple null hypotheses. Let Fand R be two
random variables denoting, respectively, the number of erroneously generated signals and the number of generated sig- Wo „ = E{y>(P)} = a = ,3

nals. Benjamini and Hochberg (1995) defined the FDR as Wo
E{(V/R) | <R>0}Pr(.R>0) and proposed a step-up procedure

= E«MP)} = EoM?)} =

where F denotes the gamma functio
to control it at a given level, say a. This procedure was subseet al. (2005) showed that their estim
quently improved (see, for instance, Benjamini, Krieger, and
normally distributed and provides an
Yekulti, 2006). Relatively recently, Storey (2002) and Storey
ance depending on a. The latter acts
and Tibshirani (2003) made popular an alternative measure
trade-off and is chosen in the seque

related to the FDR: the positive FDR (pFDR) defined asdard
E{(V/R)'R>0} by giving it a simple Bayesian interpreta-

deviation of the LBE estimator is less than 0.05.

2.2.2 FDR for one-sided hypotheses. In this article, the null
tion in term of posterior probability of the null hypothesis.
hypothesis (1) is one-sided. Thus, the P-values resulting from
The pFDR had been previously considered in Benjamini and
the ROR, the RFET, or the midRFET are not calculated
Hochberg (1995) as an alternative to the current formulation
under Ho but under the hypothesis Jf/0* • ipij = ^o- As a
of the FDR but had been ruled out as it was not possible to
result, the distribution of P under Ho is no longer uniform.
control it at level a < 1 (in a frequentist framework). From
In view of the marginal distributions of the P-values obtheir definition, FDR and pFDR are asymptotically equivaserved on the French data, illustrated for instance for the
lent because Pr (R > 0) tends to 1 when the number of tested
midRFET in Figure 5, the distribution /0 of P under Ho is ashypotheses m tends to infinity. As the number of tested hysumed to be a nondecreasing function expressed as a mixture
potheses is very large in pharmacovigilance, the notation FDR
of a uniform distribution and a nondecreasing function fu(p)
will be used in the sequel in reference to both criteria. The
for which there is a pQ G [0, 1] with /i*(po) = 0. Thus model

Bayesian approach proposed by Storey (2002) is based on a
(2) becomes f(p) = 7ro{7ro* + (1 - 7r0*) fu(p)} + (1 - tto)x
fi(p) and model (3) is expressed as:
tics PijS assumed independent and identically distributed:

mixture model for the marginal distribution of the test statis-

/(p) = 7ro/o(p) + (l-7TO)/i(p), (2)

FDR( x = Mno*Fo*(if) + Í1 - *o*)*i*(7)} /5x

where /o and f' are the probability distribution functions of
As large values of FDR, typically larger than 0.15, are not
the test statistics under the null and the alternative hypotheof interest, only small values of 7 will be considered. By asses and 7T0 the probability of the null hypothesis. In particular, when the PijS are given in the form of P-values,suming
Storeythat they are less than pOi equation (5) reduces to
showed that the FDR associated to a rejection region FDR(7)
[0, 7] = 7ro7ro*7/F(7) and the issue is then to estimate tt0
with 7 G [0, 1] for the P-values is equal to

7t0*. Recently Pounds and Cheng (2006) investigated with

simulations a special case of the LBE method with identity function (p and conveniently used the transformation
P* = 1 - 2'P - ¿I for one-sided P-values. It can be shown unwhere Fo denotes the cdf of the test statistics under der
the weak
null assumptions on f' and /1+ (see proof of lemma in
Web
Appendix A) that P* = 1 - 2'P - '' has a nonincreashypothesis and F their marginal cdf. Because the P-values are
ing(2)marginal
probability distribution function that can be exuniformly distributed under the null hypothesis, model
repressed
duces to f(p) = 7T0 + (1 - tto)/i(p) and model (3) can be
ex- as fp*(p*) = ttoTTo* + (1 - 7rO7r()*)/ip*(p*) and the LBE
as well as procedures based on model (2) can thus
pressed as FDR(7) = ^7/^(7). ^(7) can be estimated procedure
using
be applied to P* to estimate an upper bound of ttoTTo*.
the empirical distribution function of the observed P-values

FDR(7) = ^M (3)

F(j) = #{Pij ^ l)/m. The main difficulty lies in estimating

3. Simulations

7T0.

Without any strong hypothesis on fu model (2) is nonidentifiable and only an upper bound of 7r0 can be estimated which

necessarily leads to biased upward estimations of the FDR. All
the following estimation methods, except SPLOSH, assume
that /and therefore f' are nonincreasing. Qvalue, BUM, and
SPLOSH aim at estimating tt0 + (1 - 7r0) infp{/i(p)} and LBE
a larger upper bound:

The simulation study was conducted in order (i) to com
the performances of the ROR, RFET, and midRFET acco
ing to the FDR and (ii) to assess the estimation of the F
by the proposed methodology for the three methods. C
lations were done with R (R Development Core Team, 2
In particular, the LBE package can be downloaded from
Bioconductor website at http://bioconductor.org/.

This content downloaded from
128.103.147.149 on Thu, 30 Sep 2021 16:06:02 UTC
All use subject to https://about.jstor.org/terms

304 Biometrics, March 2010
3.1 Data Generation

with p¡ = ^2j Pij and PSj - S¿ Pij being, respectively, the

Five hundred contingency tables with the same sizemarginal
as the probabilities of observing the adverse event i and of
being exposed to drug j in the simulated database.
French pharmacovigilance database were generated. For a
Thus, for each dataset the proportion of false discoveries
simulation s, the numbers of ADRs were generated acdifferent rejection regions is known and the true FDR
cording to a multinomial distribution: (nsn, n'2i . . . , nfj) given
~
is
estimated
by averaging those proportions of false discoverMu(n, ps), where ps = (pbn, p'2, . . . ,P/j), and n is the sum of
the riijS in the French database, p* is calculated as follows:ies over the 500 generated datasets. Different null hypotheses
based on tpo = 1, 2, or 5 were tested.
's

s

s

3.2 Results of the Simulations
3.2.1 Comparison of the densities of the P-values. The first
part of the simulations was devoted to the empirical study
of the distributional hypotheses for the P-values. This analysis was conducted on 50 datasets for computational reasons
whereas the results presented in the next section are based on

ij

where ln(A^) ~ logistic(0, 0.5), (rf_ , . . . , r| ) ~ Dirichlet(nL ,

. ..,n/.) and (r;', . . . ,rsj) ~ Dirichlet(n.i, . . . , n.j), that is,

by using the marginal counts of the French database. The
true odds ratio of the cell (i, j) is thus equal to

500 datasets.

Figure 1 shows distributions of the P-values derived from
the ROR, RFET, and midRFET for ip0 = 1. The four
columns, respectively, show P- value density histograms resulting from the ROR, RFET, and midRFET applied to the

.. Ph(i+ph-pi-p%)
13 (Pi.-Pij)fa-rti) '

ROR:nij>1
*~

RFET:n¡j>1
r».

o

midRFET

-,

CO

00

-

-

:

n

_.

nij

1

ROR:n¡¡>3

-,

CM

-

CD-I

io

>

^

*~

-

^~

o

-

^ co-

ti "■

CM"

^"ll,

*

~

o I lllltTiTTmmiiiiiiiiii

0.0 0.2 0.4 0.6 0.8 1.0 0.0 0.2 0.4 0.6 0.8 1.0 0.0 0.2 0.4 0.6 0.8 1.0 0.0 0.2 0.4 0.6 0.8 1.0

(a)

"1

(d)

l'I

I

o _

(g)

'I

(j)

?1

co-

^

00

CO

-

-

s

o

y-

*

-

-I

o lllfiÏÏIIIIIIIIllllllllllllllliTïïïïïïniIllliillllI o I num

0.0 0.2 0.4 0.6 0.8 1.0 0.0 0.2 0.4 0.6 0.8 1.0 0.0 0.2 0.4 0.6 0.8 1.0 0.0 0.2 0.4 0.6 0.8 1.0
(b)

sl

(e)

lì

S2~
*"

*~

«
CO

-

(h)

(k)

»-i

«-i

?"

8-

"

O _

m

_

o _

*

"

W

"

0.0 0.2 0.4 0.6 0.8 1.0 0.0 0.2 0.4 0.6 0.8 1.0 0.0 0.2 0.4 0.6 0.8 1.0 0.0 0.2 0.4 0.6 0.8 1.0
(c)

(f)

(i)

(I)

Figure
1.
b,
c)
and
t
to
the
non
of
the
P-v

ipij

^

This content downloaded from
128.103.147.149 on Thu, 30 Sep 2021 16:06:02 UTC
All use subject to https://about.jstor.org/terms

l(HO

FDR Estimation for Frequentisi Pharmacovigilance Signal Detection Methods 305

nonempty cells and from the ROR applied to cells with riijIn^ comparison, LBE provides satisfying results. Additional
simulations results, which are provided in Web Appendix B
3. The rows, respectively, show the P-value density histograms
1 and 2), confirm those results.
for all cells, for cells with ipij ^ 1, and for cells with ipij >(Figures
1.
It can be seen on this figure that the marginal distributions 3.2.3 FDR. The first set of figures (Figure 3) shows the
average curve of the estimated FDR and the true values of it
(Figures la, d, g, and j) and the distributions under the alternative hypothesis of the P-values (Figures lc, f, i, andfor
1) ^o = l,2, and 5 when using the P-values resulting from
are consistent with the distribution assumptions exposed in
the ROR, RFET, and midRFET on all nonempty cells {niá ^
Section 2.2.2. Figure lb shows that this is not the case for the
1). The average number of nonempty cells is equal to 103,131,
ROR applied to the nonempty cells under the null hypothesis
among which 44,466 (43.1%), on average, have an odds ratio
because the distribution is nonincreasing for small P-values.
greater than 1, 17,985 (17.4%) than 2, and 4070 (3.9%) than
5. The FDRs and their estimates are calculated for different
This phenomenon indicates that there are "too many small
P-values" under the null hypothesis and will result in an rejection
inregions of the form [0, 7] and displayed as a function
of the corresponding average number of generated signals. It
crease of the number of false positive signals. In comparison,
can be seen that, whatever the tested hypothesis, the FDR
Figures le and h show that the left part of the distributions
obtained with the ROR method is always larger than with the
of the P-values under the null hypothesis are practically flat
RFET and the midRFET method, which perform identically.
when using the RFET or the midRFET, which is consistent
The low performances of the ROR method according to the
with our distribution assumptions. Figure lh shows that the
improper feature of the ROR method flattens out when,FDR
as were expected when considering the distribution of the
under the null hypothesis (cf. Figure lb). Concerning
suggested in Evans et al. (2001), the analysis is restricted P-values
to
the FDR estimation with the proposed procedure, Figure 3
cells with riij ^ 3.
that the average of the estimated FDR based on the
3.2.2 7T0 7To*. The key quantity of the FDR estimationshows
is
RFET always overestimates the FDR, which was expected
7T0 7T0*. But because of our simulation procedure, this quanand compatible with an FDR control strategy whereas the
tity is not known. Nevertheless, the quality of the estimation
estimates provided by the ROR method are systematically
can be graphically evaluated and is illustrated in Figure 2 for
under the true value of it. As for the underestimation, it has
the RFET with t/;0 = 1 an(i nij ^ 3. Figure 2 presents the
to
marginal distribution of the transformed P-values (p*) overbe directly related to the distribution of the P-values under
the null hypothesis. The midRFET method performs very well
the 500 generated datasets and the average estimates of tt0 tt0*
for ^o = l. For ipo = 2 or 5, it overestimates the FDR but
obtained with LBE, Qvalue, BUM, and SPLOSH. Let us remind that the aim of the three latter procedures is to provideless than the RFET.
Figure 4 presents in the same way results obtained when
an estimation of the minimum of the marginal distribution.
BUM clearly underestimates this value and Qvalue slightly considering only cells with n¿¿ ^ 3 that represent, on averas well. On the contrary, SPLOSH overestimates it largely. age, 47,316 cells among which 23,160 (48.9%) have an odds
ratio greater than 1, 10,154 (21.5%) than 2, and 2553 (5.4%)

than 5. Figure 4 shows that the RFET and the midRFET

co
H fji I - LBE
d ~| -i - Qvalue
1

•

•

•

•

BUM

~h • - • SPLOSH

is overestimated but less than with the RFET.

in _ ~
d

_

perform slightly better than the ROR according to the FDR.
Concerning the estimation, the FDR is overestimated when
using the RFET whereas it is actually underestimated with
the ROR for small values of it. The midRFET seems to provide a good balance between both methods because the FDR

~

tJ;

Additionally, the simulation study indicates that the FDR
estimations provided by the RFET and the midRFET tend
to be more conservative when ì/jq is increasing. This is more
clearly illustrated in Web Appendix C (Figure 3) in the case

of riij ^ 3. The reason is likely that the bias of the LBE

s m. *- d

estimator tends to increase with ip0 but our simulation data
generation does not allow to verify it clearly because the true

co

values of 7T0 tto*s are unknown.

d

For both Figures 3 and 4, the vertical lines illustrate the

results obtained with the standard decision rule based on a red

jection region [0, 0.025] for ip0 = 1. The use of the ROR on the
nonempty cells (cf. Figure 3a) with this decision rule results,
q J 1 M M 1 1 1 1 1 M 1 1 1 M 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
on average, to generate 23,574 signals associated with an FDR
d
equal to 15.7%. When using the RFET and the midRFET, re0.0 0.2 0.4 0.6 0.8 1.0
spectively, 13,905 and 16,894 signals are generated associated
with FDRs equal to 5.6% and 8.3%. In the same way, it can
be seen indensity
Figure 4 that even in the case
of very close perforFigure 2. Marginal
histogram
mances according to the
FDR, the use of the
same rejection
P-values (P*) resulting
from
the
RFET
region [0, 0.025] as decision
rule for thethe
three methods
results
500 generated datasets
with
averag
in different number of generated signals and different FDRs.
obtained with LBE, Qvalue, BUM, and SPLOSH.
I

This content downloaded from
128.103.147.149 on Thu, 30 Sep 2021 16:06:02 UTC
All use subject to https://about.jstor.org/terms

306 Biometrics, March 2010
M>o

o

d

j

'

n¡¡>

'

1

=

I

'

1

:

I

Vo

I

co

_________

=

I

2

/

¡

!

I

Vo

°_|

d

/

=

~¡

d

5

T~7
'

y

~/t
y

8 - ROR:FDR^ ¡ ; ,- ¡o / . *>_ ;/ /
o

8

-

-

midRFET:FDR

o" ■-■ midRFET : FDR ¡ , / g" /^/^ ,'^' 2" /' /
w

¡

','

,,

-

'"'

in

v'

y'

y

m

/'

'

/

° s¿' sy ö / / ■'■' " d / /'■' •' /
8_

*/!->*

o

0

-

-

r^^^

s.

/

„¿¿'

-

|__^

5000

10000

15000

20000

25000

0

2000

4000

6000

8000

0

500

1000

1500

2000

2500

Average number of generated signals Average number of generated signals Average number of generated signals
(a)

(b)

(c)

Figure

3.

signals
res
cells
with
1,
2,
and
5
v|/0

co

o

m

d"
o

ñTF3

¡

"-■

-

-

!

'

'

'

!

=

'

/

1

r~!

RFET:

RFET:

ö~

in

°

J

'|/0

I

7

/.'

FDR

¡

FDR__

■-■

/

'/

'

/

J

°

/

''

m

■'

'

=

~P'

d

|

¡

''

;

2

'|/0

^-l

H

/'d

/

/

o

/

~

/

'

'

=

°.

'

d

/

5

J

'

'

"

''

/

r7

/

/

/

/

/

¿'

>^

midRFET:

»

/

/

/

y^

'a

^

''

'

'

''

I

/

/s

s

S. ^y/Z^ q- /'/^r o_ :/ ' Jy

d ^1 u rf^^ q- d /x^x^^ *-* ,'' ' yy'
d

"1

0 5000 10000 15000 20000 25000 0 2000 4000 6000 8000 0 500 1000 1500 2000 2500

Average number of generated signals Average number of generated signals Average number of generated signals
(a)
(b)
(c)

Figure

4.

F

signals
resu
cells
with
r
1,
2,
and
5).

If
it
is
true
tograms
of the P-values resulting
from the midRFET with
null
hypoth
i¡)q = 1, 2 and 5 and n?J ^ 1. It also indicates the correspondone
testing
ing values for the ttq tto* estimates obtained with LBE. As an
trate
the
overestimate
of the minimum of the P-value density,ar
they are
the
P-values
given as an indication but have no practical significance.
a
global
erro
Figure 6 shows the FDR estimates in
function of the number of generated signals when applying the three methods to
the nonempty cells (a, b, c) and to the cells with n¿¿ ^ 3 (d,
4. Application
e, f) with LBE. The similarities observed between these reThe proposed methodology was applied to the data collected
sults and those obtained in the simulation study are in favor
by the French spontaneous reporting system between 1984
of the use of the midRFET method. Some numerical values

and 2002 (Thiessard et al., 2005). The data are coded with

are provided in Web Appendix D (Web Table 1).
the hierarchies ATC5 for the drugs and HLT for the adverse
effects. With this classification, the total number of drugs and
5. Discussion
adverse event classes are, respectively, equal to 672 and 820.
The number of nonempty cells is equal to 97,462 including
Current decision rules for the automatic signal generati
47,520 cells with n¿J ^ 3. Figure 5 presents the density hiscurrently based on arbitrary thresholds. In particular, f

This content downloaded from
128.103.147.149 on Thu, 30 Sep 2021 16:06:02 UTC
All use subject to https://about.jstor.org/terms

FDR Estimation for Frequentisi Pharmacovigilance Signal Detection Methods 307

CO

-1

CO

00

-

CVJ

-1

CO

-

00

-

CM

-1

CO

-

-

C'J

-

"l 7i0 7i0* = 0.581 n0 nQ* = 0.437 r-, k0 nQ* = 0.243 I

0.0

0.2

0.4

0.6

0.8

1.0

0.0

0.2

(a)

0.4

0.6

0.8

1.0

0.0

(b)

0.2

0.4

0.6

0.8

1.0

(c)

Figure
5.
M
the
French
v|/o

«

-I

=

1

n¡¡>1
J I
J

ROR

CM
m
d
_

midRFET

d

,'

in

d

~

„•'"

2

,''

d

^^.--

d"

-•-■'■

/

/'

.-•'"

^^^

^

.

2

d

'

~

/

/

d

b

/

rt
'

ö

in

.^X

.-■-'

/

^.--

^^..-

=

m

/

'

d

Vo

m

ö

'in

/

,'

2

Io
^-l

'

_

•-•-

=

Io
^ -I

o

m

Vo

^^^^

2

,

'

/

cm

•

/,'■'■

d

o

/

/

,•

^.x-

8

d

I-

-

05000 10000 15000 20000 25000 0 2000 4000 6000 8000 0 500 1000 1500 2000 2500

Number of generated signals Number of generated signals Number of generated signals
(a)
(b)
(c)

'|/0

w

J

m

S'

"-

d

Vo

v)

RFET

/

y

/'

/'

I

1

/

/

d~

2

rij¡>3

=

d

/V

'/

5

°.

=

-I

/

I

2

§

S"

/y

5~

-

Vo

5

A

2"
°

//

.'y

=

°

d

-

/

''

''

/

>'/

8
d

L-,

0 5000 10000 15000 20000 25000 0 2000 4000 6000 8000 0 500 1000 1500 2000 2500

Number of generated signals Number of generated signals Number of generated signals
(d)
(e)
(f)

Figure
6.
cells
and

FDR
the

signals. This illustrates the fact that it is necessary to focus on alternative decision rules that measure or control the
tion of a 95% confidence interval. This decision rule applied
of the generated signals. The approach followed in
to the ROR and the RFET results, in our simulation study,quality
in
this article was to use a mixture model for the distribution
generating different number of signals even when both methof the P-values or the mid-P-values with few hypotheses to
ods provided very close FDR for a fixed number of generated

ROR the current decision rule is defined from the construc-

This content downloaded from
128.103.147.149 on Thu, 30 Sep 2021 16:06:02 UTC
All use subject to https://about.jstor.org/terms

308 Biometrics, March 2010

provide the FDR as an evaluation
criterion
for
generate
the FDR estimators
(Gordon et al.,
2007). the
Thus, the
recent
signals.
methodological developments that aim to decrease it, by usThe analysis was conducted on the nonempty cells and
ing external covariates (for instance, Leek and Storey, 2007)
on the cells with at least three reports. This restriction can or by correcting the effect of correlation on the null distribube interesting at several levels. Firstly, it is absolutely nec- tion (Efron, 2007), constitute interesting avenues for further
works.
essary if we choose to use the ROR. Secondly, the number of tested hypotheses is practically divided by two, which
greatly reduces the computation time for the RFET and the6. Supplementary Materials
midRFET. The point is whether or not this restriction is rele-Web Appendix A referenced in Section 2.2.2, Web Figures 1-3
vant from the pharmacovigilance point of view. One can ques-referenced in Section 3, and Web Table 1 referenced in Section the relevance of signals generated with one or two reports,tion 5 are available under the Paper Information link at the
especially with regard to the large number of signals gener- Biometrics website http : //www . biometrics . tibs . org.
ated by the automatic signal-generation methods. However,
the proportion of such signals is rather low for the midRFET.
For instance, when ranking the nonempty cells according to
Acknowledgements
the mid-P- values resulting from the RFET with ip0 = 1, the
rank of the first cell with one report is equal to 5330 and
This work was supported in part by IVRSP grant A06076LS
the rank of the first cell with two reports is equal to 2471.
The number of cells with one report or two reports when
References
looking at the first 8000 signals are, respectively, equal to 98
and 356. Another aspect to take into consideration is that Agresti, A. (2002). Categorical Data Analysis. Hoboken, New Jer
Wiley Inter science.
the proposed work considered the pharmacovigilance data in
a static way; the analysis was conducted on the data collected Almenoff, J. S., Tonning, J. M., Gould, A. L., Szarfman, A., Ha
M., Ouellet-Hellstrom, R., Ball, R., Hornbuckle, K., Walsh
between 1984 and 2002. This analysis constitutes a first step
Yee, C, Sacks, S. T., Yuen, N. A., Patadia, V., Blum, M., Jo
aiming at extracting the potential unknown information of the
ston, M., Gerrits, C, Seifert, H., and LaCroix, K. K. (2005).
data already collected. Those statistical analyses are in fact
spectives on the use of data mining in pharmacovigilance. D
destined to be regularly conducted. In this context, the numSafety 28, 981-1007.
ber of generated signals will be smaller and signals with smallBate, A., Lindquist, M., Edwards, I. R., Olsson, S., Orre, R., Lan
counts could be of interest because they allow early detection
A., and De Freitas, R. M. (1998). A Bayesian neural netwo
of potential adverse effects.
method for adverse drug reaction signal generation. Europ
Journal of Clinical Pharmacology 54, 315-321.
It is well known that the analysis of pharmacovigilance
databases is subject to several types of biases that are inherentBenjamini, Y. and Hochberg, Y. (1995). Controlling the false dis
ery rate: A practical and powerful approach to multiple test
to the spontaneous character of the reports. One of the conJournal of the Royal Statistical Society, Series B 57, 289-30
sequences is that associations defined as true in the database,
Benjamini, Y., Krieger, A. M., and Yekulti, D. (2006). Adaptiv
as well as their strength, may differ from the associations deear step-up procedures that control the false discovery r
fined as true in the actual population. As a result, the FDR
Biometrika 93, 491-507.
represents a way to evaluate and compare the methods from Brown, E. G., Wood, L., and Wood, S. (1999). The medical dictio
a statistical point of view. For instance, the simulation study
for regulatory activities (MedDRA). Drug Safety 20, 109-11
indicated that when using the ROR method with the tradi- Dalmasso, C, Broët, P., and Moreau, T. (2005). A simple procedur

tional decision rule based on 7 = 0.025, the FDR was equal

estimating the false discovery rate. Bioinformatics 21, 660-6
DuMouchel, W. (1999). Bayesian data mining in large frequency t
with an application to the FDA spontaneous reporting syste
this decision rule is a source of an important proportion of
The American Statistician 53, 177-190.
false discoveries independently of the quality of the data. In
DuMouchel,
W. and Pregibon, D. (2001). Empirical Bayes screenin
the same way, the use of different testing thresholds ip0 may
multi-item associations. In KDD'01: Proceedings of the Seve

to 0.157. This result reflects the fact that this method with

not be directly related to real strength of association in the
ACM SIGKDD International Conference on Knowledge Disc
actual population but are proposed to characterize the gen-ery and Data Mining, 67-76, San Francisco, California.
erated signals. The choice of a particular threshold needs
a
Efron, B. (2007). Correlation and large-scale simultaneous signifi
more thorough investigation especially by pharmacovigilance
testing. Journal of the American Statistical Association 102,
103.
experts. It would also likely depend on the strategy followed
for the spontaneous reporting monitoring.
Evans, S. J., Waller, P. C, and Davis, S. (2001). Use of proport
reporting ratios (PRRs) for signal generation from spontane
As for the microarray data, there is a potential issue in usadverse drug reaction reports. Pharmacoepidemiology and D
ing FDR methodologies in pharmacovigilance because of the
Safety 10, 483-486.
existence of dependences, i.e., dependences between adverse
A., Glazko, G., Qiu, X., and Yakovlev, A. (2007). Cont
events or between drugs. However, it has been shown Gordon,
that
the mean number of false discoveries, Bonferroni and stability
the FDR estimation based on model (2) was robust in terms
multiple testing. Annals of Applied Statistics 1, 179-190.
of conservativeness under loose dependence including notably
Hochberg, Y. and Tamhane, A. C. (1987). Multiple Comparison P
dependence in finite blocks (Storey and Tibshirani, 2003). The
dures. New York: Wiley.
latter seems to be a reasonable assumption in the case ofLai,
pharY. (2007). A moment-based method for estimating the propo
macovigilance data. Nevertheless, simulation studies demon-of true null hypotheses and its application to microarray g
strate that dependence induces an increase in the variance of
expression data. Biostatistics 8, 744-755.

This content downloaded from
128.103.147.149 on Thu, 30 Sep 2021 16:06:02 UTC
All use subject to https://about.jstor.org/terms

FDR Estimation for Frequentisi Pharmacovigilance Signal Detection Methods 309
Leek, J. T. and Storey, J. (2007). Capturing heterogeneity in gene ex- automatic signal generation in pharmacovigilance. IEEE Transpression studies by surrogate variable analysis. PLoS Genet 3, actions on Information Technology in Biomedicine 9, 518-527.
1724-1735.
Storey, J. D. (2002). A direct approach to false discovery rates. Journal
Miller, G. C. and Britt, H. (1995). A new drug classification for comof the Royal Statistical Society, Señes B 64, 479-498.
puter systems: The ATC extension code. International Journal
ofJ. D. and Tibshirani, R. (2003). Statistical significance for
Storey,
Bio-Medical Computing 40, 121-124.
genome- wide studies. Proceedings of the National Academy of Sciences 100, 9440-9445.
Norén, G. N., Bate, A., Orre, R., and Edwards, I. R. (2006). Extending the methods used to screen the WHO drug safety database
Thiessard, F., Roux, E., Miremont-Salamé, G., Fourrier- Réglât, A.,
towards analysis of complex associations and improved accuracy
Haramburu, F., Tubert-Bitter, P., and Bégaud, B. (2005). Trends
for rare events. Statistics in Medicine 25, 3740-3757.
in spontaneous adverse drug reaction reports to the French pharPounds, S. and Cheng, C. (2004). Improving false discovery rate estimacovigilance system (1986-2001). Drug Safety 28, 731-740.
mation. Bioinformatics 20, 1737-1745.
van Puijenbroek, E. P., Bate, A., Leufkens, H. G., Lindquist, M., Orre,
Pounds, P. and Cheng, C. (2006). Robust estimation of the false disR., and Egberts, A. C. (2002). A comparison of measures of discovery rate. Bioinformatics 22, 1979-1987.
proportionality for signal detection in spontaneous reporting sysPounds, S. and Morris, S. W. (2003). Estimating the occurrence of tems
false for adverse drug reactions. Pharmacoepidemiology and Drug
Safety 11, 3-10.
positives and false negatives in microarray studies by approximating and partitioning the empirical distribution of p-values.
Waller, P., van Puijenbroek, E., Egberts, A., and Evans, S. (2004).
The reporting odds ratio versus the proportional reporting ratio:
Bioinformatics 19, 1236-1242.
Deuce.
R Development Core Team (2008). R: A Language and Environment
for Pharmacoepidemiology and Drug Safety 13, 525-526.
Statistical Computing. Vienna, Austria: R Foundation for Statistical Computing. ISBN 3-900051-07-0.
Roux, E., Thiessard, F., Fourrier, A., Bégaud, B., and Tubert-Bitter,
Received May 2008. Revised January 2009.
P. (2005). Evaluation of statistical association measures for the
Accepted January 2009.

This content downloaded from
128.103.147.149 on Thu, 30 Sep 2021 16:06:02 UTC
All use subject to https://about.jstor.org/terms

