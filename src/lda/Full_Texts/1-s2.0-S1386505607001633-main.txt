i n t e r n a t i o n a l j o u r n a l o f m e d i c a l i n f o r m a t i c s 7 7 ( 2 0 0 8 ) 421–430

journal homepage: www.intl.elsevierhealth.com/journals/ijmi

A quantitative approach of using genetic algorithm in
designing a probability scoring system of an adverse
drug reaction assessment system
Yvonne Koh a , Chun Wei Yap a , Shu Chuen Li a,b,∗
a
b

Department of Pharmacy, National University of Singapore, Republic of Singapore
Discipline of Pharmacy & Experimental Pharmacology, School of Biomedical Science, University of Newcastle, Australia

a r t i c l e

i n f o

a b s t r a c t

Article history:

Background: The detrimental effects of adverse drug reactions (ADRs) are well established.

Received 10 January 2007

Hence, precise and accurate assessment of ADRs’ causality which can differentiate signal

Received in revised form 3 June 2007

from noise is crucial in screening, management and minimisation of ADRs.

Accepted 19 August 2007

Objective: The current study reported our attempt to improve the scoring system of a previously published algorithm of ADR assessment by our group using a genetic algorithm
approach so that the ﬁnal score can measure the probability of ADR causality.

Keywords:

Design: Using ADR cases obtained from the Centre for Drug Administration, the national cen-

ADR causality

tre for pharmacovigilance in Singapore, with known causality probability values as reference

Genetic algorithm

points, rules were developed to deﬁne possible combinations of criteria for ‘Deﬁnite’ ADR

ADR assessment

cases and ‘Probable’ ADR cases. A new scoring system was developed using these param-

Probability scoring system

eters with the help of genetic algorithm, and tested on 37 ‘Deﬁnite’ and 431 ‘Not Deﬁnite’
ADR cases. In addition, sensitivity and speciﬁcity analysis were performed to allow a comparison of performance between our algorithm and that used by the Adverse Drug Reaction
Advisory Committee in Australia (ADRAC).
Results: The new scoring system is able to provide a probability of the causality of an ADR
by a suspected drug. When applied to the ‘Deﬁnite’ and ‘Not Deﬁnite’ ADR reports, the new
algorithm gave a sensitivity of 83.8% and speciﬁcity of 71.0%.
Conclusions: Using a quantitative method of assessing causality in the new algorithm allows
rare and new ADRs to be more readily identiﬁed since a quantitative score can give a
more precise degree of ADR causality. This scoring system that provides a probability score
would help to make this algorithm more informative and assistive for clinicians, regulatory
agencies or pharmaceutical companies to generate ADR alerts. The higher sensitivity value
displayed by our algorithm also shows that it would be a good ADR screening tool.
© 2007 Elsevier Ireland Ltd. All rights reserved.

1.

Introduction

The detrimental effects of adverse drug reactions (ADRs) contributing to major problems like morbidity, mortality and high

cost of patient care are well established [1–4]. In order to effectively manage and minimize ADRs, more precise and accurate
assessment of the causality of the ADRs as well as predictors for likely occurrence of ADRs are needed. In the former

∗
Corresponding author at: Discipline of Pharmacy & Experimental Pharmacology, School of Biomedical Science, University of Newcastle,
Callaghan, NSW 2308, Australia. Tel.: +61 2 49215921; fax: +61 2 49212044.
E-mail address: Shuchuen.li@newcastle.edu.au (S.C. Li).
1386-5056/$ – see front matter © 2007 Elsevier Ireland Ltd. All rights reserved.
doi:10.1016/j.ijmedinf.2007.08.010

422

i n t e r n a t i o n a l j o u r n a l o f m e d i c a l i n f o r m a t i c s 7 7 ( 2 0 0 8 ) 421–430

case, the challenge lies in determining the probability that the
suspected drug is the actual cause of the ADR.
To date, spontaneous ADR reporting is the backbone of
most pharmacovigilance centres [5,6], medical institutions
and clinical trials [7]. These reports will give rise to signals
which alert the regulatory authorities or the physicians about
the dangers posed by the suspected drugs [8]. The major problem encountered here is the differentiation between “signals”
and “noise”. Generally speaking, the process of differentiation
will pose relatively few problems for national pharmacovigilance units that collect huge amount of spontaneous ADR
reporting and hence have a large database of ADR reports to
determine the signiﬁcance of the signals. However, for countries with smaller population and hence lesser spontaneous
reports, or medical institutions and pharmaceutical companies conducting clinical trials on yet to be marketed drugs,
the process of differentiating signals from noise would be
rather challenging. Furthermore, even for large pharmacovigilance centres, studies to evaluate the impact of these signals
detected from spontaneous ADR reporting data showed that
the scoring for strengths and weaknesses of the evidence
(which is the drug causality of the ADR) is based on judgment
of the overall quality of the series of case reports received [9].
This would still lead to the problem of inter- and intra-rater
disagreement on causality since there is substantial subjective element in the judgment process. Hence, it would be
extremely useful to develop a system of assessing the spontaneous reports that is not only more objective but at the
same instance able to predict the likelihood that a signal is
a true signal. In other words, the method of assessment of
ADR causality should possess the same properties of a good
screening test.
In the current practice of assessing any suspected ADRs,
drug causality can be determined by using either clinical
judgments or algorithms [10]. Although always the ﬁrst and
unavoidable step in ADR detection and assessment, clinical
judgments often have low inter- and intra-rater agreements
because of implicit decision-making process [3,11,12]. Algorithms on the other hand, are structured operational systems
for the identiﬁcation of ADRs, which theoretically, would make
the evaluation less arbitrary, more objective and also produces
higher inter- and intra-rater agreements [11].
Several algorithms have been produced in the late 1970s
and early 1980s. For these algorithms, weights were arbitrarily assigned to the various criteria in questionnaires based
on their perceived importance, and validity of the algorithms
was checked based on the degree of agreement between the
algorithm-derived results and experts’ opinions. Although
giving arbitrary weights to criteria is a qualitative way of
determining the causality of an ADR and a good guide for
assigning causality, this qualitative nature also means that we
are unable to determine the probability (or likelihood) of the
ADR causality.
To help overcome the above problems, a robust yet easy
to use ADR algorithm that could offer a more objective way
to determine ADR causality as well as the probability of the
causal relationship is required. With a probability score, when
the algorithm is applied to a suspected ADR situation, it gives
a quantitative likelihood of the ADR being caused by the suspected drug. This will allow a quantiﬁcation of ADR signals for

small pharmacovigilance centres without large database. At
the same time, it will also be extremely useful in clinical practice, as well as in clinical trials for new drugs where there may
be unprecedented ADRs. For large national pharmacovigilance
centres, a quantitative ADR algorithm can be incorporated to
their current system to get an even more accurate impact
analysis of their ADR data from spontaneous reporting [9,13].
Nevertheless, for pragmatic reason, the new algorithm
should attain a level of balance between scientiﬁc rigor and
at the same time, simplicity for use in clinical or regulatory setting. Henceforth, the criteria used by the algorithm
in assessing the probability that an ADR is caused by the
suspected drug should be determinable based on routinely collected data. Additionally, like any other scientiﬁc measuring
instruments, high reproducibility and validity are also essential attributes for a good ADR algorithm.
From literature searches, Bayesian Adverse Reaction Diagnostic Instrument (BARDI), is an algorithm which is able to
determine the probability of ADR causality [14]. BARDI calculates the probability of ADR causality using six components:
(1) the ratio of the drug-attributable risk and non-drugattributable risk based on epidemiologic information, and
(2) ﬁve likelihood ratios (patient history, timing of ADR with
respect to drug administration, characteristics of the ADR,
drug de-challenge and re-challenge). A major advantage of
BARDI is its ability to incorporate any new information regarding the drug, patient or ADR into the probability assessment
of the ADR causality. However, this is time-consuming and
there are considerable difﬁculties in determining the six components mentioned. Hence, there is a need to develop an
algorithm that has the beneﬁts of both ease of use and ability
to give a probability of the ADR causality.
Previously, we had developed a new algorithm with 8 criteria for assigning ADR causality [15]. The preliminary results
showed that the new algorithm can perform better in detecting and assigning causality of ADRs compared with several
well established algorithms. Using the insights on the limitation of qualitative approach in assigning weightage, we have
further improved the scoring system of the algorithm using a
genetic algorithm approach so that the ﬁnal score can also
be used as a measure of the probability of ADR causality.
Genetic algorithm is used because normal methods for optimization of the scoring systems, such as systemic search, are
too time-consuming to be done practically. Genetic algorithm,
a heuristic artiﬁcial intelligence algorithm that mimics some
of the processes observed in natural evolution [16], uses concepts such as mutation and cross-over to explore new scoring
systems and to combine the best parts of two scoring systems and thus are able to rapidly eliminate unsuitable scoring
systems and concentrate the search efforts on those scoring
system which are potentially useful. Hence genetic algorithms
are useful for optimization problems that normally require
high demands on computational resources. Examples of the
type of problems where genetic algorithms have been used
are prediction of urinary tract infection [17], multi-disorder
diagnosis [18], determination of treatment doses for radiation therapy [19], and medical decision support systems [20].
To further improve inter-rater agreement and obtaining more
consistent results, we also included an appendix for the algorithm. This appendix includes explanation of the meanings

i n t e r n a t i o n a l j o u r n a l o f m e d i c a l i n f o r m a t i c s 7 7 ( 2 0 0 8 ) 421–430

of the different criteria in the algorithm and how they can be
best answered to reduce ambiguity in interpreting the meaning of the criteria. The present paper reports the development
process and the performance of the improved algorithm.

2.

Methods

2.1.

Development of the scoring system

Our initial intention was to identify several ADR cases with
known ADR causality probability values as reference points for
the development and testing of the scoring system. However,
it would be too time-consuming to establish a scoring system
that satisfy all these reference points through an exhaustive
search of all possible scoring systems and then systematically varying all the scores in the scoring systems. Thus a
genetic algorithm was used to ﬁnd a suitable scoring system.
Theoretically, the new scoring system should assign a higher
probability to ‘Deﬁnite’ ADR cases than other causality categories. With this, we identiﬁed seven rules (Table 1) which
deﬁne all possible combinations of ‘Deﬁnite’ ADR cases. These
rules were identiﬁed from a review of cases where the sus-

Table 1 – Rules that deﬁne ‘Deﬁnite’ cases
Rule
1

Table 2 – Rules that deﬁne ‘Probable’ cases
Rule

2

Present of temporal effect
ADR responds to antidote/antagonist administered
If a re-challenge is performed, result must not be
negative

3

Presence of temporal effect
Not due to any existing clinical condition
Presence of drug overdose which improve upon
de-challenge
If a re-challenge is performed, result must not be
negative

4

Presence of temporal effect
ADR has been associated with the suspected drug
before
Not due to any existing clinical condition
Improvement of ADR upon de-challenge
If a re-challenge is performed, result must not be
negative

5

Presence of temporal effect
ADR recur on re-challenge
ADR may or may not improve when antidote/antagonist
is administered (this rule cover for ADR resulting from
excipients used in the formulation of the drug)

6

Unknown temporal status
ADR respond to antidote/antagonist
ADR recur upon re-challenge

7

Unknown temporal status
Not due to any existing clinical condition
ADR improve with de-challenge
ADR recur upon re-challenge

Criteria to fulﬁl for each rule

1

Unknown temporal status
Existing clinical condition
ADR improve with de-challenge and recur with
re-challenge
No antidote/antagonist is given

2

Unknown temporal status
ADR responds to antidote/antagonist administered
If a re-challenge is performed, result is unknown

3

Unknown temporal status
Not due to any existing clinical condition
Presence of drug overdose which improve upon
de-challenge
If a re-challenge is performed, result is unknown

4

Unknown temporal status
ADR has been associated with the suspected drug
before
Not due to any existing clinical condition
Improvement of ADR upon de-challenge
If a re-challenge is performed, result is unknown

5

Unknown temporal status
ADR recur on re-challenge
ADR does not improve when antidote/antagonist is
administered

6

Present of temporal effect
Not due to any existing clinical condition
Presence of drug overdose
Effect of de-challenge is unknown
No antidote/antagonist given
No re-challenge

7

Present of temporal effect
ADR has been associated with the suspected drug
before
Not due to any existing clinical condition
Effect of de-challenge is unknown
No antidote/antagonist given
No re-challenge

Criteria to fulﬁl for each rule
Presence of temporal effect
ADR improve with de-challenge and recur with
re-challenge
No antidote/antagonist is given

423

pected drugs were considered to have deﬁnite causality effect
in the reported ADRs. These cases were picked out based on
retrospective inspection of all the ADR reports by a panel of
experts from the regulatory body, Centre for Drug Administration (CDA), Health Sciences Authority (the FDA equivalent in
Singapore), Republic of Singapore. By identifying all possible
combinations of ‘Deﬁnite’ ADR cases, it will be possible to test
the new scoring system to determine whether it satisﬁes this
condition. Although it will be useful to have a set of similar
rules to deﬁne ‘Probable’, ‘Possible’ and ‘Unlikely’ ADR cases,
it is difﬁcult to classify all the remaining ADR cases into these
three categories. Thus, only some rules which deﬁned some
combinations of ‘Probable’ ADR cases were identiﬁed (Table 2).
These rules were identiﬁed by slight modiﬁcation of the rules
for ‘Deﬁnite’ ADR cases. For example, if a rule for ‘Deﬁnite’
ADR cases contains a criterion which implicate the drug as a
causative agent (Rule 2 in Table 1), changing that criterion to
a ‘Unknown’ or ‘Not Applicable’ option will change the rule
from deﬁning ‘Deﬁnite’ ADR cases to deﬁning ‘Probable’ ADR
cases (Rule 2 in Table 2).

424

i n t e r n a t i o n a l j o u r n a l o f m e d i c a l i n f o r m a t i c s 7 7 ( 2 0 0 8 ) 421–430

In addition to identiﬁcation of rules for ‘Deﬁnite’ and ‘Probable’ ADR cases, we also identiﬁed two ADR cases with known
probability values (Table 3). The known probability values are
1, which corresponds to ADR cases where all the criteria implicate the drug as a causative agent, and 0, which corresponds
to ADR cases where all the criteria exclude the drug of any
possible causal effect.
The scores in the new scoring system were determined with the help of a genetic algorithm [16]. A genetic
algorithm comprises of four phases: initialization, evaluation, exploitation and exploration (Fig. 1). The initialization
phase involves constructing an initial population of scoring systems. Typically, the population size used in genetic
algorithms is in the range of 50–500. In our study, we used
an initial population of 300 randomly generated scoring
systems.
During the evaluation phase, each scoring system is evaluated by calculating its ﬁtness score. The ﬁtness score indicates
how well a scoring system satisﬁes all the reference points and

Table 3 – ADR cases with known probability values
Rule

Criteria to fulﬁl for each rule

Probability

1

Present of temporal effect
ADR has been associated with the
suspected drug before
Not due to any existing clinical
condition
Presence of drug overdose
ADR respond to antidote/antagonist
ADR recur upon re-challenge

1

2

No temporal effect
ADR has not been associated with
the suspected drug before
Existing clinical condition
No drug overdose
Effect of de-challenge is unknown
Result of re-challenge is negative

0

Fig. 1 – Schematic diagram of how genetic algorithm works.

i n t e r n a t i o n a l j o u r n a l o f m e d i c a l i n f o r m a t i c s 7 7 ( 2 0 0 8 ) 421–430

is calculated by using the following formula:
F=

NTpro
NTP1
NTP0
NTdef
+
+
+
NTpro + NFpro
NTdef + NFdef
NP1
NP0

where NTdef is the total number of ‘Deﬁnite’ ADR cases deﬁned
by the rules in Table 1, NFdef is the total number of ‘Not definite’ ADR cases which have higher or equivalent total score
as ‘Deﬁnite’ ADR cases. NTpro is the total number of ‘Probable’
ADR cases deﬁned by the rules in Table 2, NFpro is the total
number of these ‘Probable’ ADR cases which have a probability value below 0.5. NP1 and NP0 are the total number of cases
which should have an ADR probability of 1 and 0, respectively,
and NTP1 and NTP0 are the actual number of these cases that
have these probabilities. Thus a scoring system that satisfy all
the reference points will have a ﬁtness score of 4 and if one
is found, then further processes are stopped and the scoring
system will be validated to ensure its usefulness. Otherwise,
the genetic algorithm proceeds to the exploitation phase.
In the exploitation phase, the scoring systems are ranked
in terms of their ﬁtness score and higher ranked scoring systems are selected more frequently to replace the bottom 90%
of the current population. This method was used because the
basic assumption in genetic algorithms is that scoring systems with higher ﬁtness scores will have higher probability
of producing scoring systems with even higher ﬁtness scores,
leading eventually to scoring systems which have the desired
ﬁtness scores. The exploitation phase helps to increase the
average ﬁtness scores of the population as multiple copies of
high ranking scoring systems are more likely to be retained.
However, this will also reduce the diversity of the population.
This problem will be solved by the exploration phase.
The last phase of genetic algorithms, exploration, is used to
introduce variation into the new population. Recombination
and mutation are two events that occur during exploration. In
recombination, two different scoring systems exchange some
of their scores. This creates two new scoring systems and may
result in major improvement in ﬁtness if the right fractions
are joined together. During mutation, individual scores in the
scoring systems may change to another randomly selected
value. The role of mutation is to maintain diversity in the
population by ensuring different scores have equal chance to
be included in a scoring systems. Since recombination and
mutation are random processes, there is a slight possibility
that scoring systems with high ﬁtness scores may change to
new scoring systems with lower ﬁtness scores as a result of
the exploration phase. Thus the top 10% of the population are
not subjected to the recombination and mutation process in
order to ensure that scoring systems with high ﬁtness scores
are not removed accidentally. After the exploration phase, the
genetic algorithm returns to the evaluation phase and the
cycle repeats until the desired scoring system is found.
Once the new scoring system has been established, the
probability of ADR causality for an ADR case can be calculated
using the following formula:
P=

S − Smin
Smax − Smin

where S is the total score of the ADR case, and Smin and Smax
are the minimum and maximum possible score, respectively
(Table 4).

2.2.

425

Testing of new scoring system

In order to test the ability of this newly derived scoring system
to assign causality probability, we selected four different ADR
cases, with varying amount of information available, from
our pool of ADR reports. These four cases were selected on a
random basis from the four different pools—‘unlikely’, ‘possible’, ‘probable’ and ‘deﬁnite’. Within each pool, the cases were
picked randomly. The description of these four cases can be
seen in Table 5. The probability value derived after subjecting
each case through the new scoring system should tell us the
likelihood that the ADR is caused by the suspected drug.
Furthermore, although our aim is to produce a scoring
system which provides ADR probability rather than a qualitative causality assessment, it is still important to make sure
that the algorithm developed is able to perform at least as
well as previously published algorithms in determining the
causality of the suspected drug. However, a direct comparison is not possible since previous algorithms give categories
of causality while the present algorithm gives only a probability value. Thus we need to establish probability cut-off values
to convert probability values to causality categories to allow
the comparison. The probability cut-off values to differentiate between ‘Deﬁnite’ and ‘Probable’ ADR cases, and between
‘Probable’ and ‘Possible’ ADR cases can be obtained by analyzing the probability values of the ‘Deﬁnite’ and ‘Probable’ ADR
cases which have been identiﬁed in Tables 2 and 3. A probability cut-off value of 0.5 is used as a lower limit for ‘Possible’
ADR cases as it corresponds to a situation where it is equally
likely that the drug is involved or not involved in causing
the ADR.
Testing of the algorithm with this new scoring system was
performed on 37 ‘Deﬁnite’ ADR cases and 431 ‘Not deﬁnite’
cases. These cases were taken from a total pool of 468 ADR
reports received by the Pharmacovigilance Unit in CDA during the period of September 2002 and March 2003. This unit
is the national body in Singapore handling ADR monitoring.
These 468 reports were different from those used to develop
the algorithm and were used only for the testing stage. The
37 ADR cases were classiﬁed as ‘Deﬁnite’ cases based on retrospective inspection of all the ADR reports by experts from
CDA. These cases were classical ones which displayed positive
temporal effects, and they were known adverse effects of the
offending drugs involved. This test would enable a determination on how rigorous our algorithm is in picking out ‘Deﬁnite’
ADRs resulted from the suspected drugs. Concurrently, we also
applied seven other algorithms (namely, Naranjo et al. [11],
Kramer et al. [21], Karch and Lasagna [22], Jones [23], Bégaud
et al. [24], ADRACs guidelines [25] and WHO-UMC causality
assessment [26]) to these 468 ADR cases to help us assess
how our new algorithm compare to these existing ones in
terms of percentage accuracy in picking out the 37 ‘Deﬁnite’
cases.

2.3.

Addition of an appendix for the existing algorithm

An appendix is included in the algorithm to help increase
inter-rater agreement by clarifying the meaning of the criteria
and reduce ambiguity when applying the algorithm. To test
the effectiveness of this appendix, we asked three evaluators

426

i n t e r n a t i o n a l j o u r n a l o f m e d i c a l i n f o r m a t i c s 7 7 ( 2 0 0 8 ) 421–430

Table 4 – New scoring system for the algorithm
Criteria
1
2
3
4
5
6
7
8

Is there a reasonable time interval between administration
of the suspected drug and the adverse reaction?
Has the adverse reaction been associated with the
suspected drug before?
Could this adverse reaction be due to an existing clinical
condition?
Is there any over-dose of the suspected drug?
When the drug was discontinued, did the adverse reaction
improve within a reasonable period of time?
When the drug was NOT discontinued, did the reaction
resolved on its own?
Did the reaction improve when speciﬁc antagonist/antidote
towards the suspected drug was administered?
Did the adverse reaction recur when the suspected drug
was discontinued and re-administered?
Total score, S:
Probability, P = (S − 8)/108:
Causality categories
Deﬁnite: 0.75 ≤ P ≤ 1 (S ≥ 89)
Probable: 0.63 ≤ P < 0.75 (76 ≤ S ≤ 88)
Possible: 0.50 ≤ P < 0.63 (62 ≤ S ≤ 75)
Unlikely: 0 ≤ P < 0.50 (S ≤ 61)

Criteria and part of criterion to note
Appendix for algorithm
Criterion 1: “Reasonable time interval”

Criterion 2: “Adverse reaction been associated
with the suspected drug before”

Yes

No

Do not know

Not applicable

49

0

36

–

1

0

0

–

0

7

1

–

2
14

0
0

0
7

–
7

0

1

0

0

17

0

1

1

33

0

17

17

Explanation
Refers to time present for drug to act in body. If the reaction comes on
only after 5 half lives of the drug has passed since time of drug
withdrawal, then it is considered as no temporal effect
For drugs with known delayed reactions, this criterion should be indicated
as ‘Yes’
Based on ofﬁcial reference (BNF, Micromedex, USPDI, etc.)
If not sure whether such a reaction has been reported, please use ‘Do Not
Know’ instead of ‘No’

Criterion 3: “Could this adverse reaction be due to
an existing clinical condition?”

Existing clinical condition refers to condition which patient already has.
Do not anticipate for possible clinical conditions which patients may have
If not sure what clinical condition the patient has, please use ‘Do Not
Know’ instead of ‘No’

Criterion 4: “Any over-dose of the suspected drug”

‘Over-dose’ here is inclusive of diminished elimination of the suspected
drug as a result of drug interaction with another concomitant drug

Criterion 5: “When the drug was discontinued, did
the adverse reaction improve within a
reasonable period of time?”

When the drug is discontinued and a speciﬁc antagonist/antidote is given
concurrently, please select the option ‘Do Not Know’
If the drug brought about irreversible changes (e.g., organ failure), please
select the option ‘Do Not Know’
“Within a reasonable period of time” indicates that the option ‘No’ should
only be used after at least ﬁve half lives of the drug has passed

Criterion 7: “Speciﬁc antagonist/antidote towards
the suspected drug”

For example, Digibind for digoxin, Vitamin K for warfarin, acetylcysteine
for paracetamol
Not referring to treatment given to relieve symptoms of ADR

Criterion 5–8

Please use ‘Not Applicable’ when the mentioned actions were not taken

(all qualiﬁed pharmacists with experience in clinical settings)
to apply the algorithm to evaluate 50 randomly selected ADR
reports, ﬁrst without the appendix and then re-evaluated
the same cases 3 months later with the appendix. Inter-rater
agreement between the three evaluators was tested using
intraclass correlation coefﬁcient (ICC) using SPSS Version 12.0
[27].

To test the content validity of our algorithm, we carried
out a sensitivity and speciﬁcity analysis. A similar analysis
was performed using the guidelines adopted by ADRAC. This
adopted ADRAC guidelines is used in ADR assessment at CDA
in Singapore. These analyses would allow a comparison of
performance between our algorithm and the algorithm used
at CDA.

427

i n t e r n a t i o n a l j o u r n a l o f m e d i c a l i n f o r m a t i c s 7 7 ( 2 0 0 8 ) 421–430

Table 5 – ADR cases with varying amount of information
available

Table 6 – Sensitivity and speciﬁcity comparison of
various existing algorithms

ADR case 1
A 19-year-old female presented with scattered macular discrete
red rashes 1 day after a lignocaine gel was applied to her
buccal cavity prior to a tooth extraction. Patient had not
recovered from the rash 5 days after the initial onset. It is not
known if the patient was taking any other medications
concurrently or if she has history of drug allergy

Algorithm

Causality assessment for lignocaine
Total score, S = 0 + 1 + 7 + 0 + 7 + 0 + 1 + 17 = 33
Probability of causing ADR = (33 − 8)/108 = 0.231

New algorithm
Naranjo
Kramer
Karch
Jones
Begaud
ADRAC
WHO-UMC

Sensitivity (%)
83.78
16.22
8.11
16.22
0.00
5.41
21.62
2.70

Speciﬁcity (%)
71.00
98.84
99.30
99.07
100.00
100.00
98.38
99.07

ADR case 2
A 30-year-old female patient, with no known drug allergy,
presented with alopecia areata a few days after taking a single
dose of ﬂuconazole 150 mg for the treatment of vaginal
candidasis. Patient recovered from the condition 1 month
after the single dose ingestion
Causality assessment for ﬂuconazole
Total score, S = 36 + 1 + 7 + 0 + 7 + 0 + 1 + 17 = 69
Probability of causing ADR = (69 − 8)/108 = 0.565
ADR case 3
A 61-year-old male patient was prescribed naproxen 275 mg per
oral for treatment of toothache. Following the ﬁrst dose of
naproxen, he developed peri-orbital swelling, wheezing and
hoarseness of voice. IV hydrocortisone and nebulization were
given to treat his wheezing and patient recovered. Patient had
previous allergies with acetaminophen and phenylbutazone
Causality assessment for naproxen
Total score, S = 49 + 0 + 7 + 0 + 14 + 0 + 1 + 17 = 88
Probability of causing ADR = (88 − 8)/108 = 0.741
ADR case 4
A female patient who has been taking rofecoxib for 6 months for
the treatment of knee osteoarthritis experienced low platelet
count. Platelet count returned to normal following a
de-challenge, but decreased again when therapy was
re-introduced. Therapy with rofecoxib was subsequently
discontinued. The patient had a medical history of stroke and
has the following concurrent medical conditions: atrial
ﬁbrillation, dementia, ischemic heart disease
Causality assessment for rofecoxib
Total score, S = 49 + 1 + 7 + 0 + 14 + 0 + 1 + 33 = 105
Probability of causing ADR = (105 − 8)/108 = 0.898

3.

Results

The optimum scores for each of the possible answers for the
eight criteria derived for the algorithm are shown in Table 4.
Probability cut-off values of 0.75 and 0.63 were found to be
differentiating between ‘Deﬁnite’ and ‘Probable’ ADR cases
and between ‘Probable’ and ‘Possible’ ADR cases, respectively.
These probability cut-off values correspond to total scores of
89 and 76, respectively. The probability cut-off value for classifying ‘Possible’ and ‘Unlikely’ ADR cases was ﬁxed at 0.5 and
this correspond to a total score of 62.
The results obtained from the four different cases (Table 5)
showed that this new scoring system is able to differentiate
the ADR probabilities based on the information provided in
standard ADR reporting forms. A probability of 0.231 in Case 1

Fig. 2 – ROC curves for our new algorithm, Naranjo
algorithm and Kramer algorithm.

showed that the adverse reaction presented in the patient is
most unlikely to be due to the suspected drug. On the other
hand, a probability score of 0.898 in Case 4 showed a very high
likelihood that rofecoxib is the offending agent which resulted
in the episodes of thrombocytopenia in the patient.
When this new version of our algorithm was applied to
the 468 ADR reports from CDA, 83.8% of the 37 ADR cases
which had ‘Deﬁnite’ causality were identiﬁed as ‘Deﬁnite’ by
our algorithm, and the speciﬁcity of our new algorithm was
71.0%. The sensitivities and speciﬁcities of the other seven
algorithms are shown in Table 6. ROC curves were constructed
for our algorithm, Naranjo’s algorithm and Kramer’s algorithm, and are shown in Fig. 2. It is not possible to generate
ROC curves for the rest of the algorithms because they are
rule-based and do not produce a score.
The newly added appendix for the algorithm is shown
in Table 4. With the added appendix, the single measures and average measures intraclass correlation coefﬁcient
increased signiﬁcantly from 0.761 (CI: 0.650–0.847) to 0.969
(CI: 0.951–0.981) and from 0.905 (CI: 0.848–0.943) to 0.989 (CI:
0.983–0.994), respectively.

4.

Discussion

An important consideration in the design of a probability
scoring system for evaluating ADR causality is that the system should be simple and easy to use by clinicians, clinical

428

i n t e r n a t i o n a l j o u r n a l o f m e d i c a l i n f o r m a t i c s 7 7 ( 2 0 0 8 ) 421–430

researchers, regulatory agencies or pharmaceutical companies. There are several classical algorithms, such as logistic
regression and ordinal regression, which are able to provide
probability scores that are well calibrated. However, logistic
regression is a binary classiﬁcation algorithm and thus unsuitable to be used in this study because of the multi-categorical
reference points. Ordinal regression generally produces relatively complex scoring systems which are not easy to apply in
a clinical or regulatory setting. Hence in this study, we used
a genetic algorithm to generate quantitative instead of qualitative scores for this new version of our previously published
algorithm [15]. A genetic algorithm is used because the total
number of scoring systems that have to be explored in order
to ﬁnd one which fulﬁls all the different reference points is
too large to be practically done. Artiﬁcial intelligence methods like genetic algorithms are able to search through the vast
pool of scoring systems in a reasonable time by rapidly eliminating those scoring systems which are obviously unsuitable
and concentrating the search efforts on those scoring systems which have the potential to fulﬁl the different reference
points. When applied this new algorithm to speciﬁc ADR cases,
we are now able to know the probability of the involvement
the suspected drug. This feature would be very informative in
clinical decision making when the physicians can have more
concise estimate of the likelihood of a drug causing an ADR.
Besides its clinical applicability, this new algorithm is especially useful for regulatory agencies, as well as of great value
in drug companies when conducting clinical trials.
The contribution of our new algorithm to clinical risk management would be particularly pronounced in allowing more
rapid signal detection for new drugs and for rare ADRs. For
any drug regulatory authorities, the knowledge of the likelihood of any received ADR reports caused by a suspected drug
would allow the regulatory agency to use this information to
warn prescribers as appropriate. Whereas, the ability to detect
deﬁnite ADRs in Phase II and III clinical trials would provide
invaluable information in deciding whether to continue with
the trials as well as issuing extra caution for continuing trials. Extrapolating this to post-marketing surveillance studies
(Phase IV trials), a quantitative ADR signal to pick up rare but
deﬁnite ADRs will help to alert the drug companies as well as
the drug regulatory authorities on the need of withdrawing the
offending drugs from the market, or to put in extra cautionary
labels regarding the use of the drugs.
Other points about the new algorithm worth discussing
are its sensitivity and speciﬁcity, and its performance against
other algorithms used. From the results, the congruency
between this new version of our algorithm and that of expert
opinion is 83.8%, about 60% higher than using the current
CDA algorithm (adapted from guidelines used by ADRAC).
Also comparing with the other established ADR algorithms
(Table 6), our new algorithm version has the highest sensitivity
of 83.8% and lowest speciﬁcity of 71.0%. Therefore, using our
algorithm will result in more cases with deﬁnite ADRs being
classiﬁed correctly. However, the seven algorithms are more
superior in weeding out the non-deﬁnite ADR cases due to
their higher accuracies in assigning ‘Not deﬁnite’ to ADR cases
that are indeed not caused by the suspected drug. Hence, our
algorithm takes on a more conservative stand of suspecting
that there is deﬁnite drug causality involved. From the public

health perspective, this would be a desirable feature if an ADR
algorithm is viewed as a screening test. This would be congruent with the concept of “Sn-N-out” of using screening test in
the clinical setting.
It is to be noted that all the seven algorithms (namely,
Naranjo, Kramer, Karch, Jones, Begaud, ADRAC, WHO-UMC)
have sensitivities that are less than 25%. For Jones and Karch
algorithms, there are 153 and 121 cases, respectively, where
ADR causality cannot be classiﬁed. This is a problem due to
the inherent nature of the algorithms’ format. Jone’s algorithm
is in the form of a ﬂow chart and Karch’s is in the form of a
table. Hence, if any questions along the chart or table cannot
be answered due to lack of information, it is not possible to
apply the algorithm and ADR causality cannot be assigned.
ADRAC, WHO-UMC and Begaud have very stringent criteria for assigning a deﬁnite causality to an ADR report. Thus,
there may be ADRs which are deemed deﬁnite by expert opinion based on clinical judgement, but are nonetheless assigned
as non-deﬁnite based on the ﬁxed set of criteria of these
algorithms. Therefore, the calculated sensitivity of these algorithms appeared to be low.
For the Naranjo’s and Kramer’s algorithms, their low sensitivities could be attributed to their cut-off scores. This
possibility can be further explored by using ROC curves. The
ROC curves for our new algorithm, Naranjo’s algorithm, and
Kramer’s algorithm (Fig. 2) suggest that the three algorithms
are better than random assignment of ADR causality. This is
conﬁrmed by the asymptotic signiﬁcance of the algorithms,
which were all less than 0.05. Our new algorithm appears to
be slightly better than the Naranjo’s and Kramer’s algorithms
while the two algorithms seem to be similar. The asymptotic
95% conﬁdence intervals of our algorithm, Naranjo’s algorithm and Kramer’s algorithm are 0.710–0.868, 0.672–0.814 and
0.641–0.787, respectively. Analysis of the cut-off scores for the
three algorithms suggests that the cut-off score of 89 for our
new algorithm is appropriate, whereas for the Naranjo’s algorithm and Kramer’s algorithm, a cut-off score of 7 and 5,
respectively, appear to be more appropriate than the current
cut-off score of 9 and 6.
Besides adopting a quantitative scoring method, we also
added an appendix into our algorithm. The signiﬁcant
increase in the single measure reliability from 0.761 to 0.969
suggests that this appendix was able to clarify potential ambiguity and produced more consistent results. This is important
because the assessment of ADR causality is usually performed
by a single evaluator.
A cautionary point about our new algorithm is that
although it is able to provide a probability value for ADR
causality, the authors do not claim that the probability values
provided by the new algorithm are exactly the same as the
true causality probabilities for the ADR cases. Currently, there
are no deﬁnite methods to check the reliability of the probability values provided by the algorithm as the true ADR causality
probabilities are usually unknown. In this work, we attempted
to determine the reliability of the probability values provided
by the new algorithm by comparing the manual rankings of
some of the ‘deﬁnite’ and ‘probable’ cases in Tables 1 and 2
with the rankings provided by the new algorithm. The manual rankings were obtained by assigning higher ranks to cases
with higher probability of ADR causality. For example, for two

i n t e r n a t i o n a l j o u r n a l o f m e d i c a l i n f o r m a t i c s 7 7 ( 2 0 0 8 ) 421–430

429

references
Summary points
What was known before the study:
• Algorithms are a preferred form for assigning adverse
drug reaction (ADR) causalities.
• For existing algorithms, weights were arbitrarily
assigned to the various criteria in questionnaires
based on their perceived importance.
• Qualitative nature of existing algorithms means that it
is not possible to determine the likelihood of the ADR
causality.
What the study has added to the body of knowledge:
• The development of a quantitative scoring system in
this study enables the probability of ADR causality of
the suspected drug to be measured.
• The estimation of the probability of ADR causality
would contribute signiﬁcantly in risk management in
clinical practice and regulatory affairs.
• The new algorithm will be a useful instrument for
physicians to verify the possibility of suspected drugs
causing ADRs in their daily practice and can also be
sued as a screening tool to pick up suspected ADR and
hence encourage prompt management of the conditions presented by patients, especially for new drugs
or during clinical trials.

similar ADR cases that belong to rule 1 in Table 1 but differ
only in the presence of existing clinical condition, the ADR
case without existing clinical condition will be ranked higher
than the other with existing clinical condition. Results from
the comparison suggest that the probability values provided
by the new algorithm are, at a minimum, reliable to be used
as a ranking system.
In conclusion, the provision of a quantitative scoring system and the addition of an appendix have helped make our
previously published algorithm more sensitive, and reduced
the variability when used by different users. The ability to
estimate a more precise likelihood of ADR causality will give
this algorithm an extra advantage when used by clinicians,
regulatory agencies or drug companies to generate alerting
ADR signals, especially for rare ADRs and new ADRs that
have not been documented. Therefore, by using a quantitative approach, we have produced a simple and easy to use
ADR algorithm which would contribute to clinical risk management.

Acknowledgments
The authors would like to thank Ms Cheng Leng Chan, Miss
Pei San Ang and Miss Bee Him Tan from the Pharmacovigilance Unit in the Centre for Drug Administration (CDA), Health
Sciences Authority, Republic of Singapore, for their valuable
comments, expertise and their help in providing the data
required for this study.

[1] D.W. Bates, D.J. Cullen, N. Laird, L.A. Petersen, S.D. Small, D.
Servi, G. Laffel, B.J. Sweitzer, Incidence of adverse drug
events and potential adverse drug events, JAMA 274 (1995)
29–34.
[2] L.L. Leape, D.W. Bates, D.J. Cullen, J. Cooper, H.J. Demoncao,
T. Gallivan, R. Halliswy, J. Ives, Systems analysis of adverse
drug events, JAMA 274 (1995) 35–43.
[3] F.E. Karch, L. Lasagna, Adverse drug reactions—a critical
review, JAMA 234 (1975) 1236–1241.
[4] T. Hannan, Detecting adverse drug reactions to improve
patient outcomes, Int. J. Med. Inf. 55 (1999) 61–64.
[5] M.D.B. Stephens, The Detection of New Adverse Drug
Reactions, 2nd ed., The MacMillan Press, Basingstoke, 1988.
[6] M. Backstrom, T. Mjorndal, R. Dahlqvist, Under-reporting of
serious adverse drug reactions in Sweden,
Pharmacoepidemiol. Drug Saf. 13 (2004) 483–487.
[7] S.R. Ahmad, Adverse drug event monitoring at the Food and
Drug Administration, J. Gen. Intern. Med. 18 (2003) 57–60.
[8] C. Bousquet, C. Henegar, A.L. Louet, P. Degoulet, M.C. Jaulent,
Implementation of automated signal generation in
pharmacovigilance using a knowledge-based approach, Int.
J. Med. Inf. 74 (2005) 563–571.
[9] P. Waller, E. Heeley, J. Moseley, Impact analysis of signals
detected from spontaneous adverse drug reaction reporting
data, Drug Saf. 28 (2005) 843–850.
[10] C.A. Naranjo, N.H. Shear, K.L. Lanctôt, Advances in the
diagnosis of adverse drug reactions, J. Clin. Pharmacol. 32
(1992) 897–904.
[11] C.A. Naranjo, U. Busto, E.M. Sellers, P. Sandor, I. Ruiz, E.A.
Roberts, E. Janecek, C. Domecq, D.J. Greenblatt, A method for
estimating the probabilty of adverse drug reactions, Clin.
Pharmacol. Ther. 30 (1981) 239–245.
[12] J. Koch-Weser, E.M. Sellers, R. Zacest, The ambiguity of
adverse drug reactions—a matter of opinion, Clin.
Pharmacol. Ther. 19 (1976) 489–492.
[13] F. Thiessard, E. Roux, G. Miremont-Salame, A.
Fourrier-Reglat, F. Haramburu, P. Tubert-Bitter, B. Bégaud,
Trends in spontaneous adverse drug reaction reports to the
French pharmacovigilance system (1986–2001), Drug Saf. 28
(2005) 731–740.
[14] D.A. Lane, M.S. Kramer, T.A. Hutchinson, J.K. Jones, C.A.
Naranjo, The causality assessment of adverse drug reactions
using a Bayesian approach, Pharm. Med. 2 (1987) 265–283.
[15] Y. Koh, S.C Li, A new algorithm to identify the causality of
adverse drug reactions, Drug Saf. 28 (2005) 1159–1161.
[16] C.B. Lucasius, G. Kateman, Understanding and using genetic
algorithms. Part 1. Concepts, properties and context,
Chemom. Intell. Lab. Syst. 19 (1993) 1–33.
[17] P. Heckerling, G. Canaris, S. Flach, T. Tape, R. Wigton, B.
Gerber, Predictors of urinary tract infection based on
artiﬁcial neural networks and genetic algorithms, Int. J. Med.
Inf. 76 (2007) 289–296.
[18] S. Vinterbo, L. Ohno-Machado, A genetic algorithm approach
to multi-disorder diagnosis, Artif. Intell. Med. 18 (2000)
117–132.
[19] C. Cotrutz, L. Xing., Segment-based dose optimization using
a genetic algorithm, Phys. Med. Biol. 48 (2003) 2987–2998.
[20] V. Podgorelec, J. Brest, P. Kokol, Power of heterogeneous
computing as a vehicle for implementing E(3) medical
decision support systems, Int. J. Med. Inf. 58/59 (2000)
179–190.
[21] M.S. Kramer, J.M. Leventhal, T.A. Hutchinson, A.R. Feinstein,
An algorithm for the operational assessment of adverse
drug reactions. I. Background, description adn instructins
for use, JAMA 242 (1979) 623–632.

430

i n t e r n a t i o n a l j o u r n a l o f m e d i c a l i n f o r m a t i c s 7 7 ( 2 0 0 8 ) 421–430

[22] F.E. Karch, L. Lasagna, Toward the operational identiﬁcation
of adverse drug reactions, Clin. Pharmacol. Ther. 21 (1977)
247–254.
[23] J.K. Jones, Adverse drug reaction in the community health
setting: approaches to recognizing, counseling and
reporting, Fam. Community Health 5 (1982) 58–67.
[24] B. Begaud, J.C. Evreux, J. Jouglard, G. Lagier, Imputation of
the unexpected or toxic effects of drugs. Actualization of the

method used in France, Therapie 40 (1985)
115–118.
[25] M.L. Mashford, The Australian method of drug event
assessment, Drug Inf. J. 18 (1984) 271–273.
[26] WHO-UMC Causality Assessment System [last visited July
16, 2004]; available from:
http://www.who-umc.org/pdfs/Causality.pdf.
[27] SPSS for Windows, Rel. 12.0.0, SPSS Inc., Chicago, 2003.

