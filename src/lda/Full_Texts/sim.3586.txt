STATISTICS IN MEDICINE
Statist. Med. 2009; 28:1774–1792
Published online 9 April 2009 in Wiley InterScience
(www.interscience.wiley.com) DOI: 10.1002/sim.3586

Bayesian pharmacovigilance signal detection methods revisited
in a multiple comparison setting
Ismaı̈l Ahmed1,2, ∗, † , Françoise Haramburu3,4 , Annie Fourrier-Réglat3,4,5 ,
Frantz Thiessard4,5,6 , Carmen Kreft-Jais7 , Ghada Miremont-Salamé3,4,5 ,
Bernard Bégaud3,4,5 and Pascale Tubert-Bitter1,2
1 Inserm,

U780, 16 Avenue Paul Vaillant Couturier, Villejuif F-94807, France
Paris-Sud, IFR69, F-94276 Le Kremlin-Bicêtre, France
3 Inserm, U657, Bordeaux F-33076, France
4 Pellegrin Hospital, Bordeaux F-33076, France
5 Univ Victor Segalen Bordeaux 2, Bordeaux F-33076, France
6 Inserm, U593, Bordeaux F-33076, France
7 Afssaps, Saint Denis F-93200, France

2 Univ

SUMMARY
Pharmacovigilance spontaneous reporting systems are primarily devoted to early detection of the adverse
reactions of marketed drugs. They maintain large spontaneous reporting databases (SRD) for which several
automatic signalling methods have been developed. A common limitation of these methods lies in the
fact that they do not provide an auto-evaluation of the generated signals so that thresholds of alerts are
arbitrarily chosen. In this paper, we propose to revisit the Gamma Poisson Shrinkage (GPS) model and
the Bayesian Confidence Propagation Neural Network (BCPNN) model in the Bayesian general decision
framework. This results in a new signal ranking procedure based on the posterior probability of null
hypothesis of interest and makes it possible to derive with a non-mixture modelling approach Bayesian
estimators of the false discovery rate (FDR), false negative rate, sensitivity and specificity. An original data
generation process that can be suited to the features of the SRD under scrutiny is proposed and applied
to the French SRD to perform a large simulation study. Results indicate better performances according
to the FDR for the proposed ranking procedure in comparison with the current ones for the GPS model.
They also reveal identical performances according to the four operating characteristics for the proposed
ranking procedure with the BCPNN and GPS models but better estimates when using the GPS model.
Finally, the proposed procedure is applied to the French data. Copyright q 2009 John Wiley & Sons, Ltd.
KEY WORDS:

Bayesian decision; data mining; false discovery rate; multiple comparisons; pharmacovigilance

∗ Correspondence
†

to: Ismaı̈l Ahmed, Inserm, U780, 16 Avenue Paul Vaillant Couturier, Villejuif F-94807, France.
E-mail: ismail.ahmed@inserm.fr

Contract/grant sponsor: IVRSP; contract/grant number: A06076LS

Copyright q

2009 John Wiley & Sons, Ltd.

Received 19 May 2008
Accepted 18 February 2009

BAYESIAN PHARMACOVIGILANCE METHODS AND MULTIPLE COMPARISONS

1775

1. INTRODUCTION
One of the objectives of pharmacovigilance systems is to detect the potential existence of adverse
drug reactions (ADRs) as soon as possible after drug marketing. Persistence of such unknown
adverse effects, even after drug marketing approval, is easily explained by the fact that premarketing clinical trials fail to detect rare ADRs specific to population subgroups or of large latency.
Pharmacovigilance systems are commonly based on spontaneous reporting of suspicious drugrelated adverse events by healthcare providers to drug monitoring centres. Their main limitations
lie firstly in their spontaneous character, which introduces several sources of bias, the most obvious
being under-reporting [1, 2]. Second, no causal relationship can directly be deduced from adverse
event–drug associations pointed out by such systems without further evaluation. However, despite
such limitations, the pharmacovigilance reporting system databases are the only resource that
makes data quickly available. Furthermore, the analysis of spontaneous reports underpins most
discoveries of new adverse effects [3–5].
The World Health Organization (WHO) safety database contains more than 3.6 million reports
and, as of December 2004, the Adverse Event Reporting System (AERS) of the US Food and
Drugs Administration about 2.6 million [6]. Concerning the French pharmacovigilance database,
from 1986 to 2001 about 200 000 reports were recorded [7]. In order to assist pharmacovigilance
experts through these large databases, several statistical methods have been proposed in order to
automatically extract a manageable number of signals for further evaluation. The aim of such
methods is not to replace the expertise of the pharmacovigilance experts but rather to draw attention
to unexpected associations.
The most commonly used methods are the proportional reporting ratio (PRR) [8], the reporting
odds ratio (ROR) [9], the Bayesian Confidence Propagation Neural Network (BCPNN) [10, 11]
and the (Multi) Gamma Poisson Shrinker ((M)GPS) [12, 13]. Currently, none of these methods is
defined as a reference method. The BCPNN method is used for the WHO safety database [14],
the MGPS method for the AERS and the ROR and PRR methods for the European Medicines
Agency EudraVigilance database [6]. The French pharmacovigilance system has not yet adopted
any automatic method and the following developments mentioned herein are motivated by need
to select an appropriate method for the analysis of the French pharmacovigilance database.
Few articles have been published comparing the different methods available. van Puijenbroek
et al. [9] compared several methods using the Netherlands Pharmacovigilance Foundation Lareb
data set in terms of sensitivity, specificity and positive and negative predictive values taking the
BCPNN method as reference. Rolka et al. [15] evaluated the GPS method through a simulation
study. Roux et al. [16] presented an extensive simulation study based on an elaborate data generation
process for comparing all the existing methods and some of their extensions. The main conclusion
of this study was that the two Bayesian methods (BCPNN and GPS) give better results than the
frequentist methods. These conclusions were further confirmed by Almenoff et al. [17] in a Rolka
simulation procedure-based study comparing PRR and GPS methods.
All the proposed methods are based on arbitrary thresholds for signal generation where decision
rules are not defined by any error-limiting constraint. Therefore, although the identification of a
list of signals from a pharmacovigilance database is a data mining problem, there is a potential
improvement to be expected from constraining the list of signals issued in a more grounded manner.
Recently, some new methodological views have arisen from the very active microarray field.
Indeed, similarities exist between both application fields. Microarray data sets consist in several
thousands of genomic expressions for different experimental conditions with the objective of
Copyright q

2009 John Wiley & Sons, Ltd.

Statist. Med. 2009; 28:1774–1792
DOI: 10.1002/sim

1776

I. AHMED ET AL.

identifying genes that could be differentially expressed across the groups. Recent methods to address
massive null hypothesis testing are based on controlling various aspects of the false discovery rate
(FDR) as introduced by Benjamini and Hochberg [18]. Typically, they involve a mixture model
describing the distribution of the testing statistic with one of the components corresponding to the
null hypothesis [19–23]. The GPS signalling method [12] is based on a Poisson-gamma mixture
model and has been used as a starting point for applying these multiple comparison methods in
such mixture modelling contexts [24, 25].
The first objective of this study was to extend the Bayesian pharmacovigilance signal detection methods into a Bayesian general decision perspective and use the posterior probabilities of
null hypotheses to order drug–event pairs. This results in a new general detection procedure.
In principle, it could be applied to handling any Bayesian pharmacovigilance signalling method
as long as the whole posterior distribution of the considered disproportionality measure is available. This is true for the GPS model but not for the latest version of the BCPNN model [11].
However, for this model the posterior distribution can be easily approximated by Monte Carlo
simulations.
The second objective was to consider a Bayesian comparison setting to tackle the issue of
constraining the selection of signals. Here again, the posterior probability of the null hypothesis
is a key quantity used to estimate Bayesian versions of the FDR and false negative rate (FNR).
Directly derived from the work of Müller et al. [26], this general approach is not based on any
mixture modelling inferences and can be processed for any decision rule. Bayesian estimators of
sensitivity and specificity as proposed by McLachlan et al. [23] were also considered.
Section 2 describes the BCPNN and GPS models. Section 3 discusses them in the multiple
comparisons setting and introduces Bayesian estimators of the FDR and FNR. Section 4 presents
a large simulation study with a data generation process that can be suited to the features of
the spontaneous reporting database under scrutiny—in our case, the French pharmacovigilance
database. These simulations were conducted in order to compare (i) the proposed ranking procedure
with the existing ones for the GPS model and (ii) the GPS and BCPNN models when using the
proposed ranking procedure. Evaluation was done in terms of performances according to the FDR,
FNR, sensitivity and specificity and behaviour of their Bayesian estimators. The details of the
French pharmacovigilance database application are given in Section 5 and a discussion is provided
in Section 6.

2. BAYESIAN PHARMACOVIGILANCE SIGNALLING METHODS
2.1. Some notations
A pharmacovigilance database can be represented as a large and sparse I × J contingency table
crossing all drugs and adverse events mentioned at least once in a spontaneous report. When a
spontaneous report involves several drugs and/or several adverse events, which is commonly the
case, each combination of drug–adverse event is reported in the database. We let n i. , n . j and
n i j denote, respectively, the marginal count involving drug Di , the marginal count involving the
adverse event AE j and the number of reports involving both of them. n R is defined as the sum of
the n i j ’s, which is not equal to the total number of spontaneous reports. Finally, n cell denotes the
number of cells in the contingency table.
Copyright q

2009 John Wiley & Sons, Ltd.

Statist. Med. 2009; 28:1774–1792
DOI: 10.1002/sim

BAYESIAN PHARMACOVIGILANCE METHODS AND MULTIPLE COMPARISONS

1777

2.2. The BCPNN method of Bate et al. and Norén et al.
2.2.1. The model. The Bayesian approach proposed by Bate et al. [10] is based on three binomial
models with beta prior distributions:
n i j| pi11j ∼ Bi(n R , pi11j )

with pi11j ∼ Be(i11j , i11j )

n i.| pi1.j ∼ Bi(n R , pi1.j )

with pi1.j ∼ Be(i1.j , i1.j )

n . j| pi.1j ∼ Bi(n R , pi.1j )

with pi.1j ∼ Be(i.1j , i.1j )

where pi1.j , pi.1j and pi11j denote, respectively, the probability when considering the cell (i, j) to be
exposed to Di , to observe AE j and to encounter both of them.
Posterior distributions of pi1.j , pi.1j and pi11j are also beta:
11
11
11
pi11∗
j ≡ pi j |n i j ∼ Be(i j +n i j , i j +n R −n i j )
1.
1.
1.
pi1.∗
j ≡ pi j|n i. ∼ Be(i j +n i. , i j +n R −n i. )
.1
.1
.1
pi.1∗
j ≡ pi j|n . j ∼ Be(i j +n . j , i j +n R −n . j )

In the sequel, the symbol ∗ is used as a convenient notation to designate random variables
conditioned on the data.
Initially, i1.j , i1.j , i.1j , i.1j were set to 1 defining two uniform distributions on [0, 1] for the marginal
probabilities pi1.j and pi.1j . Concerning the hyperparameters of pi11j , i11j = 1 but information from the

.1∗
data was introduced through i11j defined as 1/(E( pi1.∗
j )E( pi j ))−1. With these hyperparameters,
.1∗
the prior expectation of pi11j was equal to the product of the expectation of pi1.∗
j and pi j [10].
More recently, Norén et al. [11] proposed an extension of the model of Bate et al. [10], which
takes into account the dependence between pi11j , pi1.j and pi.1j . This results in alternative values for
the hyperparameters:

i11j = ai11j ,

i11j = ai10j +ai01j +ai00j

i1.j = ai11j +ai10j ,

i1.j = ai01j +ai00j

i.1j = ai11j +ai01j ,

i.1j = ai10j +ai00j

with
ai11j = 0.5
ai10j = 0.5

(n R −n . j )+0.5
n . j +0.5

ai01j = 0.5

(n R −n i. )+0.5
n i. +0.5

ai00j = 2ai10j ai01j
Copyright q

2009 John Wiley & Sons, Ltd.

Statist. Med. 2009; 28:1774–1792
DOI: 10.1002/sim

1778

I. AHMED ET AL.

2.2.2. Criterion for signal generation. Bate et al. [10] defined the information component for the
cell (i, j) as follows:


11∗
p
i
j
ICi∗j = log2
(1)
.1∗
pi1.∗
j pi j
A signal is generated if the 2.5 per cent quantile Q 0.025 of ICi∗j is greater than 0. As the distribution
of ICi∗j is intractable, Bate et al. [10] used a normal distribution N(E(ICi∗j ), var(ICi∗j )), the two
moments being approximated with the delta method. Later Gould [27] gave the exact form for
the two moments. Nevertheless, the normal approximation is crude, especially for cells with small
counts. Conscious of this limitation, Norén et al. [11] proposed a model for estimating more
accurately the 2.5 per cent quantile of the distribution of ICi∗j based on empirical testing from the
WHO database and extensive Monte Carlo simulations.
2.3. The GPS method of DuMouchel
2.3.1. The model. In DuMouchel’s approach, n i j|i j ∼ Pn(i j E i j ) where Pn(·) designates the
Poisson distribution and E i j is defined as the expected number of reports in the cell (i, j) assuming
independence between rows (drugs) and columns (adverse events), i.e.
Ei j =

n i. n . j
nR

Prior distribution for all the i j ’s is a mixture of two gamma distributions:
i j ∼ ŵ Ga(ˆ1 , ˆ1 )+(1− ŵ) Ga(ˆ2 , ˆ2 )
where ĥ = (ˆ1 , ˆ1 , ˆ2 , ˆ2 , ŵ) is derived with an empirical Bayes approach, that is, by maximizing
the product of the marginal likelihoods of the n i j|E i j ’s. The posterior distribution of i j can be
represented as
i j|n i j , E i j ∼ wi j Ga(ˆ1 +n i j , ˆ1 + E i j )+(1−wi j ) Ga(ˆ2 +n i j , ˆ2 + E i j )
where wi j is the posterior probability that i j came from the first component of the mixture.
2.3.2. Criterion for signal generation. The initial strategy of DuMouchel [12] was to rank the
cells according to the posterior expectation of log2 (i j ), which was shown to be
E(log2 (i j )∗ ) = ln(2)−1 [wi j {(ˆ1 +n i j )−ln(ˆ1 + E i j )}+(1−wi j ){(ˆ2 +n i j )−ln(ˆ2 + E i j )}]
where (x) denotes the digamma function. Later, DuMouchel and Pregibon [13] proposed to rank
the cells according to the 5 per cent quantile Q 0.05 of the distribution of i∗j and a threshold of 2
for this quantile was recommended by Szarfman et al. on the basis of several retrospective studies
[28]. The decision rule of Szarfman et al. was recently used by Almenoff et al. in a simulation
study comparing the GPS and PRR methods [17].
Copyright q

2009 John Wiley & Sons, Ltd.

Statist. Med. 2009; 28:1774–1792
DOI: 10.1002/sim

BAYESIAN PHARMACOVIGILANCE METHODS AND MULTIPLE COMPARISONS

1779

3. EXTENSION OF THE METHODS TO THE MULTIPLE COMPARISON SETTING
Since the seminal paper of Benjamini and Hochberg [18] presenting a procedure for controlling
the FDR defined as the expectation of the proportion of false discoveries among the generated
signals, alternative procedures and criteria have been proposed to address the massive quantity of
comparisons. In particular, Müller et al. [26] address the problem of multiple comparisons from
a Bayesian general decision perspective. Basically, two sets of quantities are of interest, z i j and
di j . The first quantity, z i j ∈ {0, 1}, represents the true status of the tested null hypothesis (z i j = 0
when the null hypothesis is true). In the pharmacovigilance framework, z i j denotes the unknown
indicator of the true association status in the database between drug Di and adverse event AE j . The
second quantity, di j ∈ {0, 1}, represents the decision to generate (di j = 1) a signal or not (di j = 0).
From these two sets of quantities, the false discovery proportion (FDP) and the false negative
proportion (FNP) can be expressed as


i j (1− z i j )di j
i j (1−di j )z i j


FDP =
and FNP =
n cell − i j di j
i j di j
that is, the proportion of erroneous decisions relative to the number of positives (FDP) and negatives
(FNP).
As underlined by Müller et al. [29], FDR = E(FDP) and FNR = E(FNP) are quantities that are
quite difficult to obtain since they involve ratios of random variables. In comparison, the Bayesian
alternatives that they proposed are simpler to derive and consist in calculating the expectation of
FDP and FNP given the data, respectively, denoted by FDR∗ and FNR∗ . Define vi j = Pr(z i∗j = 1),
that is, the posterior probability for the alternative hypothesis to be true. The calculation of FDR∗
and FNR∗ is straightforward:


i j (1−vi j )di j
i j (1−di j )vi j
∗
∗


and FNR =
(2)
FDR =
n cell − i j di j
i j di j
In addition, McLachlan et al. [23] proposed Bayesian estimators of the sensitivity and specificity:


i j vi j di j
i j (1−di j )(1−vi j )
∗
∗

and Sp =
Se = 
n cell − i j vi j
i j vi j
Determination of vi j depends obviously on the tested null hypothesis. If we are interested in
generating signals for true associations in the database, vi j is, for the GPS model, the probability
that i∗j >1 and, for the BCPNN model, the probability that ICi∗j >0. More generally, we could
be interested in drug–adverse event associations with relative risks in the database greater than a
threshold RR0 resulting in the null hypothesis status z i j (RR0 ). In this case, for the GPS model,
vi j (RR0 ) = Pr(i∗j >RR0 )
= 1−{wi j (RR0 ; ˆ1 +n i j , ˆ1 + E i j )+(1−wi j )(RR0 ; ˆ2 +n i j , ˆ2 + E i j )}

(3)

where (·; s, t) denotes the cumulative distribution function of a gamma distribution with parameters s and t. Concerning the BCPNN model, the distribution of ICi∗j (1) is not explicitly known.
Instead of using the normal approximation proposed by Bate et al. [10], we approximated it for
each cell (i, j) by Monte Carlo simulations.
Copyright q

2009 John Wiley & Sons, Ltd.

Statist. Med. 2009; 28:1774–1792
DOI: 10.1002/sim

1780

I. AHMED ET AL.

The second aspect concerns the decision di j . The Bayesian decision framework makes it possible
to estimate the operating characteristics for any decision rule based on the data [29]. Thus, FDR∗ and
FNR∗ can be derived for the traditional decision rule for the BCPNN and GPS models described in
Sections 2.2.2 and 2.3.2. The decision rule adopted in this paper is based on vi j and has been shown
to be optimal according to several loss functions combining FDR∗ and FNR∗ or related quantities
[26]. Therefore, for cell (i, j), a signal is generated if vi j is greater than a threshold 1−, that is,
di j = 1[vi j >1−] where 1[·] denotes the indicator function. In practice,  is chosen according to the
desired values for the operating characteristics. Note that for the BCPNN model, the current decision
rule based on the 2.5 per cent quantile corresponds in the described Bayesian decision framework to the
hypothesis and the decision based on RR0 = 1 and  = 0.025. Furthermore, the decision rule proposed
by Szarfman et al. [28] corresponds in this framework to focusing on an association with a relative
risk greater than 2 and a threshold  = 0.05. Indeed, it is easy to verify that 1[vi j ()>1−] = 1[Q  >] .
In the papers by DuMouchel [12] and DuMouchel and Pregibon [13], it was recommended to rank
the cells according to log2 (i∗j ) and Q 0.05 (i∗j ), respectively. The proposed signal generation procedure differs in that the cells are ranked according to the posterior probability of the null hypothesis.

4. SIMULATIONS
4.1. Data generation
Few simulation studies have been conducted in the pharmacovigilance field. Two recent papers
proposed simulation of data generation processes with rather different philosophies [15, 16]. In
Roux et al. [16], a complete mechanism for ADR reporting is proposed. The limitation of this
approach is that it is difficult to judge whether or not the generated data are realistic. Our method
shares some of the features in Rolka et al. [15] in the sense that the French pharmacovigilance
database, which is described in Section 5, is used in the data generation process.
Basically, for simulation s the numbers of ADRs were generated according to a multinomial
distribution:
(n s11 , n s12 , . . . , n sI J ) ∼ Mu(n R , ps )

(4)

s , p s , . . . , p s ) is a vector of length equal to the number of cells considered in the
where ps =( p11
IJ
12
French database, n cell . For each cell (i, j) and simulation s, two working vectors were generated
according to a Dirichlet distribution using the vectors of the marginal counts of the French
database as parameters:
s
s
s
( pw1.
, pw2.
, . . . , pw
I. ) ∼ Di(n 1. , n 2. , . . . , n I. )
s
s
s
( pw.1
, pw.2
, . . . , pw.J
) ∼ Di(n .1 , n .2 , . . . , n .J )

Additionally, working relative risks, denoted by RRswi j , were generated from the exponential of
a logistic distribution with parameters 0 and 0.5 and were used to calculate ps , the vector of the
parameters of the multinomial distribution (4):
s
RRswi j ewi
j
pisj = 
s es
RR
ij
wi j wi j
s = ps ps .
with ewi
j
wi. w. j

Copyright q

2009 John Wiley & Sons, Ltd.

Statist. Med. 2009; 28:1774–1792
DOI: 10.1002/sim

BAYESIAN PHARMACOVIGILANCE METHODS AND MULTIPLE COMPARISONS

1781

0.4

0.3

0.2

0.1

0.0
–5

0

5

10

Figure 1. Comparison of the histograms of the logarithm of the reported ratios in the French database
(white bars) with the empirical distribution of 50 generated data sets (grey).

The marginal probabilities of 
being exposed to 
drug Di or of observing an adverse event AE j
are therefore, respectively, pi.s = j pisj and p.sj = i pisj . The true probability of encountering an
ADR for cell (i, j), under the independence between rows and columns, is eisj = pi.s p.sj . The true
relative risk and the true status are
RRis j =

pisj
eisj

and

z isj (RR0 ) = 1[RRisj >RR0 ]

The choice of the exponential of a logistic distribution along with this parametrization was suggested
by a graphical comparison between the logarithm of the reported ratios in the French database,
that is, ln(n i j )−ln(E i j ), and the generated ones. The other criterion taken into account was the
number of empty cells. Figure 1 presents the comparison of the distributions of the logarithm of
the reported ratios for the non-empty cells in the French pharmacovigilance database and for 50
generated data sets.
Generated data sets containing empty row(s) or column(s) were systematically removed. In order
to reduce the generation of such data sets, we chose to remove from the French database drugs
and adverse events for which marginal counts were less than 5. Thus, 500 data sets were generated
with 634 drugs, 756 adverse events and with n R = 1 196 487. The average number of non-empty
cells over the 500 data sets was equal to 103 131 versus 97 256 for the French database.
FDR and FNR were estimated by Monte Carlo simulations, that is, by the mean of the 500 data
sets of FDPs and FNPs :
500

= 1
FDPs ,
FDR
500 s=1

500

= 1
FNR
FNPs
500 s=1

Additionally, in practice, the features of the database and the large number of signals generated
by the automatic methods mean that signals associated with n i j less than 3 are rarely considered to
be of interest. Thus, the analysis was conducted on the whole databases (in particular to estimate the
hyperparameters of the GPS model) but the operating characteristics were derived from data sets
restricted to cells with at least three reports, which represented on average 47 316 cells (n cell (2)).
Within these restricted data sets, several definitions of associations of interest based on RR0 = 1, 2, 3
Copyright q

2009 John Wiley & Sons, Ltd.

Statist. Med. 2009; 28:1774–1792
DOI: 10.1002/sim

1782

I. AHMED ET AL.

or 4 were considered. The number of cells with a relative risk greater than 1, 2, 3 and 4 was,
respectively, equal to 23 160, 10 028, 5510 and 3501 on average.
Concerning the BCPNN model, the posterior distribution of the ICi j was estimated for each cell
by 10 000 Monte Carlo simulations. The hyperparameters chosen were those proposed in Norén
et al. [11].

4.2. Results of the simulation study
The simulation study was conducted with two objectives. The first objective was to compare the
 and FNR.
 The second
performances of the methods according to their sensitivity, specificity, FDR
objective was to assess the quality of the estimations of the operating characteristics by their
Bayesian estimators.
In the first part of the simulation, we focused on the GPS model and compared the proposed
ranking procedure based on (3) and denoted by Pr(H0∗ ) with that proposed by DuMouchel [12]
(denoted by E(∗ )) and that proposed by DuMouchel and Pregibon [13] (denoted by Q 0.05 (∗ )). In
the second part we compared the GPS and BCPNN models with the proposed ranking procedure. For
each procedure and simulation data set, the operating characteristics and their Bayesian estimates
were calculated for several thresholds  and averaged over the 500 data sets.
Figure 2 shows a comparison of the three ranking procedures of the GPS model according to the
 and its Bayesian estimate are calculated for several values of  and are represented as
FDR. FDR
a function of the corresponding average number of signals. In figures (a), (c), (e) and (g), Pr(H0∗ )
is compared with E(∗ ) and in figures (b), (d), (f) and (h), Pr(H0∗ ) is compared width Q 0.05 (∗ ).
Results are presented for associations of interest defined from RR0 = 1, 2, 3 and 4. For an identical
 provided by Pr(H ∗ ) is always lower than or equal to E(∗ ) and
number of generated signals, FDR
0
∗
 (less than 0.02), figures (b), (d) and (f) indicate
Q 0.05 ( ). Nevertheless, for low values of FDR
close performances for Pr(H0∗ ) and Q 0.05 (∗ ). Concerning the estimation represented by the grey
 for RR0 = 1 and 3. For RR0 = 2,
curves in Figure 2, FDR∗ accurately estimates (on average) FDR
 For RR0 = 4, FDR∗ underestimates FDR.

FDR∗ overestimates FDR.
Figures 3–6 illustrate the performances and estimates of the proposed ranking procedure for
the GPS and the BCPNN models according to the FDR, FNR, sensitivity and specificity. They
show very close performances for both methods according to the four operating characteristics
whatever the tested hypothesis. On the contrary, the estimate behaviour is different. Concerning
 on
the FDR, Figure 3 shows that FDR∗ calculated from the BCPNN model underestimates FDR
average when the null hypothesis is based on RR0 = 1, 2 or 3 and overestimates it when RR0 = 4.
Thus, for identical performances, estimations provided by the GPS model are better than those of
the BCPNN model except for RR0 = 4. For the other three operating characteristics (Figures 4–6),
the estimates obtained with the GPS model are better in terms of magnitude of bias than with the
BCPNN model, except for specificity with RR0 = 4 (Figure 6(d)).
The bias observed in the operating characteristics estimates has to be related to the simulation
model used for the data generation. Indeed, the latter is neither the GPS model nor the BCPNN
one. The low magnitude of the bias observed for the GPS model in comparison with that observed
with the BCPNN model could be attributed to some extent to the empirical Bayes approach used
to determine the hyperparameters.
Table I details the results obtained with the decision rule proposed by Bate et al. [10] for
the BCPNN model and by Szarfman et al. [28] for the GPS model. It shows that both decision
Copyright q

2009 John Wiley & Sons, Ltd.

Statist. Med. 2009; 28:1774–1792
DOI: 10.1002/sim

1783

BAYESIAN PHARMACOVIGILANCE METHODS AND MULTIPLE COMPARISONS

0.10

0.10

0.08

0.08

0.06

0.06

0.04

0.04

0.02

0.02

0.00

0.00
0

5000

(a)

10000

15000

20000

0

5000

(b)

Average number of generated signals

0.10

0.10

0.08

0.08

0.06

0.06

0.04

0.04

0.02

0.02

0.00

10000

20000

Average number of generated signals

0.00
0

1000

(c)

2000

3000

4000

5000

6000

7000

0

1000

(d)

Average number of generated signals

0.10

0.10

0.08

0.08

0.06

0.06

0.04

0.04

0.02

0.02

0.00

2000

3000

4000

5000

6000

7000

3000

3500

Average number of generated signals

0.00
0

500

(e)

1000

1500

2000

2500

3000

3500

0

(f )

Average number of generated signals

0.10

0.10

0.08

0.08

0.06

0.06

0.04

0.04

0.02

0.02

500

1000

1500

2000

2500

Average number of generated signals

0.00

0.00
0

500

(g)

1000

1500

2000

Average number of generated signals

2500

0

(h)

500

1000

1500

2000

2500

Average number of generated signals

 (black curves) and average FDR∗ (grey curves) according to the average
Figure 2. FDR
number of generated signals for RR0 = 1, 2, 3 and 4. ◦, + and ∗ represent E(∗ ),
Q 0.05 (∗ ) and Pr(H0∗ ) results, respectively.

Copyright q

2009 John Wiley & Sons, Ltd.

Statist. Med. 2009; 28:1774–1792
DOI: 10.1002/sim

1784

I. AHMED ET AL.

RR = 1

RR0 = 2

0.10

0.10

0.08

0.08

0.06

0.06

0.04

0.04

0.02

0.02

0.00

0.00
0

5000

(a)

10000

15000

20000

0

1000

2000

(b)

Average number of generated signals

3000

RR0 = 3
0.10

0.08

0.08

0.06

0.06

0.04

0.04

0.02

0.02

0.00

0.00
0

500

1000

1500

2000

5000

6000

7000

RR0 = 4

0.10

(c)

4000

Average number of generated signals

2500

Average number of generated signals

3000

3500

0

(d)

500

1000

1500

2000

2500

Average number of generated signals

 (black curves) and average FDR∗ (grey curves) according to the average number
Figure 3. FDR
of generated signals for RR0 = 1, 2, 3 and 4. Symbols ◦ and ∗ represent the results of Pr(H0∗ ) for
the BCPNN and GPS models, respectively.

rules result in large differences in terms of number of generated signals and thus of operating
characteristics.

5. APPLICATION
As a result of the simulation study, the GPS model was applied to the data collected between 1984
and 2002 in the French pharmacovigilance database. The data were coded with the Anatomical
Therapeutic Chemical (ATC)-MedDRA dictionary [30, 31] with the hierarchies ATC5 for drugs
Copyright q

2009 John Wiley & Sons, Ltd.

Statist. Med. 2009; 28:1774–1792
DOI: 10.1002/sim

1785

BAYESIAN PHARMACOVIGILANCE METHODS AND MULTIPLE COMPARISONS

RR0 = 1

RR0 = 2
0.30

0.5

0.25
0.4

0.20
0.3
0.15
0.2
0.10

0.1
0.05

0.0

0.00
0

5000

(a)

10000

15000

20000

0

1000

2000

(b)

Average number of generated signals

3000

4000

5000

6000

7000

Average number of generated signals

RR0 = 3

RR0 = 4

0.20

0.10

0.08
0.15

0.06
0.10
0.04

0.05
0.02

0.00

0.00
0

(c)

500

1000

1500

2000

2500

Average number of generated signals

3000

3500

0

(d)

500

1000

1500

2000

2500

Average number of generated signals

 (black curves) and average FNR∗ (grey curves) according to the average number
Figure 4. FNR
of generated signals for RR0 = 1, 2, 3 and 4. Symbols ◦ and ∗ represent the results of Pr(H0∗ ) for
the BCPNN and GPS models, respectively.

and high-level terms for adverse effects. With this classification, the total numbers of drug and
adverse event classes were 672 and 820, respectively. The analysis was restricted to the 47 520
cells containing at least three reports (n cell ).
Table II provides some numerical results given by the proposed procedure using the GPS model.
It presents the Bayesian estimates of the four operating characteristics according to several values
of  and the corresponding number of generated signals for RR0 = 1, 2 and 3. In practice, the use
of FDR∗ at a given level, for instance, at 5 per cent (0.048), results in 16 223 generated signals for
an association of interest defined as RR0 = 1 and a decision rule based on  = 0.20. The definition
of alternative associations of interest based on RR0 = 2 or 3 results, for a same value of FDR,
Copyright q

2009 John Wiley & Sons, Ltd.

Statist. Med. 2009; 28:1774–1792
DOI: 10.1002/sim

1786

I. AHMED ET AL.

RR0 = 1

RR0 = 2

1.0

1.0

0.8

0.8

0.6

0.6

0.4

0.4

0.2

0.2

0.0

0.0
0

5000

(a)

10000

15000

20000

0

1000

2000

(b)

Average number of generated signals

3000

RR0 = 3
1.0

0.8

0.8

0.6

0.6

0.4

0.4

0.2

0.2

0.0

0.0
0

500

1000

1500

2000

5000

6000

7000

RR0 = 4

1.0

(c)

4000

Average number of generated signals

2500

Average number of generated signals

3000

3500

0

(d)

500

1000

1500

2000

2500

Average number of generated signals

Figure 5. Average Se (black curves) and average Se∗ (grey curves) according to the average
number of generated signals for RR0 = 1, 2, 3 and 4. Symbols ◦ and ∗ represent the results of
Pr(H0∗ ) for the BCPNN and GPS models, respectively.

in a large size reduction in the list of generated signals. Crude calculations in which the FDRs
and the FNRs are estimated by FDR∗ and FNR∗ indicate that among the 47 520 considered cells,
approximately 24 400 cells are associated with ’s greater than 1, 8940 greater than 2 and 4930
greater than 3. The bold line in Table II indicates the case in which Pr(H0∗ ) and the decision rule
of Szarfman et al. [28] result in the selection of the same list of signals.
With regard to the simulation results, we investigated how the different ranking procedures differ,
in particular according to the counts, expected counts and observed reported ratios RRi j . Figure 7
presents the proportion of these three quantities, each stratified in three categories, according to the
number of generated signals. The proposed ranking procedure is calculated with RR0 = 1, 2 or 3
Copyright q

2009 John Wiley & Sons, Ltd.

Statist. Med. 2009; 28:1774–1792
DOI: 10.1002/sim

1787

BAYESIAN PHARMACOVIGILANCE METHODS AND MULTIPLE COMPARISONS

RR0 = 1

RR0 = 2

1.00

1.000

0.995
0.98

0.990
0.96
0.985
0.94
0.980

0.92
0.975

0.970

0.90
0

5000

(a)

10000

15000

20000

0

1000

2000

(b)

Average number of generated signals

3000

RR0 = 3
1.000

0.998

0.998

0.996

0.996

0.994

0.994

0.992

0.992

0.990

0.990
0

500

1000

1500

2000

5000

6000

7000

RR0 = 4

1.000

(c)

4000

Average number of generated signals

2500

3000

3500

0

500

(d)

Average number of generated signals

1000

1500

2000

2500

Average number of generated signals

Figure 6. Average Sp (black curves) and average Sp∗ (grey curves) according to the average number
of generated signals for RR0 = 1, 2, 3 and 4. Symbols ◦ and ∗ represent the results of Pr(H0∗ ) for
the BCPNN and GPS models, respectively.

Table I. Simulation results for the decision rules proposed by Bate et al. [10] for the BCPNN model and
by Szarfman et al. [28] for the GPS model.

BCPNN
GPS

RR0



Signals


FDR

FDR∗


FNR

FNR∗

Se

Se∗

Sp

Sp∗

1
2

0.025
0.05

10 313
3508

0.009
0.005

0.004
0.007

0.350
0.149

0.398
0.134

0.441
0.348

0.411
0.372

0.996
0.999

0.998
0.999

 and FNR.

Results are presented as averages except for FDR
Copyright q

2009 John Wiley & Sons, Ltd.

Statist. Med. 2009; 28:1774–1792
DOI: 10.1002/sim

1788

I. AHMED ET AL.

Table II. Results given by the Pr(H0∗ ) ranking procedure with the GPS model applied to the
French pharmacovigilance database.


Signals

FDR∗

FNR∗

Se∗

Sp∗

RR0 = 1
0.010
0.025
0.050
0.100
0.150
0.200
0.250
0.300
0.400
0.500

7640
8976
10 442
12 623
14 547
16 223
17 772
19 261
22 118
24 803

0.001
0.004
0.008
0.020
0.034
0.048
0.063
0.080
0.115
0.151

0.420
0.401
0.379
0.344
0.313
0.286
0.261
0.236
0.189
0.147

0.313
0.367
0.424
0.507
0.576
0.633
0.682
0.727
0.803
0.863

1.000
0.999
0.996
0.989
0.979
0.966
0.951
0.934
0.890
0.838

RR0 = 2
0.010
0.025
0.050
0.100
0.150
0.200
0.250
0.300
0.400
0.500

2764
3181
3591
4150
4625
5066
5461
5851
6673
7661

0.001
0.003
0.007
0.016
0.027
0.040
0.053
0.068
0.103
0.148

0.138
0.130
0.122
0.112
0.103
0.096
0.090
0.084
0.072
0.060

0.309
0.355
0.399
0.457
0.504
0.544
0.579
0.610
0.670
0.731

1.000
1.000
0.999
0.998
0.997
0.995
0.992
0.990
0.982
0.971

RR0 = 3
0.010
0.025
0.050
0.100
0.150
0.200
0.250
0.300
0.400
0.500

1823
2091
2356
2679
2895
3168
3349
3522
3919
4369

0.001
0.003
0.007
0.015
0.023
0.036
0.046
0.058
0.087
0.125

0.068
0.063
0.058
0.051
0.047
0.043
0.040
0.037
0.031
0.026

0.368
0.422
0.473
0.534
0.572
0.618
0.646
0.671
0.723
0.773

1.000
1.000
1.000
0.999
0.998
0.997
0.996
0.995
0.992
0.987

and its behaviour obviously depends on that parameter. Large differences can be observed between
the different ranking procedures, especially for lower numbers of generated signals. For instance,
the proposed procedure used with RR0 = 1 appears to generate signals with larger counts and larger
expected counts than Q 0.05 (∗ ) and E(∗ ). Additionally, it generates a larger proportion of signals
with RRi j ∈]1, 2] in comparison with Q 0.05 (∗ ) and E(∗ ) (Figure 7(g)). For the latter, the first
signals generated with RRi j ∈]1, 2] appear around 4000 and 8000, respectively. Furthermore, the
proportion of signals with RRi j ∈]2, 3] generated by Pr(H0∗ ) is significantly larger than that with
Q 0.05 (∗ ) or with E(∗ ) (Figure 7(h)). By focusing on stronger associations, defined, for instance,
with RR0 = 2 or 3, the proportion of small and medium counts in the list of signals generated by
the proposed procedure increases because large RRi j tend to be associated with low or medium
values of n i j and E i j as illustrated in Table III. In particular, the proportion of the cells with
Copyright q

2009 John Wiley & Sons, Ltd.

Statist. Med. 2009; 28:1774–1792
DOI: 10.1002/sim

1789

BAYESIAN PHARMACOVIGILANCE METHODS AND MULTIPLE COMPARISONS

n ≤5

1.0

n ∈ ]5,, 50]

1.0

0.8

0.8

0.8

0.6

0.6

0.6

0.4

0.4

0.4

0.2

0.2

Pr(H *) based on RR = 1
Pr(H *) based on RR = 2
Pr(H *) based on RR = 3
Q (λ*)
E(λ*)

0.0

0.0
0

2000

4000

6000

8000

10000

12000

(a)

0

2000

4000

6000

8000

0.2

0.0

10000

12000

(b)
E ≤5

1.0

0

E ∈ ]5,, 50]

1.0

0.8

0.6

0.6

0.6

0.4

0.4

0.4

0.2

0.2

0.2

0.0
2000

4000

6000

8000

10000

12000

(d)
RR ∈ ]1,, 2]

2000

4000

6000

8000

10000

12000

RR ∈ ]2,, 3]

1.0

0.6

0.6

0.6

0.4

0.4

0.4

0.2

0.2

0.2

0.0

(g)

4000

6000

8000

10000

12000

2000

4000

6000

8000

10000

12000

12000

RR > 3

1.0

0.8

2000

10000

E > 50

0

0.8

0

8000

(f)

0.8

0.0

6000

0.0
0

(e)

1.0

4000

1.0

0.8

0

2000

(c)

0.8

0.0

n > 50

1.0

0.0
0

(h)

2000

4000

6000

8000

10000

12000

0

2000

4000

6000

8000

10000

12000

(i)

Figure 7. Proportion of low, medium and large values of n i j , E i j and RRi j according
to the number of generated signals. Results are presented for the different GPS ranking
procedures applied to the French data.

RRi j >3 represents only 6 per cent of the cells with E i j >50 versus 42 per cent of the cells with
E i j 5.
In our simulation study, Pr(H0∗ ) was shown to give better results according to the FDR than
the other ranking procedures. However, for low values of FDR, the performances of the proposed
Copyright q

2009 John Wiley & Sons, Ltd.

Statist. Med. 2009; 28:1774–1792
DOI: 10.1002/sim

1790

I. AHMED ET AL.

Table III. Distribution of drug–adverse event combinations in the French data
according to their n i j , E i j and RRi j .
ni j

Ei j

RRi j

[3, 5]

]5, 50]

>50

5

]5, 50]

>50

]1, 2]
]2, 3]
>3

4760 (0.48)
1856 (0.19)
3404 (0.34)
10 020

7780 (0.55)
2546 (0.18)
3743 (0.27)
14 069

1879 (0.59)
544 (0.17)
765 (0.24)
3188

5914 (0.38)
3120 (0.20)
6658 (0.42)
15 692

7116 (0.72)
1602 (0.16)
1148 (0.12)
9866

1389 (0.81)
224 (0.13)
106 (0.06)
1719

Numbers in brackets correspond to the proportion in the considered column.

ranking procedure and Q 0.05 (∗ ) were very close (cf. Figure 2). The differences between both
ranking procedures appear clearly in Figure 7 where the nature of the signals is investigated. These
outcomes illustrate the contrast between quick detection strategies focusing on low data support
signals and thus being subject to spurious signal generation and strategies based on larger data
support but that are necessarily slower.

6. DISCUSSION
Original decision rules for automatic pharmacovigilance signal generation including the Bayesian
GPS and BCPNN models are based on arbitrary thresholds. No measure of the quality of the
generated signals is associated. For this reason, it is of interest to consider these methods into
the multiple comparison framework since it allows the evaluation of signals to be associated with
the adopted decision rule. Based on the work of Müller et al. [26], the approach used in this paper
makes it possible to easily derive Bayesian estimators of the FDR and FNR.
Pharmacovigilance signal detection is subject to several sources of biases inevitably induced not
only by the spontaneous nature of the reports but also by the simplistic representation of data as a
contingency table. As a result, associations defined as true in the database, as well as their strength,
may differ from associations between drugs and events in the actual population. However, both GPS
and BCPNN methods have shown their promise in several studies. For instance, Lindquist et al. [32]
for the BCPNN method and Szarfman et al. [28] for the GPS method demonstrated in retrospective
studies that both methods perform well in the early detection of drug–event associations that
represent safety signals. As for the signal detection methods, the operating characteristics derived
in this paper are thus specific to the pharmacovigilance database. Consequently, they cannot be
interpreted at the general level of ADR identification operating characteristics. However, provided
that they are correctly estimated, these operating characteristics can constitute a sort of prerequisite
for the signals.
While the simulation procedure was conducted in order to generate data sets close to the
French data in terms of marginal counts, it could easily be applied to other data sets by adopting
the values of the marginal counts and the parameters of the logistic distribution. The simulation
study revealed identical performances for the BCPNN and GPS models when using the proposed
ranking procedure, which includes, in particular, the decision rules proposed by Bate et al. [10]
and Szarfman et al. [28]. However, the four operating characteristics were better estimated when
using the GPS model except when testing RR0 = 4. Moreover, the posterior distribution of the
Copyright q

2009 John Wiley & Sons, Ltd.

Statist. Med. 2009; 28:1774–1792
DOI: 10.1002/sim

BAYESIAN PHARMACOVIGILANCE METHODS AND MULTIPLE COMPARISONS

1791

disproportionality measure is explicitly known for the GPS model, whereas it requires easy but
extensive Monte Carlo simulations for the BCPNN model. These outcomes support the use of the
GPS model as error rates may be easily estimated along with a list of signals obtained from the
data. Additionally, a simulation study with the data generation procedure aiming at mimicking
the data under scrutiny would helpfully complement the analysis process.
In this paper, the operating characteristics were derived for different testing thresholds RR0 .
When testing associations based on RR0 = 1, the simulation study and the application to real data
show very low estimated FDRs. For instance, with the proposed ranking procedure, the generation
of 16 223 signals in the real data is associated with FDR∗ = 0.048 (Table II), which precludes the
use of this operating characteristic as a decision rule. On the contrary, Table II also shows that
when focusing on stronger associations in the database, the number of generated signals is greatly
reduced: for instance, it is equal to 5461 for RR0 = 2 and FDR∗ = 0.053 and 3349 for RR0 = 3 and
FDR∗ = 0.046. For these strengths of association, the choice of a given level for FDR∗ can clearly
constitute a decision rule for the generation of signals.
ACKNOWLEDGEMENTS

The authors thank Joseph Lellouch for the helpful comments and suggestions. This work was supported
in part by IVRSP Grant A06076LS.
REFERENCES
1. Moride Y, Haramburu F, Requejo AA, Bégaud B. Under-reporting of adverse drug reactions in general practice.
British Journal of Clinical Pharmacology 1997; 43:177–181.
2. van der Heijden PG, Van Puijenbroek EP, Van Buuren S, Van der Hofstede JW. On the assessment of adverse
drug reactions from spontaneous reporting systems: the influence of under-reporting on odds ratios. Statistics in
Medicine 2002; 21(14):2027–2044. DOI: 10.1002/sim.1157. Available from: http://dx.doi.org/10.1002/sim.1157.
3. Rossi AC, Knapp DE, Anello C, O’Neil RT, Graham CF, Mendelis PS, Stanley GR. Discovery of adverse drug
reactions; a comparison of selected phase iv studies with spontaneous reporting methods. Journal of the American
Medical Association 1983; 249(16):2226–2228.
4. Rawlins MD. Spontaneous reporting of adverse drug reactions part I and II. British Journal of Clinical
Pharmacology 1988; 26:1–5, 7–11.
5. Arnaiz JA, Carne X, Riba N, Codina C, Trilla A. The use of evidence in pharmacovigilance case reports as the
reference source for drugs withdrawals. European Journal of Clinical Pharmacology 2001; 57(1):89–91.
6. Almenoff JS, Tonning JM, Gould AL, Szarfman A, Hauben M, Ouellet-Hellstrom R, Ball R, Hornbuckle K,
Walsh L, Yee C, Sacks ST, Yuen NA, Patadia V, Blum M, Johnston M, Gerrits C, Seifert H, LaCroix KK.
Perspectives on the use of data mining in pharmacovigilance. Drug Safety 2005; 28(11):981–1007.
7. Thiessard F, Roux E, Miremont-Salamé G, Fourrier-Réglat A, Haramburu F, Tubert-Bitter P, Bégaud B. Trends
in spontaneous adverse drug reaction reports to the French pharmacovigilance system (1986–2001). Drug Safety
2005; 28(8):731–740.
8. Evans SJ, Waller PC, Davis S. Use of proportional reporting ratios (PRRs) for signal generation from spontaneous
adverse drug reaction reports. Pharmacoepidemiology and Drug Safety 2001; 10(6):483–486.
9. van Puijenbroek EP, Bate A, Leufkens HG, Lindquist M, Orre R, Egberts AC. A comparison of
measures of disproportionality for signal detection in spontaneous reporting systems for adverse drug
reactions. Pharmacoepidemiology and Drug Safety 2002; 11(1):3–10. DOI: 10.1002/pds.668. Available from:
http://dx.doi.org/10.1002/pds.668.
10. Bate A, Lindquist M, Edwards IR, Olsson S, Orre R, Lansner A, De Freitas RM. A Bayesian neural network method
for adverse drug reaction signal generation. European Journal of Clinical Pharmacology 1998; 54(4):315–321.
11. Norén GN, Bate A, Orre R, Edwards IR. Extending the methods used to screen the who drug safety database
towards analysis of complex associations and improved accuracy for rare events. Statistics in Medicine 2006;
25(21):3740–3757.
Copyright q

2009 John Wiley & Sons, Ltd.

Statist. Med. 2009; 28:1774–1792
DOI: 10.1002/sim

1792

I. AHMED ET AL.

12. DuMouchel W. Bayesian data mining in large frequency tables, with an application to the fda spontaneous
reporting system. The American Statistician 1999; 53(3):177–190.
13. DuMouchel W, Pregibon D. Empirical Bayes screening for multi-item associations. KDD ’01: Proceedings of
the Seventh ACM SIGKDD International Conference on Knowledge Discovery and Data Mining, San Francisco,
CA, 2001; 67–76. Available from: http://doi.acm.org/10.1145/502512.502526.
14. Bate A, Lindquist M, Edwards IR. The application of knowledge discovery in databases to post-marketing drug
safety: example of the who database. Fundamental and Clinical Pharmacology 2008; 22(2):127–140.
15. Rolka H, Bracy B, Russell C, Fram D, Ball R. Using simulation to assess the sensitivity and specificity of a signal
detection tool for multidimensional public health surveillance data. Statistics in Medicine 2005; 24(4):551–562.
DOI: 10.1002/sim.2035. Available from: http://dx.doi.org/10.1002/sim.2035.
16. Roux E, Thiessard F, Fourrier A, Bégaud B, Tubert-Bitter P. Evaluation of statistical association measures for the
automatic signal generation in pharmacovigilance. IEEE Transactions on Information Technology in Biomedicine
2005; 9(4):518–527.
17. Almenoff JS, Lacroix KK, Yuen NA, Fram D, DuMouchel W. Comparative performance of two quantitative safety
signalling methods: implications for use in a pharmacovigilance department. Drug Safety 2006; 29(10):875–887.
18. Benjamini Y, Hochberg Y. Controlling the false discovery rate: a practical and powerful approach to multiple
testing. Journal of the Royal Statistical Society, Series B 1995; 57(1):289–300.
19. Efron B, Tibshirani R, Storey JD, Tusher V. Empirical Bayes analysis of a microarray experiment. Journal of
the American Statistical Association 2001; 96(456):1151–1160.
20. Storey JD. A direct approach to false discovery rates. Journal of the Royal Statistical Society, Series B 2002;
64(3):479–498.
21. Storey JD. The positive false discovery rate: a Bayesian interpretation and the q-value. The Annals of Statistics
2003; 31(6):2013–2035.
22. Broët P, Lewin A, Richardson S, Dalmasso C, Magdelenat H. A mixture model-based strategy for selecting
sets of genes in multiclass response microarray experiments. Bioinformatics 2004; 20(16):2562–2571. DOI:
10.1093/bioinformatics/bth285. Available from: http://dx.doi.org/10.1093/bioinformatics/bth285.
23. McLachlan GJ, Bean RW, Jones LB-T. A simple implementation of a normal mixture approach to
differential gene expression in multiclass microarrays. Bioinformatics 2006; 22(13):1608–1615. DOI: 10.1093/
bioinformatics/btl148. Available from: http://dx.doi.org/10.1093/bioinformatics/btl148.
24. Ahmed I, Haramburu F, Fourrier A, Thiessard F, Bégaud B, Tubert-Bitter P. A new automatic signal detection
method in pharmacovigilance: a Bayesian multiple comparison setting. Pharmacoepidemiology and Drug Safety
2006; S1:22.
25. Gould AL. Accounting for multiplicity in the evaluation of ‘ignals’ obtained by data mining from spontaneous
report adverse event databases. Biometrical Journal 2007; 49:151–165.
26. Müller P, Parmigiani G, Robert C, Rousseau J. Optimal sample size for multiple testing: the case of gene
expression microarrays. Journal of the American Statistical Association 2004; 99:990–1001.
27. Gould AL. Practical pharmacovigilance analysis strategies. Pharmacoepidemiology and Drug Safety 2003;
12(7):559–574. DOI: 10.1002/pds.771. Available from: http://dx.doi.org/10.1002/pds.771.
28. Szarfman A, Machado S, O’Neill R. Use of screening algorithms and computer systems to efficiently signal
higher-than-expected combinations of drugs and events in the US FDA’s spontaneous reports database. Drug
Safety 2002; 25(6):381–392.
29. Müller P, Parmigiani G, Rice K. FDR and Bayesian multiple comparisons rules. Valencia/ISBA Eighth World
Meeting on Bayesian Statistics, Benidorm, Alicante, Spain, 2006.
30. Miller GC, Britt H. A new drug classification for computer systems: the ATC extension code. International
Journal of Bio-Medical Computing 1995; 40(2):121–124.
31. Brown EG, Wood L, Wood S. The medical dictionary for regulatory activities (MedDRA). Drug Safety 1999;
20(2):1999.
32. Lindquist M, Ståhl M, Bate A, Edwards I, Meyboom RHB. A retrospective evaluation of a data mining approach to
aid finding new adverse drug reaction signals in the who international database. Drug Safety 2000; 23(6):533–542.

Copyright q

2009 John Wiley & Sons, Ltd.

Statist. Med. 2009; 28:1774–1792
DOI: 10.1002/sim

